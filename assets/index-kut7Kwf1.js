var Ua=Object.defineProperty;var Ya=(s,n,i)=>n in s?Ua(s,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[n]=i;var he=(s,n,i)=>Ya(s,typeof n!="symbol"?n+"":n,i);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const f of c)if(f.type==="childList")for(const p of f.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&a(p)}).observe(document,{childList:!0,subtree:!0});function i(c){const f={};return c.integrity&&(f.integrity=c.integrity),c.referrerPolicy&&(f.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?f.credentials="include":c.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function a(c){if(c.ep)return;c.ep=!0;const f=i(c);fetch(c.href,f)}})();const za="modulepreload",Ha=function(s,n){return new URL(s,n).href},So={},Fo=function(n,i,a){let c=Promise.resolve();if(i&&i.length>0){const p=document.getElementsByTagName("link"),m=document.querySelector("meta[property=csp-nonce]"),S=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));c=Promise.allSettled(i.map(I=>{if(I=Ha(I,a),I in So)return;So[I]=!0;const C=I.endsWith(".css"),A=C?'[rel="stylesheet"]':"";if(!!a)for(let Y=p.length-1;Y>=0;Y--){const q=p[Y];if(q.href===I&&(!C||q.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${I}"]${A}`))return;const W=document.createElement("link");if(W.rel=C?"stylesheet":za,C||(W.as="script"),W.crossOrigin="",W.href=I,S&&W.setAttribute("nonce",S),document.head.appendChild(W),C)return new Promise((Y,q)=>{W.addEventListener("load",Y),W.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${I}`)))})}))}function f(p){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=p,window.dispatchEvent(m),!m.defaultPrevented)throw p}return c.then(p=>{for(const m of p||[])m.status==="rejected"&&f(m.reason);return n().catch(f)})};var Eo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xa(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Wo={exports:{}};(function(s,n){((i,a)=>{s.exports=a()})(Eo,function(){var i=function(t,e){return(i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(r,o){r.__proto__=o}:function(r,o){for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(r[u]=o[u])}))(t,e)},a=function(){return(a=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var u in e=arguments[r])Object.prototype.hasOwnProperty.call(e,u)&&(t[u]=e[u]);return t}).apply(this,arguments)};function c(t,e,r){for(var o,u=0,l=e.length;u<l;u++)!o&&u in e||((o=o||Array.prototype.slice.call(e,0,u))[u]=e[u]);return t.concat(o||Array.prototype.slice.call(e))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Eo,p=Object.keys,m=Array.isArray;function S(t,e){return typeof e=="object"&&p(e).forEach(function(r){t[r]=e[r]}),t}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var I=Object.getPrototypeOf,C={}.hasOwnProperty;function A(t,e){return C.call(t,e)}function U(t,e){typeof e=="function"&&(e=e(I(t))),(typeof Reflect>"u"?p:Reflect.ownKeys)(e).forEach(function(r){Y(t,r,e[r])})}var W=Object.defineProperty;function Y(t,e,r,o){W(t,e,S(r&&A(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},o))}function q(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Y(t.prototype,"constructor",t),{extend:U.bind(null,t.prototype)}}}}var V=Object.getOwnPropertyDescriptor,ut=[].slice;function lt(t,e,r){return ut.call(t,e,r)}function ht(t,e){return e(t)}function rt(t){if(!t)throw new Error("Assertion Failed")}function et(t){f.setImmediate?setImmediate(t):setTimeout(t,0)}function pt(t,e){if(typeof e=="string"&&A(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var r=[],o=0,u=e.length;o<u;++o){var l=pt(t,e[o]);r.push(l)}return r}var d,h=e.indexOf(".");return h===-1||(d=t[e.substr(0,h)])==null?void 0:pt(d,e.substr(h+1))}function ft(t,e,r){if(t&&e!==void 0&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){rt(typeof r!="string"&&"length"in r);for(var o=0,u=e.length;o<u;++o)ft(t,e[o],r[o])}else{var l,d,h=e.indexOf(".");h!==-1?(l=e.substr(0,h),(h=e.substr(h+1))===""?r===void 0?m(t)&&!isNaN(parseInt(l))?t.splice(l,1):delete t[l]:t[l]=r:ft(d=(d=t[l])&&A(t,l)?d:t[l]={},h,r)):r===void 0?m(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=r}}function mt(t){var e,r={};for(e in t)A(t,e)&&(r[e]=t[e]);return r}var Rt=[].concat;function ve(t){return Rt.apply([],t)}var te="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ve([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return f[t]}),Jt=new Set(te.map(function(t){return f[t]})),Zt=null;function $t(t){return Zt=new WeakMap,t=function e(r){if(!r||typeof r!="object")return r;var o=Zt.get(r);if(o)return o;if(m(r)){o=[],Zt.set(r,o);for(var u=0,l=r.length;u<l;++u)o.push(e(r[u]))}else if(Jt.has(r.constructor))o=r;else{var d,h=I(r);for(d in o=h===Object.prototype?{}:Object.create(h),Zt.set(r,o),r)A(r,d)&&(o[d]=e(r[d]))}return o}(t),Zt=null,t}var le={}.toString;function ce(t){return le.call(t).slice(8,-1)}var Vt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",We=typeof Vt=="symbol"?function(t){var e;return t!=null&&(e=t[Vt])&&e.apply(t)}:function(){return null};function Wt(t,e){e=t.indexOf(e),0<=e&&t.splice(e,1)}var ye={};function re(t){var e,r,o,u;if(arguments.length===1){if(m(t))return t.slice();if(this===ye&&typeof t=="string")return[t];if(u=We(t))for(r=[];!(o=u.next()).done;)r.push(o.value);else{if(t==null)return[t];if(typeof(e=t.length)!="number")return[t];for(r=new Array(e);e--;)r[e]=t[e]}}else for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}var Ue=typeof Symbol<"u"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},te=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ut=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(te),fa={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ye(t,e){this.name=t,this.message=e}function Ni(t,e){return t+". Errors: "+Object.keys(e).map(function(r){return e[r].toString()}).filter(function(r,o,u){return u.indexOf(r)===o}).join(`
`)}function Ln(t,e,r,o){this.failures=e,this.failedKeys=o,this.successCount=r,this.message=Ni(t,e)}function ze(t,e){this.name="BulkError",this.failures=Object.keys(e).map(function(r){return e[r]}),this.failuresByPos=e,this.message=Ni(t,this.failures)}q(Ye).from(Error).extend({toString:function(){return this.name+": "+this.message}}),q(Ln).from(Ye),q(ze).from(Ye);var Ar=Ut.reduce(function(t,e){return t[e]=e+"Error",t},{}),ha=Ye,H=Ut.reduce(function(t,e){var r=e+"Error";function o(u,l){this.name=r,u?typeof u=="string"?(this.message="".concat(u).concat(l?`
 `+l:""),this.inner=l||null):typeof u=="object"&&(this.message="".concat(u.name," ").concat(u.message),this.inner=u):(this.message=fa[e]||r,this.inner=null)}return q(o).from(ha),t[e]=o,t},{}),Bi=(H.Syntax=SyntaxError,H.Type=TypeError,H.Range=RangeError,te.reduce(function(t,e){return t[e+"Error"]=H[e],t},{}));te=Ut.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=H[e]),t},{});function gt(){}function dn(t){return t}function pa(t,e){return t==null||t===dn?e:function(r){return e(t(r))}}function Oe(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function ma(t,e){return t===gt?e:function(){var r=t.apply(this,arguments),o=(r!==void 0&&(arguments[0]=r),this.onsuccess),u=this.onerror,l=(this.onsuccess=null,this.onerror=null,e.apply(this,arguments));return o&&(this.onsuccess=this.onsuccess?Oe(o,this.onsuccess):o),u&&(this.onerror=this.onerror?Oe(u,this.onerror):u),l!==void 0?l:r}}function ga(t,e){return t===gt?e:function(){t.apply(this,arguments);var r=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Oe(r,this.onsuccess):r),o&&(this.onerror=this.onerror?Oe(o,this.onerror):o)}}function va(t,e){return t===gt?e:function(u){var o=t.apply(this,arguments),u=(S(u,o),this.onsuccess),l=this.onerror,d=(this.onsuccess=null,this.onerror=null,e.apply(this,arguments));return u&&(this.onsuccess=this.onsuccess?Oe(u,this.onsuccess):u),l&&(this.onerror=this.onerror?Oe(l,this.onerror):l),o===void 0?d===void 0?void 0:d:S(o,d)}}function ya(t,e){return t===gt?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function Pr(t,e){return t===gt?e:function(){var r=t.apply(this,arguments);if(r&&typeof r.then=="function"){for(var o=this,u=arguments.length,l=new Array(u);u--;)l[u]=arguments[u];return r.then(function(){return e.apply(o,l)})}return e.apply(this,arguments)}}te.ModifyError=Ln,te.DexieError=Ye,te.BulkError=ze;var ie=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function qi(t){ie=t}var fn={},Fi=100,hn=typeof Promise>"u"?[]:(Ut=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[hn=crypto.subtle.digest("SHA-512",new Uint8Array([0])),I(hn),Ut]:[Ut,I(Ut),Ut]),Ut=hn[0],tn=hn[1],tn=tn&&tn.then,Ae=Ut&&Ut.constructor,Cr=!!hn[2],pn=function(t,e){mn.push([t,e]),Rn&&(queueMicrotask(wa),Rn=!1)},$r=!0,Rn=!0,Pe=[],Kn=[],Mr=dn,be={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:gt,pgp:!1,env:{},finalize:gt},z=be,mn=[],Ce=0,Nn=[];function K(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var e=this._PSD=z;if(typeof t!="function"){if(t!==fn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Lr(this,this._value)}else this._state=null,this._value=null,++e.ref,function r(o,u){try{u(function(l){if(o._state===null){if(l===o)throw new TypeError("A promise cannot be resolved with itself.");var d=o._lib&&He();l&&typeof l.then=="function"?r(o,function(h,y){l instanceof K?l._then(h,y):l.then(h,y)}):(o._state=!0,o._value=l,Ui(o)),d&&Xe()}},Lr.bind(null,o))}catch(l){Lr(o,l)}}(this,t)}var jr={get:function(){var t=z,e=Wn;function r(o,u){var l=this,d=!t.global&&(t!==z||e!==Wn),h=d&&!_e(),y=new K(function(D,b){Rr(l,new Wi(zi(o,t,d,h),zi(u,t,d,h),D,b,t))});return this._consoleTask&&(y._consoleTask=this._consoleTask),y}return r.prototype=fn,r},set:function(t){Y(this,"then",t&&t.prototype===fn?jr:{get:function(){return t},set:jr.set})}};function Wi(t,e,r,o,u){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=r,this.reject=o,this.psd=u}function Lr(t,e){var r,o;Kn.push(e),t._state===null&&(r=t._lib&&He(),e=Mr(e),t._state=!1,t._value=e,o=t,Pe.some(function(u){return u._value===o._value})||Pe.push(o),Ui(t),r)&&Xe()}function Ui(t){var e=t._listeners;t._listeners=[];for(var r=0,o=e.length;r<o;++r)Rr(t,e[r]);var u=t._PSD;--u.ref||u.finalize(),Ce===0&&(++Ce,pn(function(){--Ce==0&&Kr()},[]))}function Rr(t,e){if(t._state===null)t._listeners.push(e);else{var r=t._state?e.onFulfilled:e.onRejected;if(r===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Ce,pn(ba,[r,t,e])}}function ba(t,e,r){try{var o,u=e._value;!e._state&&Kn.length&&(Kn=[]),o=ie&&e._consoleTask?e._consoleTask.run(function(){return t(u)}):t(u),e._state||Kn.indexOf(u)!==-1||(l=>{for(var d=Pe.length;d;)if(Pe[--d]._value===l._value)return Pe.splice(d,1)})(e),r.resolve(o)}catch(l){r.reject(l)}finally{--Ce==0&&Kr(),--r.psd.ref||r.psd.finalize()}}function wa(){$e(be,function(){He()&&Xe()})}function He(){var t=$r;return Rn=$r=!1,t}function Xe(){var t,e,r;do for(;0<mn.length;)for(t=mn,mn=[],r=t.length,e=0;e<r;++e){var o=t[e];o[0].apply(null,o[1])}while(0<mn.length);Rn=$r=!0}function Kr(){for(var t=Pe,e=(Pe=[],t.forEach(function(o){o._PSD.onunhandled.call(null,o._value,o)}),Nn.slice(0)),r=e.length;r;)e[--r]()}function Bn(t){return new K(fn,!1,t)}function bt(t,e){var r=z;return function(){var o=He(),u=z;try{return ke(r,!0),t.apply(this,arguments)}catch(l){e&&e(l)}finally{ke(u,!1),o&&Xe()}}}U(K.prototype,{then:jr,_then:function(t,e){Rr(this,new Wi(null,null,t,e,z))},catch:function(t){var e,r;return arguments.length===1?this.then(null,t):(e=t,r=arguments[1],typeof e=="function"?this.then(null,function(o){return(o instanceof e?r:Bn)(o)}):this.then(null,function(o){return(o&&o.name===e?r:Bn)(o)}))},finally:function(t){return this.then(function(e){return K.resolve(t()).then(function(){return e})},function(e){return K.resolve(t()).then(function(){return Bn(e)})})},timeout:function(t,e){var r=this;return t<1/0?new K(function(o,u){var l=setTimeout(function(){return u(new H.Timeout(e))},t);r.then(o,u).finally(clearTimeout.bind(null,l))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Y(K.prototype,Symbol.toStringTag,"Dexie.Promise"),be.env=Yi(),U(K,{all:function(){var t=re.apply(null,arguments).map(Un);return new K(function(e,r){t.length===0&&e([]);var o=t.length;t.forEach(function(u,l){return K.resolve(u).then(function(d){t[l]=d,--o||e(t)},r)})})},resolve:function(t){return t instanceof K?t:t&&typeof t.then=="function"?new K(function(e,r){t.then(e,r)}):new K(fn,!0,t)},reject:Bn,race:function(){var t=re.apply(null,arguments).map(Un);return new K(function(e,r){t.map(function(o){return K.resolve(o).then(e,r)})})},PSD:{get:function(){return z},set:function(t){return z=t}},totalEchoes:{get:function(){return Wn}},newPSD:we,usePSD:$e,scheduler:{get:function(){return pn},set:function(t){pn=t}},rejectionMapper:{get:function(){return Mr},set:function(t){Mr=t}},follow:function(t,e){return new K(function(r,o){return we(function(u,l){var d=z;d.unhandleds=[],d.onunhandled=l,d.finalize=Oe(function(){var h,y=this;h=function(){y.unhandleds.length===0?u():l(y.unhandleds[0])},Nn.push(function D(){h(),Nn.splice(Nn.indexOf(D),1)}),++Ce,pn(function(){--Ce==0&&Kr()},[])},d.finalize),t()},e,r,o)})}}),Ae&&(Ae.allSettled&&Y(K,"allSettled",function(){var t=re.apply(null,arguments).map(Un);return new K(function(e){t.length===0&&e([]);var r=t.length,o=new Array(r);t.forEach(function(u,l){return K.resolve(u).then(function(d){return o[l]={status:"fulfilled",value:d}},function(d){return o[l]={status:"rejected",reason:d}}).then(function(){return--r||e(o)})})})}),Ae.any&&typeof AggregateError<"u"&&Y(K,"any",function(){var t=re.apply(null,arguments).map(Un);return new K(function(e,r){t.length===0&&r(new AggregateError([]));var o=t.length,u=new Array(o);t.forEach(function(l,d){return K.resolve(l).then(function(h){return e(h)},function(h){u[d]=h,--o||r(new AggregateError(u))})})})}),Ae.withResolvers)&&(K.withResolvers=Ae.withResolvers);var Pt={awaits:0,echoes:0,id:0},_a=0,qn=[],Fn=0,Wn=0,ka=0;function we(t,d,r,o){var u=z,l=Object.create(u),d=(l.parent=u,l.ref=0,l.global=!1,l.id=++ka,be.env,l.env=Cr?{Promise:K,PromiseProp:{value:K,configurable:!0,writable:!0},all:K.all,race:K.race,allSettled:K.allSettled,any:K.any,resolve:K.resolve,reject:K.reject}:{},d&&S(l,d),++u.ref,l.finalize=function(){--this.parent.ref||this.parent.finalize()},$e(l,t,r,o));return l.ref===0&&l.finalize(),d}function Ve(){return Pt.id||(Pt.id=++_a),++Pt.awaits,Pt.echoes+=Fi,Pt.id}function _e(){return!!Pt.awaits&&(--Pt.awaits==0&&(Pt.id=0),Pt.echoes=Pt.awaits*Fi,!0)}function Un(t){return Pt.echoes&&t&&t.constructor===Ae?(Ve(),t.then(function(e){return _e(),e},function(e){return _e(),xt(e)})):t}function Sa(){var t=qn[qn.length-1];qn.pop(),ke(t,!1)}function ke(t,e){var r,o,u=z;(e?!Pt.echoes||Fn++&&t===z:!Fn||--Fn&&t===z)||queueMicrotask(e?(function(l){++Wn,Pt.echoes&&--Pt.echoes!=0||(Pt.echoes=Pt.awaits=Pt.id=0),qn.push(z),ke(l,!0)}).bind(null,t):Sa),t!==z&&(z=t,u===be&&(be.env=Yi()),Cr)&&(r=be.env.Promise,o=t.env,u.global||t.global)&&(Object.defineProperty(f,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any)&&(r.any=o.any)}function Yi(){var t=f.Promise;return Cr?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject}:{}}function $e(t,e,r,o,u){var l=z;try{return ke(t,!0),e(r,o,u)}finally{ke(l,!1)}}function zi(t,e,r,o){return typeof t!="function"?t:function(){var u=z;r&&Ve(),ke(e,!0);try{return t.apply(this,arguments)}finally{ke(u,!1),o&&queueMicrotask(_e)}}}function Nr(t){Promise===Ae&&Pt.echoes===0?Fn===0?t():enqueueNativeMicroTask(t):setTimeout(t,0)}(""+tn).indexOf("[native code]")===-1&&(Ve=_e=gt);var xt=K.reject,Me="ï¿¿",de="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Hi="String expected.",Ge=[],Yn="__dbnames",Br="readonly",qr="readwrite";function je(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var Xi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function zn(t){return typeof t!="string"||/\./.test(t)?function(e){return e}:function(e){return e[t]===void 0&&t in e&&delete(e=$t(e))[t],e}}function Vi(){throw H.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ot(t,e){try{var r=Gi(t),o=Gi(e);if(r!==o)return r==="Array"?1:o==="Array"?-1:r==="binary"?1:o==="binary"?-1:r==="string"?1:o==="string"?-1:r==="Date"?1:o!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e<t?1:t<e?-1:0;case"binary":for(var u=Qi(t),l=Qi(e),d=u.length,h=l.length,y=d<h?d:h,D=0;D<y;++D)if(u[D]!==l[D])return u[D]<l[D]?-1:1;return d===h?0:d<h?-1:1;case"Array":for(var b=t,g=e,_=b.length,k=g.length,w=_<k?_:k,v=0;v<w;++v){var x=ot(b[v],g[v]);if(x!==0)return x}return _===k?0:_<k?-1:1}}catch{}return NaN}function Gi(t){var e=typeof t;return e=="object"&&(ArrayBuffer.isView(t)||(e=ce(t))==="ArrayBuffer")?"binary":e}function Qi(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}function Hn(t,e,r){var o=t.schema.yProps;return o?(e&&0<r.numFailures&&(e=e.filter(function(u,l){return!r.failures[l]})),Promise.all(o.map(function(u){return u=u.updatesTable,e?t.db.table(u).where("k").anyOf(e).delete():t.db.table(u).clear()})).then(function(){return r})):r}Ji.prototype.execute=function(t){var e=this["@@propmod"];if(e.add!==void 0){var r=e.add;if(m(r))return c(c([],m(t)?t:[],!0),r).sort();if(typeof r=="number")return(Number(t)||0)+r;if(typeof r=="bigint")try{return BigInt(t)+r}catch{return BigInt(0)+r}throw new TypeError("Invalid term ".concat(r))}if(e.remove!==void 0){var o=e.remove;if(m(o))return m(t)?t.filter(function(u){return!o.includes(u)}).sort():[];if(typeof o=="number")return Number(t)-o;if(typeof o=="bigint")try{return BigInt(t)-o}catch{return BigInt(0)-o}throw new TypeError("Invalid subtrahend ".concat(o))}return r=(r=e.replacePrefix)==null?void 0:r[0],r&&typeof t=="string"&&t.startsWith(r)?e.replacePrefix[1]+t.substring(r.length):t};var gn=Ji;function Ji(t){this["@@propmod"]=t}function Zi(t,e){for(var r=p(e),o=r.length,u=!1,l=0;l<o;++l){var d=r[l],h=e[d],y=pt(t,d);h instanceof gn?(ft(t,d,h.execute(y)),u=!0):y!==h&&(ft(t,d,h),u=!0)}return u}yt.prototype._trans=function(t,e,r){var o=this._tx||z.trans,u=this.name,l=ie&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function d(D,b,g){if(g.schema[u])return e(g.idbtrans,g);throw new H.NotFound("Table "+u+" not part of transaction")}var h=He();try{var y=o&&o.db._novip===this.db._novip?o===z.trans?o._promise(t,d,r):we(function(){return o._promise(t,d,r)},{trans:o,transless:z.transless||z}):function D(b,g,_,k){if(b.idbdb&&(b._state.openComplete||z.letThrough||b._vip)){var w=b._createTransaction(g,_,b._dbSchema);try{w.create(),b._state.PR1398_maxLoop=3}catch(v){return v.name===Ar.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return D(b,g,_,k)})):xt(v)}return w._promise(g,function(v,x){return we(function(){return z.trans=w,k(v,x,w)})}).then(function(v){if(g==="readwrite")try{w.idbtrans.commit()}catch{}return g==="readonly"?v:w._completion.then(function(){return v})})}if(b._state.openComplete)return xt(new H.DatabaseClosed(b._state.dbOpenError));if(!b._state.isBeingOpened){if(!b._state.autoOpen)return xt(new H.DatabaseClosed);b.open().catch(gt)}return b._state.dbReadyPromise.then(function(){return D(b,g,_,k)})}(this.db,t,[this.name],d);return l&&(y._consoleTask=l,y=y.catch(function(D){return console.trace(D),xt(D)})),y}finally{h&&Xe()}},yt.prototype.get=function(t,e){var r=this;return t&&t.constructor===Object?this.where(t).first(e):t==null?xt(new H.Type("Invalid argument to Table.get()")):this._trans("readonly",function(o){return r.core.get({trans:o,key:t}).then(function(u){return r.hook.reading.fire(u)})}).then(e)},yt.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(m(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var e=p(t);if(e.length===1)return this.where(e[0]).equals(t[e[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(h){if(h.compound&&e.every(function(D){return 0<=h.keyPath.indexOf(D)})){for(var y=0;y<e.length;++y)if(e.indexOf(h.keyPath[y])===-1)return!1;return!0}return!1}).sort(function(h,y){return h.keyPath.length-y.keyPath.length})[0];if(r&&this.db._maxKey!==Me)return d=r.keyPath.slice(0,e.length),this.where(d).equals(d.map(function(h){return t[h]}));!r&&ie&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(e.join("+"),"]"));var o=this.schema.idxByName;function u(h,y){return ot(h,y)===0}var d=e.reduce(function(b,y){var D=b[0],b=b[1],g=o[y],_=t[y];return[D||g,D||!g?je(b,g&&g.multi?function(k){return k=pt(k,y),m(k)&&k.some(function(w){return u(_,w)})}:function(k){return u(_,pt(k,y))}):b]},[null,null]),l=d[0],d=d[1];return l?this.where(l.name).equals(t[l.keyPath]).filter(d):r?this.filter(d):this.where(e).equals("")},yt.prototype.filter=function(t){return this.toCollection().and(t)},yt.prototype.count=function(t){return this.toCollection().count(t)},yt.prototype.offset=function(t){return this.toCollection().offset(t)},yt.prototype.limit=function(t){return this.toCollection().limit(t)},yt.prototype.each=function(t){return this.toCollection().each(t)},yt.prototype.toArray=function(t){return this.toCollection().toArray(t)},yt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},yt.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,m(t)?"[".concat(t.join("+"),"]"):t))},yt.prototype.reverse=function(){return this.toCollection().reverse()},yt.prototype.mapToClass=function(t){for(var e=this.db,r=this.name,o=((this.schema.mappedClass=t).prototype instanceof Vi&&(t=(d=>{var h=b,y=d;if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function D(){this.constructor=h}function b(){return d!==null&&d.apply(this,arguments)||this}return i(h,y),h.prototype=y===null?Object.create(y):(D.prototype=y.prototype,new D),Object.defineProperty(b.prototype,"db",{get:function(){return e},enumerable:!1,configurable:!0}),b.prototype.table=function(){return r},b})(t)),new Set),u=t.prototype;u;u=I(u))Object.getOwnPropertyNames(u).forEach(function(d){return o.add(d)});function l(d){if(!d)return d;var h,y=Object.create(t.prototype);for(h in d)if(!o.has(h))try{y[h]=d[h]}catch{}return y}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=l,this.hook("reading",l),t},yt.prototype.defineClass=function(){return this.mapToClass(function(t){S(this,t)})},yt.prototype.add=function(t,e){var r=this,o=this.schema.primKey,u=o.auto,l=o.keyPath,d=t;return l&&u&&(d=zn(l)(t)),this._trans("readwrite",function(h){return r.core.mutate({trans:h,type:"add",keys:e!=null?[e]:null,values:[d]})}).then(function(h){return h.numFailures?K.reject(h.failures[0]):h.lastResult}).then(function(h){if(l)try{ft(t,l,h)}catch{}return h})},yt.prototype.upsert=function(t,e){var r=this,o=this.schema.primKey.keyPath;return this._trans("readwrite",function(u){return r.core.get({trans:u,key:t}).then(function(l){var d=l??{};return Zi(d,e),o&&ft(d,o,t),r.core.mutate({trans:u,type:"put",values:[d],keys:[t],upsert:!0,updates:{keys:[t],changeSpecs:[e]}}).then(function(h){return h.numFailures?K.reject(h.failures[0]):!!l})})})},yt.prototype.update=function(t,e){return typeof t!="object"||m(t)?this.where(":id").equals(t).modify(e):(t=pt(t,this.schema.primKey.keyPath))===void 0?xt(new H.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(t).modify(e)},yt.prototype.put=function(t,e){var r=this,o=this.schema.primKey,u=o.auto,l=o.keyPath,d=t;return l&&u&&(d=zn(l)(t)),this._trans("readwrite",function(h){return r.core.mutate({trans:h,type:"put",values:[d],keys:e!=null?[e]:null})}).then(function(h){return h.numFailures?K.reject(h.failures[0]):h.lastResult}).then(function(h){if(l)try{ft(t,l,h)}catch{}return h})},yt.prototype.delete=function(t){var e=this;return this._trans("readwrite",function(r){return e.core.mutate({trans:r,type:"delete",keys:[t]}).then(function(o){return Hn(e,[t],o)}).then(function(o){return o.numFailures?K.reject(o.failures[0]):void 0})})},yt.prototype.clear=function(){var t=this;return this._trans("readwrite",function(e){return t.core.mutate({trans:e,type:"deleteRange",range:Xi}).then(function(r){return Hn(t,null,r)})}).then(function(e){return e.numFailures?K.reject(e.failures[0]):void 0})},yt.prototype.bulkGet=function(t){var e=this;return this._trans("readonly",function(r){return e.core.getMany({keys:t,trans:r}).then(function(o){return o.map(function(u){return e.hook.reading.fire(u)})})})},yt.prototype.bulkAdd=function(t,e,r){var o=this,u=Array.isArray(e)?e:void 0,l=(r=r||(u?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",function(d){var h=o.schema.primKey,D=h.auto,h=h.keyPath;if(h&&u)throw new H.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(u&&u.length!==t.length)throw new H.InvalidArgument("Arguments objects and keys must have the same length");var y=t.length,D=h&&D?t.map(zn(h)):t;return o.core.mutate({trans:d,type:"add",keys:u,values:D,wantResults:l}).then(function(b){var g=b.numFailures,_=b.failures;if(g===0)return l?b.results:b.lastResult;throw new ze("".concat(o.name,".bulkAdd(): ").concat(g," of ").concat(y," operations failed"),_)})})},yt.prototype.bulkPut=function(t,e,r){var o=this,u=Array.isArray(e)?e:void 0,l=(r=r||(u?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",function(d){var h=o.schema.primKey,D=h.auto,h=h.keyPath;if(h&&u)throw new H.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(u&&u.length!==t.length)throw new H.InvalidArgument("Arguments objects and keys must have the same length");var y=t.length,D=h&&D?t.map(zn(h)):t;return o.core.mutate({trans:d,type:"put",keys:u,values:D,wantResults:l}).then(function(b){var g=b.numFailures,_=b.failures;if(g===0)return l?b.results:b.lastResult;throw new ze("".concat(o.name,".bulkPut(): ").concat(g," of ").concat(y," operations failed"),_)})})},yt.prototype.bulkUpdate=function(t){var e=this,r=this.core,o=t.map(function(d){return d.key}),u=t.map(function(d){return d.changes}),l=[];return this._trans("readwrite",function(d){return r.getMany({trans:d,keys:o,cache:"clone"}).then(function(h){var y=[],D=[],b=(t.forEach(function(g,_){var k=g.key,w=g.changes,v=h[_];if(v){for(var x=0,T=Object.keys(w);x<T.length;x++){var E=T[x],O=w[E];if(E===e.schema.primKey.keyPath){if(ot(O,k)!==0)throw new H.Constraint("Cannot update primary key in bulkUpdate()")}else ft(v,E,O)}l.push(_),y.push(k),D.push(v)}}),y.length);return r.mutate({trans:d,type:"put",keys:y,values:D,updates:{keys:o,changeSpecs:u}}).then(function(g){var _=g.numFailures,k=g.failures;if(_===0)return b;for(var w=0,v=Object.keys(k);w<v.length;w++){var x,T=v[w],E=l[Number(T)];E!=null&&(x=k[T],delete k[T],k[E]=x)}throw new ze("".concat(e.name,".bulkUpdate(): ").concat(_," of ").concat(b," operations failed"),k)})})})},yt.prototype.bulkDelete=function(t){var e=this,r=t.length;return this._trans("readwrite",function(o){return e.core.mutate({trans:o,type:"delete",keys:t}).then(function(u){return Hn(e,t,u)})}).then(function(o){var u=o.numFailures,l=o.failures;if(u===0)return o.lastResult;throw new ze("".concat(e.name,".bulkDelete(): ").concat(u," of ").concat(r," operations failed"),l)})};var to=yt;function yt(){}function vn(t){function e(d,h){if(h){for(var y=arguments.length,D=new Array(y-1);--y;)D[y-1]=arguments[y];return r[d].subscribe.apply(null,D),t}if(typeof d=="string")return r[d]}var r={};e.addEventType=l;for(var o=1,u=arguments.length;o<u;++o)l(arguments[o]);return e;function l(d,h,y){var D,b;if(typeof d!="object")return h=h||ya,b={subscribers:[],fire:y=y||gt,subscribe:function(g){b.subscribers.indexOf(g)===-1&&(b.subscribers.push(g),b.fire=h(b.fire,g))},unsubscribe:function(g){b.subscribers=b.subscribers.filter(function(_){return _!==g}),b.fire=b.subscribers.reduce(h,y)}},r[d]=e[d]=b;p(D=d).forEach(function(g){var _=D[g];if(m(_))l(g,D[g][0],D[g][1]);else{if(_!=="asap")throw new H.InvalidArgument("Invalid event config");var k=l(g,dn,function(){for(var w=arguments.length,v=new Array(w);w--;)v[w]=arguments[w];k.subscribers.forEach(function(x){et(function(){x.apply(null,v)})})})}})}}function yn(t,e){return q(e).from({prototype:t}),e}function Qe(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Fr(t,e){t.filter=je(t.filter,e)}function Wr(t,e,r){var o=t.replayFilter;t.replayFilter=o?function(){return je(o(),e())}:e,t.justLimit=r&&!o}function Xn(t,e){if(t.isPrimKey)return e.primaryKey;var r=e.getIndexByKeyPath(t.index);if(r)return r;throw new H.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed")}function eo(t,e,r){var o=Xn(t,e.schema);return e.openCursor({trans:r,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:o,range:t.range}})}function Vn(t,e,r,o){var u,l,d=t.replayFilter?je(t.filter,t.replayFilter()):t.filter;return t.or?(u={},l=function(h,y,D){var b,g;d&&!d(y,D,function(_){return y.stop(_)},function(_){return y.fail(_)})||((g=""+(b=y.primaryKey))=="[object ArrayBuffer]"&&(g=""+new Uint8Array(b)),A(u,g))||(u[g]=!0,e(h,y,D))},Promise.all([t.or._iterate(l,r),no(eo(t,o,r),t.algorithm,l,!t.keysOnly&&t.valueMapper)])):no(eo(t,o,r),je(t.algorithm,d),e,!t.keysOnly&&t.valueMapper)}function no(t,e,r,o){var u=bt(o?function(l,d,h){return r(o(l),d,h)}:r);return t.then(function(l){if(l)return l.start(function(){var d=function(){return l.continue()};e&&!e(l,function(h){return d=h},function(h){l.stop(h),d=gt},function(h){l.fail(h),d=gt})||u(l.value,l,function(h){return d=h}),d()})})}ct.prototype._read=function(t,e){var r=this._ctx;return r.error?r.table._trans(null,xt.bind(null,r.error)):r.table._trans("readonly",t).then(e)},ct.prototype._write=function(t){var e=this._ctx;return e.error?e.table._trans(null,xt.bind(null,e.error)):e.table._trans("readwrite",t,"locked")},ct.prototype._addAlgorithm=function(t){var e=this._ctx;e.algorithm=je(e.algorithm,t)},ct.prototype._iterate=function(t,e){return Vn(this._ctx,t,e,this._ctx.table.core)},ct.prototype.clone=function(t){var e=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&S(r,t),e._ctx=r,e},ct.prototype.raw=function(){return this._ctx.valueMapper=null,this},ct.prototype.each=function(t){var e=this._ctx;return this._read(function(r){return Vn(e,t,r,e.table.core)})},ct.prototype.count=function(t){var e=this;return this._read(function(r){var o,u=e._ctx,l=u.table.core;return Qe(u,!0)?l.count({trans:r,query:{index:Xn(u,l.schema),range:u.range}}).then(function(d){return Math.min(d,u.limit)}):(o=0,Vn(u,function(){return++o,!1},r,l).then(function(){return o}))}).then(t)},ct.prototype.sortBy=function(t,e){var r=t.split(".").reverse(),o=r[0],u=r.length-1;function l(y,D){return D?l(y[r[D]],D-1):y[o]}var d=this._ctx.dir==="next"?1:-1;function h(y,D){return ot(l(y,u),l(D,u))*d}return this.toArray(function(y){return y.sort(h)}).then(e)},ct.prototype.toArray=function(t){var e=this;return this._read(function(r){var o,u,l,d=e._ctx;return d.dir==="next"&&Qe(d,!0)&&0<d.limit?(o=d.valueMapper,u=Xn(d,d.table.core.schema),d.table.core.query({trans:r,limit:d.limit,values:!0,query:{index:u,range:d.range}}).then(function(h){return h=h.result,o?h.map(o):h})):(l=[],Vn(d,function(h){return l.push(h)},r,d.table.core).then(function(){return l}))},t)},ct.prototype.offset=function(t){var e=this._ctx;return t<=0||(e.offset+=t,Qe(e)?Wr(e,function(){var r=t;return function(o,u){return r===0||(r===1?--r:u(function(){o.advance(r),r=0}),!1)}}):Wr(e,function(){var r=t;return function(){return--r<0}})),this},ct.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Wr(this._ctx,function(){var e=t;return function(r,o,u){return--e<=0&&o(u),0<=e}},!0),this},ct.prototype.until=function(t,e){return Fr(this._ctx,function(r,o,u){return!t(r.value)||(o(u),e)}),this},ct.prototype.first=function(t){return this.limit(1).toArray(function(e){return e[0]}).then(t)},ct.prototype.last=function(t){return this.reverse().first(t)},ct.prototype.filter=function(t){var e;return Fr(this._ctx,function(r){return t(r.value)}),(e=this._ctx).isMatch=je(e.isMatch,t),this},ct.prototype.and=function(t){return this.filter(t)},ct.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},ct.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ct.prototype.desc=function(){return this.reverse()},ct.prototype.eachKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(r,o){t(o.key,o)})},ct.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},ct.prototype.eachPrimaryKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(r,o){t(o.primaryKey,o)})},ct.prototype.keys=function(t){var e=this._ctx,r=(e.keysOnly=!e.isMatch,[]);return this.each(function(o,u){r.push(u.key)}).then(function(){return r}).then(t)},ct.prototype.primaryKeys=function(t){var e=this._ctx;if(e.dir==="next"&&Qe(e,!0)&&0<e.limit)return this._read(function(o){var u=Xn(e,e.table.core.schema);return e.table.core.query({trans:o,values:!1,limit:e.limit,query:{index:u,range:e.range}})}).then(function(o){return o.result}).then(t);e.keysOnly=!e.isMatch;var r=[];return this.each(function(o,u){r.push(u.primaryKey)}).then(function(){return r}).then(t)},ct.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},ct.prototype.firstKey=function(t){return this.limit(1).keys(function(e){return e[0]}).then(t)},ct.prototype.lastKey=function(t){return this.reverse().firstKey(t)},ct.prototype.distinct=function(){var t,e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];return e&&e.multi&&(t={},Fr(this._ctx,function(o){var o=o.primaryKey.toString(),u=A(t,o);return t[o]=!0,!u})),this},ct.prototype.modify=function(t){var e=this,r=this._ctx;return this._write(function(o){function u(v,x){var T=x.failures;_+=v-x.numFailures;for(var E=0,O=p(T);E<O.length;E++){var P=O[E];g.push(T[P])}}var l=typeof t=="function"?t:function(v){return Zi(v,t)},d=r.table.core,b=d.schema.primaryKey,h=b.outbound,y=b.extractKey,D=200,b=e.db._options.modifyChunkSize,g=(b&&(D=typeof b=="object"?b[d.name]||b["*"]||200:b),[]),_=0,k=[],w=t===ro;return e.clone().primaryKeys().then(function(v){function x(E){var O=Math.min(D,v.length-E),P=v.slice(E,E+O);return(w?Promise.resolve([]):d.getMany({trans:o,keys:P,cache:"immutable"})).then(function(j){var L=[],$=[],B=h?[]:null,N=w?P:[];if(!w)for(var M=0;M<O;++M){var F=j[M],st={value:$t(F),primKey:v[E+M]};l.call(st,st.value,st)!==!1&&(st.value==null?N.push(v[E+M]):h||ot(y(F),y(st.value))===0?($.push(st.value),h&&B.push(v[E+M])):(N.push(v[E+M]),L.push(st.value)))}return Promise.resolve(0<L.length&&d.mutate({trans:o,type:"add",values:L}).then(function(dt){for(var X in dt.failures)N.splice(parseInt(X),1);u(L.length,dt)})).then(function(){return(0<$.length||T&&typeof t=="object")&&d.mutate({trans:o,type:"put",keys:B,values:$,criteria:T,changeSpec:typeof t!="function"&&t,isAdditionalChunk:0<E}).then(function(dt){return u($.length,dt)})}).then(function(){return(0<N.length||T&&w)&&d.mutate({trans:o,type:"delete",keys:N,criteria:T,isAdditionalChunk:0<E}).then(function(dt){return Hn(r.table,N,dt)}).then(function(dt){return u(N.length,dt)})}).then(function(){return v.length>E+O&&x(E+D)})})}var T=Qe(r)&&r.limit===1/0&&(typeof t!="function"||w)&&{index:r.index,range:r.range};return x(0).then(function(){if(0<g.length)throw new Ln("Error modifying one or more objects",g,_,k);return v.length})})})},ct.prototype.delete=function(){var t=this._ctx,e=t.range;return!Qe(t)||t.table.schema.yProps||!t.isPrimKey&&e.type!==3?this.modify(ro):this._write(function(r){var o=t.table.core.schema.primaryKey,u=e;return t.table.core.count({trans:r,query:{index:o,range:u}}).then(function(l){return t.table.core.mutate({trans:r,type:"deleteRange",range:u}).then(function(y){var h=y.failures,y=y.numFailures;if(y)throw new Ln("Could not delete some values",Object.keys(h).map(function(D){return h[D]}),l-y);return l-y})})})};var Ea=ct;function ct(){}var ro=function(t,e){return e.value=null};function Da(t,e){return t<e?-1:t===e?0:1}function xa(t,e){return e<t?-1:t===e?0:1}function Yt(t,e,r){return t=t instanceof oo?new t.Collection(t):t,t._ctx.error=new(r||TypeError)(e),t}function Je(t){return new t.Collection(t,function(){return io("")}).limit(0)}function Gn(k,e,r,o){var u,l,d,h,y,D,b,g=r.length;if(!r.every(function(v){return typeof v=="string"}))return Yt(k,Hi);function _(v){u=v==="next"?function(T){return T.toUpperCase()}:function(T){return T.toLowerCase()},l=v==="next"?function(T){return T.toLowerCase()}:function(T){return T.toUpperCase()},d=v==="next"?Da:xa;var x=r.map(function(T){return{lower:l(T),upper:u(T)}}).sort(function(T,E){return d(T.lower,E.lower)});h=x.map(function(T){return T.upper}),y=x.map(function(T){return T.lower}),b=(D=v)==="next"?"":o}_("next");var k=new k.Collection(k,function(){return Se(h[0],y[g-1]+o)}),w=(k._ondirectionchange=function(v){_(v)},0);return k._addAlgorithm(function(v,x,T){var E=v.key;if(typeof E=="string"){var O=l(E);if(e(O,y,w))return!0;for(var P=null,j=w;j<g;++j){var L=(($,B,N,M,F,st)=>{for(var dt=Math.min($.length,M.length),X=-1,nt=0;nt<dt;++nt){var _t=B[nt];if(_t!==M[nt])return F($[nt],N[nt])<0?$.substr(0,nt)+N[nt]+N.substr(nt+1):F($[nt],M[nt])<0?$.substr(0,nt)+M[nt]+N.substr(nt+1):0<=X?$.substr(0,X)+B[X]+N.substr(X+1):null;F($[nt],_t)<0&&(X=nt)}return dt<M.length&&st==="next"?$+N.substr($.length):dt<$.length&&st==="prev"?$.substr(0,N.length):X<0?null:$.substr(0,X)+M[X]+N.substr(X+1)})(E,O,h[j],y[j],d,D);L===null&&P===null?w=j+1:(P===null||0<d(P,L))&&(P=L)}x(P!==null?function(){v.continue(P+b)}:T)}return!1}),k}function Se(t,e,r,o){return{type:2,lower:t,upper:e,lowerOpen:r,upperOpen:o}}function io(t){return{type:1,lower:t,upper:t}}Object.defineProperty(Ct.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ct.prototype.between=function(t,e,r,o){r=r!==!1,o=o===!0;try{return 0<this._cmp(t,e)||this._cmp(t,e)===0&&(r||o)&&(!r||!o)?Je(this):new this.Collection(this,function(){return Se(t,e,!r,!o)})}catch{return Yt(this,de)}},Ct.prototype.equals=function(t){return t==null?Yt(this,de):new this.Collection(this,function(){return io(t)})},Ct.prototype.above=function(t){return t==null?Yt(this,de):new this.Collection(this,function(){return Se(t,void 0,!0)})},Ct.prototype.aboveOrEqual=function(t){return t==null?Yt(this,de):new this.Collection(this,function(){return Se(t,void 0,!1)})},Ct.prototype.below=function(t){return t==null?Yt(this,de):new this.Collection(this,function(){return Se(void 0,t,!1,!0)})},Ct.prototype.belowOrEqual=function(t){return t==null?Yt(this,de):new this.Collection(this,function(){return Se(void 0,t)})},Ct.prototype.startsWith=function(t){return typeof t!="string"?Yt(this,Hi):this.between(t,t+Me,!0,!0)},Ct.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):Gn(this,function(e,r){return e.indexOf(r[0])===0},[t],Me)},Ct.prototype.equalsIgnoreCase=function(t){return Gn(this,function(e,r){return e===r[0]},[t],"")},Ct.prototype.anyOfIgnoreCase=function(){var t=re.apply(ye,arguments);return t.length===0?Je(this):Gn(this,function(e,r){return r.indexOf(e)!==-1},t,"")},Ct.prototype.startsWithAnyOfIgnoreCase=function(){var t=re.apply(ye,arguments);return t.length===0?Je(this):Gn(this,function(e,r){return r.some(function(o){return e.indexOf(o)===0})},t,Me)},Ct.prototype.anyOf=function(){var t,e,r=this,o=re.apply(ye,arguments),u=this._cmp;try{o.sort(u)}catch{return Yt(this,de)}return o.length===0?Je(this):((t=new this.Collection(this,function(){return Se(o[0],o[o.length-1])}))._ondirectionchange=function(l){u=l==="next"?r._ascending:r._descending,o.sort(u)},e=0,t._addAlgorithm(function(l,d,h){for(var y=l.key;0<u(y,o[e]);)if(++e===o.length)return d(h),!1;return u(y,o[e])===0||(d(function(){l.continue(o[e])}),!1)}),t)},Ct.prototype.notEqual=function(t){return this.inAnyRange([[-1/0,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ct.prototype.noneOf=function(){var t=re.apply(ye,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Yt(this,de)}var e=t.reduce(function(r,o){return r?r.concat([[r[r.length-1][1],o]]):[[-1/0,o]]},null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},Ct.prototype.inAnyRange=function(t,T){var r=this,o=this._cmp,u=this._ascending,l=this._descending,d=this._min,h=this._max;if(t.length===0)return Je(this);if(!t.every(function(E){return E[0]!==void 0&&E[1]!==void 0&&u(E[0],E[1])<=0}))return Yt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",H.InvalidArgument);var y=!T||T.includeLowers!==!1,D=T&&T.includeUppers===!0,b,g=u;function _(E,O){return g(E[0],O[0])}try{(b=t.reduce(function(E,O){for(var P=0,j=E.length;P<j;++P){var L=E[P];if(o(O[0],L[1])<0&&0<o(O[1],L[0])){L[0]=d(L[0],O[0]),L[1]=h(L[1],O[1]);break}}return P===j&&E.push(O),E},[])).sort(_)}catch{return Yt(this,de)}var k=0,w=D?function(E){return 0<u(E,b[k][1])}:function(E){return 0<=u(E,b[k][1])},v=y?function(E){return 0<l(E,b[k][0])}:function(E){return 0<=l(E,b[k][0])},x=w,T=new this.Collection(this,function(){return Se(b[0][0],b[b.length-1][1],!y,!D)});return T._ondirectionchange=function(E){g=E==="next"?(x=w,u):(x=v,l),b.sort(_)},T._addAlgorithm(function(E,O,P){for(var j,L=E.key;x(L);)if(++k===b.length)return O(P),!1;return!w(j=L)&&!v(j)||(r._cmp(L,b[k][1])===0||r._cmp(L,b[k][0])===0||O(function(){g===u?E.continue(b[k][0]):E.continue(b[k][1])}),!1)}),T},Ct.prototype.startsWithAnyOf=function(){var t=re.apply(ye,arguments);return t.every(function(e){return typeof e=="string"})?t.length===0?Je(this):this.inAnyRange(t.map(function(e){return[e,e+Me]})):Yt(this,"startsWithAnyOf() only works with strings")};var oo=Ct;function Ct(){}function oe(t){return bt(function(e){return bn(e),t(e.target.error),!1})}function bn(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var wn="storagemutated",Ur="x-storagemutated-1",Ee=vn(null,wn),Ta=(ae.prototype._lock=function(){return rt(!z.global),++this._reculock,this._reculock!==1||z.global||(z.lockOwnerFor=this),this},ae.prototype._unlock=function(){if(rt(!z.global),--this._reculock==0)for(z.global||(z.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var t=this._blockedFuncs.shift();try{$e(t[1],t[0])}catch{}}return this},ae.prototype._locked=function(){return this._reculock&&z.lockOwnerFor!==this},ae.prototype.create=function(t){var e=this;if(this.mode){var r=this.db.idbdb,o=this.db._state.dbOpenError;if(rt(!this.idbtrans),!t&&!r)switch(o&&o.name){case"DatabaseClosedError":throw new H.DatabaseClosed(o);case"MissingAPIError":throw new H.MissingAPI(o.message,o);default:throw new H.OpenFailed(o)}if(!this.active)throw new H.TransactionInactive;rt(this._completion._state===null),(t=this.idbtrans=t||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=bt(function(u){bn(u),e._reject(t.error)}),t.onabort=bt(function(u){bn(u),e.active&&e._reject(new H.Abort(t.error)),e.active=!1,e.on("abort").fire(u)}),t.oncomplete=bt(function(){e.active=!1,e._resolve(),"mutatedParts"in t&&Ee.storagemutated.fire(t.mutatedParts)})}return this},ae.prototype._promise=function(t,e,r){var o,u=this;return t==="readwrite"&&this.mode!=="readwrite"?xt(new H.ReadOnly("Transaction is readonly")):this.active?this._locked()?new K(function(l,d){u._blockedFuncs.push([function(){u._promise(t,e,r).then(l,d)},z])}):r?we(function(){var l=new K(function(d,h){u._lock();var y=e(d,h,u);y&&y.then&&y.then(d,h)});return l.finally(function(){return u._unlock()}),l._lib=!0,l}):((o=new K(function(l,d){var h=e(l,d,u);h&&h.then&&h.then(l,d)}))._lib=!0,o):xt(new H.TransactionInactive)},ae.prototype._root=function(){return this.parent?this.parent._root():this},ae.prototype.waitFor=function(t){var e,r=this._root(),o=K.resolve(t),u=(r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return o}):(r._waitingFor=o,r._waitingQueue=[],e=r.idbtrans.objectStore(r.storeNames[0]),function l(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(e.get(-1/0).onsuccess=l)}()),r._waitingFor);return new K(function(l,d){o.then(function(h){return r._waitingQueue.push(bt(l.bind(null,h)))},function(h){return r._waitingQueue.push(bt(d.bind(null,h)))}).finally(function(){r._waitingFor===u&&(r._waitingFor=null)})})},ae.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new H.Abort))},ae.prototype.table=function(t){var e=this._memoizedTables||(this._memoizedTables={});if(A(e,t))return e[t];var r=this.schema[t];if(r)return(r=new this.db.Table(t,r,this)).core=this.db.core.table(t),e[t]=r;throw new H.NotFound("Table "+t+" not part of transaction")},ae);function ae(){}function Yr(t,e,r,o,u,l,d,h){return{name:t,keyPath:e,unique:r,multi:o,auto:u,compound:l,src:(r&&!d?"&":"")+(o?"*":"")+(u?"++":"")+ao(e),type:h}}function ao(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function zr(t,e,r){return{name:t,primKey:e,indexes:r,mappedClass:null,idxByName:(o=function(u){return[u.name,u]},r.reduce(function(u,l,d){return l=o(l,d),l&&(u[l[0]]=l[1]),u},{}))};var o}var _n=function(t){try{return t.only([[]]),_n=function(){return[[]]},[[]]}catch{return _n=function(){return Me},Me}};function Hr(t){return t==null?function(){}:typeof t=="string"?(e=t).split(".").length===1?function(r){return r[e]}:function(r){return pt(r,e)}:function(r){return pt(r,t)};var e}function so(t){return[].slice.call(t)}var Ia=0;function kn(t){return t==null?":id":typeof t=="string"?t:"[".concat(t.join("+"),"]")}function Oa(t,e,y){function o(w){if(w.type===3)return null;if(w.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var g=w.lower,_=w.upper,k=w.lowerOpen,w=w.upperOpen;return g===void 0?_===void 0?null:e.upperBound(_,!!w):_===void 0?e.lowerBound(g,!!k):e.bound(g,_,!!k,!!w)}function u(b){var g,_=b.name;return{name:_,schema:b,mutate:function(k){var w=k.trans,v=k.type,x=k.keys,T=k.values,E=k.range;return new Promise(function(O,P){O=bt(O);var j=w.objectStore(_),L=j.keyPath==null,$=v==="put"||v==="add";if(!$&&v!=="delete"&&v!=="deleteRange")throw new Error("Invalid operation type: "+v);var B,N=(x||T||{length:1}).length;if(x&&T&&x.length!==T.length)throw new Error("Given keys array must have same length as given values array.");if(N===0)return O({numFailures:0,failures:{},results:[],lastResult:void 0});function M(Et){++dt,bn(Et)}var F=[],st=[],dt=0;if(v==="deleteRange"){if(E.type===4)return O({numFailures:dt,failures:st,results:[],lastResult:void 0});E.type===3?F.push(B=j.clear()):F.push(B=j.delete(o(E)))}else{var L=$?L?[T,x]:[T,null]:[x,null],X=L[0],nt=L[1];if($)for(var _t=0;_t<N;++_t)F.push(B=nt&&nt[_t]!==void 0?j[v](X[_t],nt[_t]):j[v](X[_t])),B.onerror=M;else for(_t=0;_t<N;++_t)F.push(B=j[v](X[_t])),B.onerror=M}function Gt(Et){Et=Et.target.result,F.forEach(function(Ke,di){return Ke.error!=null&&(st[di]=Ke.error)}),O({numFailures:dt,failures:st,results:v==="delete"?x:F.map(function(Ke){return Ke.result}),lastResult:Et})}B.onerror=function(Et){M(Et),Gt(Et)},B.onsuccess=Gt})},getMany:function(k){var w=k.trans,v=k.keys;return new Promise(function(x,T){x=bt(x);for(var E,O=w.objectStore(_),P=v.length,j=new Array(P),L=0,$=0,B=function(F){F=F.target,j[F._pos]=F.result,++$===L&&x(j)},N=oe(T),M=0;M<P;++M)v[M]!=null&&((E=O.get(v[M]))._pos=M,E.onsuccess=B,E.onerror=N,++L);L===0&&x(j)})},get:function(k){var w=k.trans,v=k.key;return new Promise(function(x,T){x=bt(x);var E=w.objectStore(_).get(v);E.onsuccess=function(O){return x(O.target.result)},E.onerror=oe(T)})},query:(g=h,function(k){return new Promise(function(w,v){w=bt(w);var x,T,E,$=k.trans,O=k.values,P=k.limit,L=k.query,j=P===1/0?void 0:P,B=L.index,L=L.range,$=$.objectStore(_),$=B.isPrimaryKey?$:$.index(B.name),B=o(L);if(P===0)return w({result:[]});g?((L=O?$.getAll(B,j):$.getAllKeys(B,j)).onsuccess=function(N){return w({result:N.target.result})},L.onerror=oe(v)):(x=0,T=!O&&"openKeyCursor"in $?$.openKeyCursor(B):$.openCursor(B),E=[],T.onsuccess=function(N){var M=T.result;return!M||(E.push(O?M.value:M.primaryKey),++x===P)?w({result:E}):void M.continue()},T.onerror=oe(v))})}),openCursor:function(k){var w=k.trans,v=k.values,x=k.query,T=k.reverse,E=k.unique;return new Promise(function(O,P){O=bt(O);var $=x.index,j=x.range,L=w.objectStore(_),L=$.isPrimaryKey?L:L.index($.name),$=T?E?"prevunique":"prev":E?"nextunique":"next",B=!v&&"openKeyCursor"in L?L.openKeyCursor(o(j),$):L.openCursor(o(j),$);B.onerror=oe(P),B.onsuccess=bt(function(N){var M,F,st,dt,X=B.result;X?(X.___id=++Ia,X.done=!1,M=X.continue.bind(X),F=(F=X.continuePrimaryKey)&&F.bind(X),st=X.advance.bind(X),dt=function(){throw new Error("Cursor not stopped")},X.trans=w,X.stop=X.continue=X.continuePrimaryKey=X.advance=function(){throw new Error("Cursor not started")},X.fail=bt(P),X.next=function(){var nt=this,_t=1;return this.start(function(){return _t--?nt.continue():nt.stop()}).then(function(){return nt})},X.start=function(nt){function _t(){if(B.result)try{nt()}catch(Et){X.fail(Et)}else X.done=!0,X.start=function(){throw new Error("Cursor behind last entry")},X.stop()}var Gt=new Promise(function(Et,Ke){Et=bt(Et),B.onerror=oe(Ke),X.fail=Ke,X.stop=function(di){X.stop=X.continue=X.continuePrimaryKey=X.advance=dt,Et(di)}});return B.onsuccess=bt(function(Et){B.onsuccess=_t,_t()}),X.continue=M,X.continuePrimaryKey=F,X.advance=st,_t(),Gt},O(X)):O(null)},P)})},count:function(k){var w=k.query,v=k.trans,x=w.index,T=w.range;return new Promise(function(E,O){var P=v.objectStore(_),P=x.isPrimaryKey?P:P.index(x.name),j=o(T),j=j?P.count(j):P.count();j.onsuccess=bt(function(L){return E(L.target.result)}),j.onerror=oe(O)})}}}l=y,d=so((y=t).objectStoreNames);var l,y={schema:{name:y.name,tables:d.map(function(b){return l.objectStore(b)}).map(function(b){var g=b.keyPath,_=b.autoIncrement,w=m(g),k={},w={name:b.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g==null,compound:w,keyPath:g,autoIncrement:_,unique:!0,extractKey:Hr(g)},indexes:so(b.indexNames).map(function(v){return b.index(v)}).map(function(E){var O=E.name,x=E.unique,T=E.multiEntry,E=E.keyPath,O={name:O,compound:m(E),keyPath:E,unique:x,multiEntry:T,extractKey:Hr(E)};return k[kn(E)]=O}),getIndexByKeyPath:function(v){return k[kn(v)]}};return k[":id"]=w.primaryKey,g!=null&&(k[kn(g)]=w.primaryKey),w})},hasGetAll:0<d.length&&"getAll"in l.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},d=y.schema,h=y.hasGetAll,y=d.tables.map(u),D={};return y.forEach(function(b){return D[b.name]=b}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(b){if(D[b])return D[b];throw new Error("Table '".concat(b,"' not found"))},MIN_KEY:-1/0,MAX_KEY:_n(e),schema:d}}function Aa(t,e,r,o){return r=r.IDBKeyRange,e=Oa(e,r,o),{dbcore:t.dbcore.reduce(function(u,l){return l=l.create,a(a({},u),l(u))},e)}}function Qn(t,e){var r=e.db,r=Aa(t._middlewares,r,t._deps,e);t.core=r.dbcore,t.tables.forEach(function(o){var u=o.name;t.core.schema.tables.some(function(l){return l.name===u})&&(o.core=t.core.table(u),t[u]instanceof t.Table)&&(t[u].core=o.core)})}function Jn(t,e,r,o){r.forEach(function(u){var l=o[u];e.forEach(function(d){var h=function y(D,b){return V(D,b)||(D=I(D))&&y(D,b)}(d,u);(!h||"value"in h&&h.value===void 0)&&(d===t.Transaction.prototype||d instanceof t.Transaction?Y(d,u,{get:function(){return this.table(u)},set:function(y){W(this,u,{value:y,writable:!0,configurable:!0,enumerable:!0})}}):d[u]=new t.Table(u,l))})})}function Xr(t,e){e.forEach(function(r){for(var o in r)r[o]instanceof t.Table&&delete r[o]})}function Pa(t,e){return t._cfg.version-e._cfg.version}function Ca(t,e,r,o){var u=t._dbSchema,l=(r.objectStoreNames.contains("$meta")&&!u.$meta&&(u.$meta=zr("$meta",lo("")[0],[]),t._storeNames.push("$meta")),t._createTransaction("readwrite",t._storeNames,u)),d=(l.create(r),l._completion.catch(o),l._reject.bind(l)),h=z.transless||z;we(function(){if(z.trans=l,z.transless=h,e!==0)return Qn(t,r),D=e,((y=l).storeNames.includes("$meta")?y.table("$meta").get("version").then(function(b){return b??D}):K.resolve(D)).then(function(x){var g=t,_=x,k=l,w=r,v=[],x=g._versions,T=g._dbSchema=tr(0,g.idbdb,w);return(x=x.filter(function(E){return E._cfg.version>=_})).length===0?K.resolve():(x.forEach(function(E){v.push(function(){var O,P,j,L=T,$=E._cfg.dbschema,B=(er(g,L,w),er(g,$,w),T=g._dbSchema=$,Vr(L,$)),N=(B.add.forEach(function(M){Gr(w,M[0],M[1].primKey,M[1].indexes)}),B.change.forEach(function(M){if(M.recreate)throw new H.Upgrade("Not yet support for changing primary key");var F=w.objectStore(M.name);M.add.forEach(function(st){return Zn(F,st)}),M.change.forEach(function(st){F.deleteIndex(st.name),Zn(F,st)}),M.del.forEach(function(st){return F.deleteIndex(st)})}),E._cfg.contentUpgrade);if(N&&E._cfg.version>_)return Qn(g,w),k._memoizedTables={},O=mt($),B.del.forEach(function(M){O[M]=L[M]}),Xr(g,[g.Transaction.prototype]),Jn(g,[g.Transaction.prototype],p(O),O),k.schema=O,(P=Ue(N))&&Ve(),$=K.follow(function(){var M;(j=N(k))&&P&&(M=_e.bind(null,null),j.then(M,M))}),j&&typeof j.then=="function"?K.resolve(j):$.then(function(){return j})}),v.push(function(O){var P,j,L=E._cfg.dbschema;P=L,j=O,[].slice.call(j.db.objectStoreNames).forEach(function($){return P[$]==null&&j.db.deleteObjectStore($)}),Xr(g,[g.Transaction.prototype]),Jn(g,[g.Transaction.prototype],g._storeNames,g._dbSchema),k.schema=g._dbSchema}),v.push(function(O){g.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(g.idbdb.version/10)===E._cfg.version?(g.idbdb.deleteObjectStore("$meta"),delete g._dbSchema.$meta,g._storeNames=g._storeNames.filter(function(P){return P!=="$meta"})):O.objectStore("$meta").put(E._cfg.version,"version"))})}),function E(){return v.length?K.resolve(v.shift()(k.idbtrans)).then(E):K.resolve()}().then(function(){uo(T,w)}))}).catch(d);var y,D;p(u).forEach(function(b){Gr(r,b,u[b].primKey,u[b].indexes)}),Qn(t,r),K.follow(function(){return t.on.populate.fire(l)}).catch(d)})}function $a(t,e){uo(t._dbSchema,e),e.db.version%10!=0||e.objectStoreNames.contains("$meta")||e.db.createObjectStore("$meta").add(Math.ceil(e.db.version/10-1),"version");var r=tr(0,t.idbdb,e);er(t,t._dbSchema,e);for(var o=0,u=Vr(r,t._dbSchema).change;o<u.length;o++){var l=(d=>{if(d.change.length||d.recreate)return console.warn("Unable to patch indexes of table ".concat(d.name," because it has changes on the type of index or primary key.")),{value:void 0};var h=e.objectStore(d.name);d.add.forEach(function(y){ie&&console.debug("Dexie upgrade patch: Creating missing index ".concat(d.name,".").concat(y.src)),Zn(h,y)})})(u[o]);if(typeof l=="object")return l.value}}function Vr(t,e){var r,o={del:[],add:[],change:[]};for(r in t)e[r]||o.del.push(r);for(r in e){var u=t[r],l=e[r];if(u){var d={name:r,def:l,recreate:!1,del:[],add:[],change:[]};if(""+(u.primKey.keyPath||"")!=""+(l.primKey.keyPath||"")||u.primKey.auto!==l.primKey.auto)d.recreate=!0,o.change.push(d);else{var h=u.idxByName,y=l.idxByName,D=void 0;for(D in h)y[D]||d.del.push(D);for(D in y){var b=h[D],g=y[D];b?b.src!==g.src&&d.change.push(g):d.add.push(g)}(0<d.del.length||0<d.add.length||0<d.change.length)&&o.change.push(d)}}else o.add.push([r,l])}return o}function Gr(t,e,r,o){var u=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});o.forEach(function(l){return Zn(u,l)})}function uo(t,e){p(t).forEach(function(r){e.db.objectStoreNames.contains(r)||(ie&&console.debug("Dexie: Creating missing table",r),Gr(e,r,t[r].primKey,t[r].indexes))})}function Zn(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function tr(t,e,r){var o={};return lt(e.objectStoreNames,0).forEach(function(u){for(var l=r.objectStore(u),d=Yr(ao(D=l.keyPath),D||"",!0,!1,!!l.autoIncrement,D&&typeof D!="string",!0),h=[],y=0;y<l.indexNames.length;++y){var b=l.index(l.indexNames[y]),D=b.keyPath,b=Yr(b.name,D,!!b.unique,!!b.multiEntry,!1,D&&typeof D!="string",!1);h.push(b)}o[u]=zr(u,d,h)}),o}function er(t,e,r){for(var o=r.db.objectStoreNames,u=0;u<o.length;++u){var l=o[u],d=r.objectStore(l);t._hasGetAll="getAll"in d;for(var h=0;h<d.indexNames.length;++h){var y,D=d.indexNames[h],b=d.index(D).keyPath,b=typeof b=="string"?b:"["+lt(b).join("+")+"]";e[l]&&(y=e[l].idxByName[b])&&(y.name=D,delete e[l].idxByName[b],e[l].idxByName[D]=y)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}function lo(t){return t.split(",").map(function(e,r){var u=e.split(":"),o=(o=u[1])==null?void 0:o.trim(),u=(e=u[0].trim()).replace(/([&*]|\+\+)/g,""),l=/^\[/.test(u)?u.match(/^\[(.*)\]$/)[1].split("+"):u;return Yr(u,l||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),m(l),r===0,o)})}Ze.prototype._createTableSchema=zr,Ze.prototype._parseIndexSyntax=lo,Ze.prototype._parseStoresSpec=function(t,e){var r=this;p(t).forEach(function(o){if(t[o]!==null){var u=r._parseIndexSyntax(t[o]),l=u.shift();if(!l)throw new H.Schema("Invalid schema for table "+o+": "+t[o]);if(l.unique=!0,l.multi)throw new H.Schema("Primary key cannot be multiEntry*");u.forEach(function(d){if(d.auto)throw new H.Schema("Only primary key can be marked as autoIncrement (++)");if(!d.keyPath)throw new H.Schema("Index must have a name and cannot be an empty string")}),l=r._createTableSchema(o,l,u),e[o]=l}})},Ze.prototype.stores=function(r){var e=this.db,r=(this._cfg.storesSource=this._cfg.storesSource?S(this._cfg.storesSource,r):r,e._versions),o={},u={};return r.forEach(function(l){S(o,l._cfg.storesSource),u=l._cfg.dbschema={},l._parseStoresSpec(o,u)}),e._dbSchema=u,Xr(e,[e._allTables,e,e.Transaction.prototype]),Jn(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],p(u),u),e._storeNames=p(u),this},Ze.prototype.upgrade=function(t){return this._cfg.contentUpgrade=Pr(this._cfg.contentUpgrade||gt,t),this};var Ma=Ze;function Ze(){}function Qr(t,e){var r=t._dbNamesDB;return r||(r=t._dbNamesDB=new fe(Yn,{addons:[],indexedDB:t,IDBKeyRange:e})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function Jr(t){return t&&typeof t.databases=="function"}function Zr(t){return we(function(){return z.letThrough=!0,t()})}function ti(t){return!("from"in t)}var jt=function(t,e){var r;if(!this)return r=new jt,t&&"d"in t&&S(r,t),r;S(this,arguments.length?{d:1,from:t,to:1<arguments.length?e:t}:{d:0})};function Sn(t,e,r){var o=ot(e,r);if(!isNaN(o)){if(0<o)throw RangeError();if(ti(t))return S(t,{from:e,to:r,d:1});var o=t.l,u=t.r;if(ot(r,t.from)<0)return o?Sn(o,e,r):t.l={from:e,to:r,d:1,l:null,r:null},fo(t);if(0<ot(e,t.to))return u?Sn(u,e,r):t.r={from:e,to:r,d:1,l:null,r:null},fo(t);ot(e,t.from)<0&&(t.from=e,t.l=null,t.d=u?u.d+1:1),0<ot(r,t.to)&&(t.to=r,t.r=null,t.d=t.l?t.l.d+1:1),e=!t.r,o&&!t.l&&En(t,o),u&&e&&En(t,u)}}function En(t,e){ti(e)||function r(o,u){var l=u.from,d=u.l,h=u.r;Sn(o,l,u.to),d&&r(o,d),h&&r(o,h)}(t,e)}function co(t,e){var r=nr(e),o=r.next();if(!o.done)for(var u=o.value,l=nr(t),d=l.next(u.from),h=d.value;!o.done&&!d.done;){if(ot(h.from,u.to)<=0&&0<=ot(h.to,u.from))return!0;ot(u.from,h.from)<0?u=(o=r.next(h.from)).value:h=(d=l.next(u.from)).value}return!1}function nr(t){var e=ti(t)?null:{s:0,n:t};return{next:function(r){for(var o=0<arguments.length;e;)switch(e.s){case 0:if(e.s=1,o)for(;e.n.l&&ot(r,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!o||ot(r,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function fo(t){var e,r,o,u=(((u=t.r)==null?void 0:u.d)||0)-(((u=t.l)==null?void 0:u.d)||0),u=1<u?"r":u<-1?"l":"";u&&(e=u=="r"?"l":"r",r=a({},t),o=t[u],t.from=o.from,t.to=o.to,t[u]=o[u],r[u]=o[e],(t[e]=r).d=ho(r)),t.d=ho(t)}function ho(r){var e=r.r,r=r.l;return(e?r?Math.max(e.d,r.d):e.d:r?r.d:0)+1}function rr(t,e){return p(e).forEach(function(r){t[r]?En(t[r],e[r]):t[r]=function o(u){var l,d,h={};for(l in u)A(u,l)&&(d=u[l],h[l]=!d||typeof d!="object"||Jt.has(d.constructor)?d:o(d));return h}(e[r])}),t}function ei(t,e){return t.all||e.all||Object.keys(t).some(function(r){return e[r]&&co(e[r],t[r])})}U(jt.prototype,((Ut={add:function(t){return En(this,t),this},addKey:function(t){return Sn(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(r){return Sn(e,r,r)}),this},hasKey:function(t){var e=nr(this).next(t).value;return e&&ot(e.from,t)<=0&&0<=ot(e.to,t)}})[Vt]=function(){return nr(this)},Ut));var Le={},ni={},ri=!1;function ir(t){rr(ni,t),ri||(ri=!0,setTimeout(function(){ri=!1,ii(ni,!(ni={}))},0))}function ii(t,e){e===void 0&&(e=!1);var r=new Set;if(t.all)for(var o=0,u=Object.values(Le);o<u.length;o++)po(h=u[o],t,r,e);else for(var l in t){var d,h,l=/^idb\:\/\/(.*)\/(.*)\//.exec(l);l&&(d=l[1],l=l[2],h=Le["idb://".concat(d,"/").concat(l)])&&po(h,t,r,e)}r.forEach(function(y){return y()})}function po(t,e,r,o){for(var u=[],l=0,d=Object.entries(t.queries.query);l<d.length;l++){for(var h=d[l],y=h[0],D=[],b=0,g=h[1];b<g.length;b++){var _=g[b];ei(e,_.obsSet)?_.subscribers.forEach(function(x){return r.add(x)}):o&&D.push(_)}o&&u.push([y,D])}if(o)for(var k=0,w=u;k<w.length;k++){var v=w[k],y=v[0],D=v[1];t.queries.query[y]=D}}function ja(t){var e=t._state,r=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?xt(e.dbOpenError):t});e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var o=e.openCanceller,u=Math.round(10*t.verno),l=!1;function d(){if(e.openCanceller!==o)throw new H.DatabaseClosed("db.open() was cancelled")}function h(){return new K(function(_,k){if(d(),!r)throw new H.MissingAPI;var w=t.name,v=e.autoSchema||!u?r.open(w):r.open(w,u);if(!v)throw new H.MissingAPI;v.onerror=oe(k),v.onblocked=bt(t._fireOnBlocked),v.onupgradeneeded=bt(function(x){var T;b=v.transaction,e.autoSchema&&!t._options.allowEmptyDB?(v.onerror=bn,b.abort(),v.result.close(),(T=r.deleteDatabase(w)).onsuccess=T.onerror=bt(function(){k(new H.NoSuchDatabase("Database ".concat(w," doesnt exist")))})):(b.onerror=oe(k),T=x.oldVersion>Math.pow(2,62)?0:x.oldVersion,g=T<1,t.idbdb=v.result,l&&$a(t,b),Ca(t,T/10,b,k))},k),v.onsuccess=bt(function(){b=null;var x,T,E,O,P,j,L=t.idbdb=v.result,$=lt(L.objectStoreNames);if(0<$.length)try{var B=L.transaction((P=$).length===1?P[0]:P,"readonly");if(e.autoSchema)j=L,O=B,(E=t).verno=j.version/10,O=E._dbSchema=tr(0,j,O),E._storeNames=lt(j.objectStoreNames,0),Jn(E,[E._allTables],p(O),O);else if(er(t,t._dbSchema,B),T=B,((T=Vr(tr(0,(x=t).idbdb,T),x._dbSchema)).add.length||T.change.some(function(N){return N.add.length||N.change.length}))&&!l)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),L.close(),u=L.version+1,l=!0,_(h());Qn(t,B)}catch{}Ge.push(t),L.onversionchange=bt(function(N){e.vcFired=!0,t.on("versionchange").fire(N)}),L.onclose=bt(function(){t.close({disableAutoOpen:!1})}),g&&($=t._deps,P=w,Jr(j=$.indexedDB)||P===Yn||Qr(j,$.IDBKeyRange).put({name:P}).catch(gt)),_()},k)}).catch(function(_){switch(_==null?void 0:_.name){case"UnknownError":if(0<e.PR1398_maxLoop)return e.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),h();break;case"VersionError":if(0<u)return u=0,h()}return K.reject(_)})}var y,D=e.dbReadyResolve,b=null,g=!1;return K.race([o,(typeof navigator>"u"?K.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(_){function k(){return indexedDB.databases().finally(_)}y=setInterval(k,100),k()}).finally(function(){return clearInterval(y)}):Promise.resolve()).then(h)]).then(function(){return d(),e.onReadyBeingFired=[],K.resolve(Zr(function(){return t.on.ready.fire(t.vip)})).then(function _(){var k;if(0<e.onReadyBeingFired.length)return k=e.onReadyBeingFired.reduce(Pr,gt),e.onReadyBeingFired=[],K.resolve(Zr(function(){return k(t.vip)})).then(_)})}).finally(function(){e.openCanceller===o&&(e.onReadyBeingFired=null,e.isBeingOpened=!1)}).catch(function(_){e.dbOpenError=_;try{b&&b.abort()}catch{}return o===e.openCanceller&&t._close(),xt(_)}).finally(function(){e.openComplete=!0,D()}).then(function(){var _;return g&&(_={},t.tables.forEach(function(k){k.schema.indexes.forEach(function(w){w.name&&(_["idb://".concat(t.name,"/").concat(k.name,"/").concat(w.name)]=new jt(-1/0,[[[]]]))}),_["idb://".concat(t.name,"/").concat(k.name,"/")]=_["idb://".concat(t.name,"/").concat(k.name,"/:dels")]=new jt(-1/0,[[[]]])}),Ee(wn).fire(_),ii(_,!0)),t})}function oi(t){function e(l){return t.next(l)}var r=u(e),o=u(function(l){return t.throw(l)});function u(l){return function(h){var h=l(h),y=h.value;return h.done?y:y&&typeof y.then=="function"?y.then(r,o):m(y)?Promise.all(y).then(r,o):r(y)}}return u(e)()}function or(t,e,r){for(var o=m(t)?t.slice():[t],u=0;u<r;++u)o.push(e);return o}var La={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return a(a({},t),{table:function(o){var r=t.table(o),o=r.schema,u={},l=[];function d(_,k,w){var E=kn(_),v=u[E]=u[E]||[],x=_==null?0:typeof _=="string"?1:_.length,T=0<k,E=a(a({},w),{name:T?"".concat(E,"(virtual-from:").concat(w.name,")"):w.name,lowLevelIndex:w,isVirtual:T,keyTail:k,keyLength:x,extractKey:Hr(_),unique:!T&&w.unique});return v.push(E),E.isPrimaryKey||l.push(E),1<x&&d(x===2?_[0]:_.slice(0,x-1),k+1,w),v.sort(function(O,P){return O.keyTail-P.keyTail}),E}var h=d(o.primaryKey.keyPath,0,o.primaryKey);u[":id"]=[h];for(var y=0,D=o.indexes;y<D.length;y++){var b=D[y];d(b.keyPath,0,b)}function g(_){var k,w=_.query.index;return w.isVirtual?a(a({},_),{query:{index:w.lowLevelIndex,range:(k=_.query.range,w=w.keyTail,{type:k.type===1?2:k.type,lower:or(k.lower,k.lowerOpen?t.MAX_KEY:t.MIN_KEY,w),lowerOpen:!0,upper:or(k.upper,k.upperOpen?t.MIN_KEY:t.MAX_KEY,w),upperOpen:!0})}}):_}return a(a({},r),{schema:a(a({},o),{primaryKey:h,indexes:l,getIndexByKeyPath:function(_){return(_=u[kn(_)])&&_[0]}}),count:function(_){return r.count(g(_))},query:function(_){return r.query(g(_))},openCursor:function(_){var k=_.query.index,w=k.keyTail,v=k.keyLength;return k.isVirtual?r.openCursor(g(_)).then(function(T){return T&&x(T)}):r.openCursor(_);function x(T){return Object.create(T,{continue:{value:function(E){E!=null?T.continue(or(E,_.reverse?t.MAX_KEY:t.MIN_KEY,w)):_.unique?T.continue(T.key.slice(0,v).concat(_.reverse?t.MIN_KEY:t.MAX_KEY,w)):T.continue()}},continuePrimaryKey:{value:function(E,O){T.continuePrimaryKey(or(E,t.MAX_KEY,w),O)}},primaryKey:{get:function(){return T.primaryKey}},key:{get:function(){var E=T.key;return v===1?E[0]:E.slice(0,v)}},value:{get:function(){return T.value}}})}}})}})}};function ai(t,e,r,o){return r=r||{},o=o||"",p(t).forEach(function(u){var l,d,h;A(e,u)?(l=t[u],d=e[u],typeof l=="object"&&typeof d=="object"&&l&&d?(h=ce(l))!==ce(d)?r[o+u]=e[u]:h==="Object"?ai(l,d,r,o+u+"."):l!==d&&(r[o+u]=e[u]):l!==d&&(r[o+u]=e[u])):r[o+u]=void 0}),p(e).forEach(function(u){A(t,u)||(r[o+u]=e[u])}),r}function si(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var Ra={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return a(a({},t),{table:function(e){var r=t.table(e),o=r.schema.primaryKey;return a(a({},r),{mutate:function(u){var l=z.trans,d=l.table(e).hook,h=d.deleting,y=d.creating,D=d.updating;switch(u.type){case"add":if(y.fire===gt)break;return l._promise("readwrite",function(){return b(u)},!0);case"put":if(y.fire===gt&&D.fire===gt)break;return l._promise("readwrite",function(){return b(u)},!0);case"delete":if(h.fire===gt)break;return l._promise("readwrite",function(){return b(u)},!0);case"deleteRange":if(h.fire===gt)break;return l._promise("readwrite",function(){return function g(_,k,w){return r.query({trans:_,values:!1,query:{index:o,range:k},limit:w}).then(function(v){var x=v.result;return b({type:"delete",keys:x,trans:_}).then(function(T){return 0<T.numFailures?Promise.reject(T.failures[0]):x.length<w?{failures:[],numFailures:0,lastResult:void 0}:g(_,a(a({},k),{lower:x[x.length-1],lowerOpen:!0}),w)})})}(u.trans,u.range,1e4)},!0)}return r.mutate(u);function b(g){var _,k,w,v=z.trans,x=g.keys||si(o,g);if(x)return(g=g.type==="add"||g.type==="put"?a(a({},g),{keys:x}):a({},g)).type!=="delete"&&(g.values=c([],g.values)),g.keys&&(g.keys=c([],g.keys)),_=r,w=x,((k=g).type==="add"?Promise.resolve([]):_.getMany({trans:k.trans,keys:w,cache:"immutable"})).then(function(T){var E=x.map(function(O,P){var j,L,$,B=T[P],N={onerror:null,onsuccess:null};return g.type==="delete"?h.fire.call(N,O,B,v):g.type==="add"||B===void 0?(j=y.fire.call(N,O,g.values[P],v),O==null&&j!=null&&(g.keys[P]=O=j,o.outbound||ft(g.values[P],o.keyPath,O))):(j=ai(B,g.values[P]),(L=D.fire.call(N,j,O,B,v))&&($=g.values[P],Object.keys(L).forEach(function(M){A($,M)?$[M]=L[M]:ft($,M,L[M])}))),N});return r.mutate(g).then(function(O){for(var P=O.failures,j=O.results,L=O.numFailures,O=O.lastResult,$=0;$<x.length;++$){var B=(j||x)[$],N=E[$];B==null?N.onerror&&N.onerror(P[$]):N.onsuccess&&N.onsuccess(g.type==="put"&&T[$]?g.values[$]:B)}return{failures:P,results:j,numFailures:L,lastResult:O}}).catch(function(O){return E.forEach(function(P){return P.onerror&&P.onerror(O)}),Promise.reject(O)})});throw new Error("Keys missing")}}})}})}};function mo(t,e,r){try{if(!e||e.keys.length<t.length)return null;for(var o=[],u=0,l=0;u<e.keys.length&&l<t.length;++u)ot(e.keys[u],t[l])===0&&(o.push(r?$t(e.values[u]):e.values[u]),++l);return o.length===t.length?o:null}catch{return null}}var Ka={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var r=t.table(e);return a(a({},r),{getMany:function(o){var u;return o.cache?(u=mo(o.keys,o.trans._cache,o.cache==="clone"))?K.resolve(u):r.getMany(o).then(function(l){return o.trans._cache={keys:o.keys,values:o.cache==="clone"?$t(l):l},l}):r.getMany(o)},mutate:function(o){return o.type!=="add"&&(o.trans._cache=null),r.mutate(o)}})}}}};function go(t,e){return t.trans.mode==="readonly"&&!!t.subscr&&!t.trans.explicit&&t.trans.db._options.cache!=="disabled"&&!e.schema.primaryKey.outbound}function vo(t,e){switch(t){case"query":return e.values&&!e.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Na={stack:"dbcore",level:0,name:"Observability",create:function(t){var e=t.schema.name,r=new jt(t.MIN_KEY,t.MAX_KEY);return a(a({},t),{transaction:function(o,u,l){if(z.subscr&&u!=="readonly")throw new H.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(z.querier));return t.transaction(o,u,l)},table:function(o){function u(x){var v,x=x.query;return[v=x.index,new jt((v=(x=x.range).lower)!=null?v:t.MIN_KEY,(v=x.upper)!=null?v:t.MAX_KEY)]}var l=t.table(o),d=l.schema,h=d.primaryKey,y=d.indexes,D=h.extractKey,b=h.outbound,g=h.autoIncrement&&y.filter(function(w){return w.compound&&w.keyPath.includes(h.keyPath)}),_=a(a({},l),{mutate:function(w){function v(F){return F="idb://".concat(e,"/").concat(o,"/").concat(F),P[F]||(P[F]=new jt)}var x,T,E,O=w.trans,P=w.mutatedParts||(w.mutatedParts={}),j=v(""),L=v(":dels"),$=w.type,N=w.type==="deleteRange"?[w.range]:w.type==="delete"?[w.keys]:w.values.length<50?[si(h,w).filter(function(F){return F}),w.values]:[],B=N[0],N=N[1],M=w.trans._cache;return m(B)?(j.addKeys(B),($=$==="delete"||B.length===N.length?mo(B,M):null)||L.addKeys(B),($||N)&&(x=v,T=$,E=N,d.indexes.forEach(function(F){var st=x(F.name||"");function dt(nt){return nt!=null?F.extractKey(nt):null}function X(nt){F.multiEntry&&m(nt)?nt.forEach(function(_t){return st.addKey(_t)}):st.addKey(nt)}(T||E).forEach(function(nt,Et){var Gt=T&&dt(T[Et]),Et=E&&dt(E[Et]);ot(Gt,Et)!==0&&(Gt!=null&&X(Gt),Et!=null)&&X(Et)})}))):B?(N={from:(M=B.lower)!=null?M:t.MIN_KEY,to:($=B.upper)!=null?$:t.MAX_KEY},L.add(N),j.add(N)):(j.add(r),L.add(r),d.indexes.forEach(function(F){return v(F.name).add(r)})),l.mutate(w).then(function(F){return!B||w.type!=="add"&&w.type!=="put"||(j.addKeys(F.results),g&&g.forEach(function(st){for(var dt=w.values.map(function(Gt){return st.extractKey(Gt)}),X=st.keyPath.findIndex(function(Gt){return Gt===h.keyPath}),nt=0,_t=F.results.length;nt<_t;++nt)dt[nt][X]=F.results[nt];v(st.name).addKeys(dt)})),O.mutatedParts=rr(O.mutatedParts||{},P),F})}}),k={get:function(w){return[h,new jt(w.key)]},getMany:function(w){return[h,new jt().addKeys(w.keys)]},count:u,query:u,openCursor:u};return p(k).forEach(function(w){_[w]=function(v){var x=z.subscr,T=!!x,E=go(z,l)&&vo(w,v)?v.obsSet={}:x;if(T){var O,x=function(N){return N="idb://".concat(e,"/").concat(o,"/").concat(N),E[N]||(E[N]=new jt)},P=x(""),j=x(":dels"),T=k[w](v),L=T[0],T=T[1];if((w==="query"&&L.isPrimaryKey&&!v.values?j:x(L.name||"")).add(T),!L.isPrimaryKey){if(w!=="count")return O=w==="query"&&b&&v.values&&l.query(a(a({},v),{values:!1})),l[w].apply(this,arguments).then(function(N){if(w==="query"){if(b&&v.values)return O.then(function(dt){return dt=dt.result,P.addKeys(dt),N});var M=v.values?N.result.map(D):N.result;(v.values?P:j).addKeys(M)}else{var F,st;if(w==="openCursor")return st=v.values,(F=N)&&Object.create(F,{key:{get:function(){return j.addKey(F.primaryKey),F.key}},primaryKey:{get:function(){var dt=F.primaryKey;return j.addKey(dt),dt}},value:{get:function(){return st&&P.addKey(F.primaryKey),F.value}}})}return N});j.add(r)}}return l[w].apply(this,arguments)}}),_}})}};function yo(t,e,r){var o;return r.numFailures===0?e:e.type==="deleteRange"||(o=e.keys?e.keys.length:"values"in e&&e.values?e.values.length:1,r.numFailures===o)?null:(o=a({},e),m(o.keys)&&(o.keys=o.keys.filter(function(u,l){return!(l in r.failures)})),"values"in o&&m(o.values)&&(o.values=o.values.filter(function(u,l){return!(l in r.failures)})),o)}function ui(t,e){return r=t,((o=e).lower===void 0||(o.lowerOpen?0<ot(r,o.lower):0<=ot(r,o.lower)))&&(r=t,(o=e).upper===void 0||(o.upperOpen?ot(r,o.upper)<0:ot(r,o.upper)<=0));var r,o}function bo(t,e,r,o,u,l){var d,h,y,D,b,g;return!r||r.length===0||(d=e.query.index,h=d.multiEntry,y=e.query.range,D=o.schema.primaryKey.extractKey,b=d.extractKey,g=(d.lowLevelIndex||d).extractKey,(o=r.reduce(function(_,k){var w=_,v=[];if(k.type==="add"||k.type==="put")for(var x=new jt,T=k.values.length-1;0<=T;--T){var E,O=k.values[T],P=D(O);!x.hasKey(P)&&(E=b(O),h&&m(E)?E.some(function(N){return ui(N,y)}):ui(E,y))&&(x.addKey(P),v.push(O))}switch(k.type){case"add":var j=new jt().addKeys(e.values?_.map(function(M){return D(M)}):_),w=_.concat(e.values?v.filter(function(M){return M=D(M),!j.hasKey(M)&&(j.addKey(M),!0)}):v.map(function(M){return D(M)}).filter(function(M){return!j.hasKey(M)&&(j.addKey(M),!0)}));break;case"put":var L=new jt().addKeys(k.values.map(function(M){return D(M)}));w=_.filter(function(M){return!L.hasKey(e.values?D(M):M)}).concat(e.values?v:v.map(function(M){return D(M)}));break;case"delete":var $=new jt().addKeys(k.keys);w=_.filter(function(M){return!$.hasKey(e.values?D(M):M)});break;case"deleteRange":var B=k.range;w=_.filter(function(M){return!ui(D(M),B)})}return w},t))===t)?t:(o.sort(function(_,k){return ot(g(_),g(k))||ot(D(_),D(k))}),e.limit&&e.limit<1/0&&(o.length>e.limit?o.length=e.limit:t.length===e.limit&&o.length<e.limit&&(u.dirty=!0)),l?Object.freeze(o):o)}function wo(t,e){return ot(t.lower,e.lower)===0&&ot(t.upper,e.upper)===0&&!!t.lowerOpen==!!e.lowerOpen&&!!t.upperOpen==!!e.upperOpen}function Ba(t,e){return((r,o,u,l)=>{if(r===void 0)return o!==void 0?-1:0;if(o===void 0)return 1;if((r=ot(r,o))===0){if(u&&l)return 0;if(u)return 1;if(l)return-1}return r})(t.lower,e.lower,t.lowerOpen,e.lowerOpen)<=0&&0<=((r,o,u,l)=>{if(r===void 0)return o!==void 0?1:0;if(o===void 0)return-1;if((r=ot(r,o))===0){if(u&&l)return 0;if(u)return-1;if(l)return 1}return r})(t.upper,e.upper,t.upperOpen,e.upperOpen)}function qa(t,e,r,o){t.subscribers.add(r),o.addEventListener("abort",function(){var u,l;t.subscribers.delete(r),t.subscribers.size===0&&(u=t,l=e,setTimeout(function(){u.subscribers.size===0&&Wt(l,u)},3e3))})}var Fa={stack:"dbcore",level:0,name:"Cache",create:function(t){var e=t.schema.name;return a(a({},t),{transaction:function(r,o,u){var l,d,h=t.transaction(r,o,u);return o==="readwrite"&&(u=(l=new AbortController).signal,h.addEventListener("abort",(d=function(y){return function(){if(l.abort(),o==="readwrite"){for(var D=new Set,b=0,g=r;b<g.length;b++){var _=g[b],k=Le["idb://".concat(e,"/").concat(_)];if(k){var w=t.table(_),v=k.optimisticOps.filter(function(F){return F.trans===h});if(h._explicit&&y&&h.mutatedParts)for(var x=0,T=Object.values(k.queries.query);x<T.length;x++)for(var E=0,O=(L=T[x]).slice();E<O.length;E++)ei(($=O[E]).obsSet,h.mutatedParts)&&(Wt(L,$),$.subscribers.forEach(function(F){return D.add(F)}));else if(0<v.length){k.optimisticOps=k.optimisticOps.filter(function(F){return F.trans!==h});for(var P=0,j=Object.values(k.queries.query);P<j.length;P++)for(var L,$,B,N=0,M=(L=j[P]).slice();N<M.length;N++)($=M[N]).res!=null&&h.mutatedParts&&(y&&!$.dirty?(B=Object.isFrozen($.res),B=bo($.res,$.req,v,w,$,B),$.dirty?(Wt(L,$),$.subscribers.forEach(function(F){return D.add(F)})):B!==$.res&&($.res=B,$.promise=K.resolve({result:B}))):($.dirty&&Wt(L,$),$.subscribers.forEach(function(F){return D.add(F)})))}}}D.forEach(function(F){return F()})}}})(!1),{signal:u}),h.addEventListener("error",d(!1),{signal:u}),h.addEventListener("complete",d(!0),{signal:u})),h},table:function(r){var o=t.table(r),u=o.schema.primaryKey;return a(a({},o),{mutate:function(l){var d,h=z.trans;return!u.outbound&&h.db._options.cache!=="disabled"&&!h.explicit&&h.idbtrans.mode==="readwrite"&&(d=Le["idb://".concat(e,"/").concat(r)])?(h=o.mutate(l),l.type!=="add"&&l.type!=="put"||!(50<=l.values.length||si(u,l).some(function(y){return y==null}))?(d.optimisticOps.push(l),l.mutatedParts&&ir(l.mutatedParts),h.then(function(y){0<y.numFailures&&(Wt(d.optimisticOps,l),(y=yo(0,l,y))&&d.optimisticOps.push(y),l.mutatedParts)&&ir(l.mutatedParts)}),h.catch(function(){Wt(d.optimisticOps,l),l.mutatedParts&&ir(l.mutatedParts)})):h.then(function(y){var D=yo(0,a(a({},l),{values:l.values.map(function(b,g){var _;return y.failures[g]?b:(ft(_=(_=u.keyPath)!=null&&_.includes(".")?$t(b):a({},b),u.keyPath,y.results[g]),_)})}),y);d.optimisticOps.push(D),queueMicrotask(function(){return l.mutatedParts&&ir(l.mutatedParts)})}),h):o.mutate(l)},query:function(l){var d,h,y,D,b,g,_;return go(z,o)&&vo("query",l)?(d=((y=z.trans)==null?void 0:y.db._options.cache)==="immutable",h=(y=z).requery,y=y.signal,g=((k,w,v,x)=>{var T=Le["idb://".concat(k,"/").concat(w)];if(!T)return[];if(!(k=T.queries[v]))return[null,!1,T,null];var E=k[(x.query?x.query.index.name:null)||""];if(!E)return[null,!1,T,null];switch(v){case"query":var O=E.find(function(P){return P.req.limit===x.limit&&P.req.values===x.values&&wo(P.req.query.range,x.query.range)});return O?[O,!0,T,E]:[E.find(function(P){return("limit"in P.req?P.req.limit:1/0)>=x.limit&&(!x.values||P.req.values)&&Ba(P.req.query.range,x.query.range)}),!1,T,E];case"count":return O=E.find(function(P){return wo(P.req.query.range,x.query.range)}),[O,!!O,T,E]}})(e,r,"query",l),_=g[0],D=g[2],b=g[3],_&&g[1]?_.obsSet=l.obsSet:(g=o.query(l).then(function(k){var w=k.result;if(_&&(_.res=w),d){for(var v=0,x=w.length;v<x;++v)Object.freeze(w[v]);Object.freeze(w)}else k.result=$t(w);return k}).catch(function(k){return b&&_&&Wt(b,_),Promise.reject(k)}),_={obsSet:l.obsSet,promise:g,subscribers:new Set,type:"query",req:l,dirty:!1},b?b.push(_):(b=[_],(D=D||(Le["idb://".concat(e,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[l.query.index.name||""]=b)),qa(_,b,h,y),_.promise.then(function(k){return{result:bo(k.result,l,D==null?void 0:D.optimisticOps,o,_,d)}})):o.query(l)}})}})}};function ar(t,e){return new Proxy(t,{get:function(r,o,u){return o==="db"?e:Reflect.get(r,o,u)}})}Tt.prototype.version=function(t){if(isNaN(t)||t<.1)throw new H.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new H.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=this._versions,r=e.filter(function(o){return o._cfg.version===t})[0];return r||(r=new this.Version(t),e.push(r),e.sort(Pa),r.stores({}),this._state.autoSchema=!1),r},Tt.prototype._whenReady=function(t){var e=this;return this.idbdb&&(this._state.openComplete||z.letThrough||this._vip)?t():new K(function(r,o){if(e._state.openComplete)return o(new H.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return void o(new H.DatabaseClosed);e.open().catch(gt)}e._state.dbReadyPromise.then(r,o)}).then(t)},Tt.prototype.use=function(u){var e=u.stack,r=u.create,o=u.level,u=u.name,l=(u&&this.unuse({stack:e,name:u}),this._middlewares[e]||(this._middlewares[e]=[]));return l.push({stack:e,create:r,level:o??10,name:u}),l.sort(function(d,h){return d.level-h.level}),this},Tt.prototype.unuse=function(t){var e=t.stack,r=t.name,o=t.create;return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(function(u){return o?u.create!==o:!!r&&u.name!==r})),this},Tt.prototype.open=function(){var t=this;return $e(be,function(){return ja(t)})},Tt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var t=this._state,e=Ge.indexOf(this);if(0<=e&&Ge.splice(e,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new K(function(r){t.dbReadyResolve=r}),t.openCanceller=new K(function(r,o){t.cancelOpen=o}))},Tt.prototype.close=function(e){var e=(e===void 0?{disableAutoOpen:!0}:e).disableAutoOpen,r=this._state;e?(r.isBeingOpened&&r.cancelOpen(new H.DatabaseClosed),this._close(),r.autoOpen=!1,r.dbOpenError=new H.DatabaseClosed):(this._close(),r.autoOpen=this._options.autoOpen||r.isBeingOpened,r.openComplete=!1,r.dbOpenError=null)},Tt.prototype.delete=function(t){var e=this,r=(t===void 0&&(t={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),o=this._state;return new K(function(u,l){function d(){e.close(t);var h=e._deps.indexedDB.deleteDatabase(e.name);h.onsuccess=bt(function(){var y,D,b;y=e._deps,D=e.name,Jr(b=y.indexedDB)||D===Yn||Qr(b,y.IDBKeyRange).delete(D).catch(gt),u()}),h.onerror=oe(l),h.onblocked=e._fireOnBlocked}if(r)throw new H.InvalidArgument("Invalid closeOptions argument to db.delete()");o.isBeingOpened?o.dbReadyPromise.then(d):d()})},Tt.prototype.backendDB=function(){return this.idbdb},Tt.prototype.isOpen=function(){return this.idbdb!==null},Tt.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},Tt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Tt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Tt.prototype,"tables",{get:function(){var t=this;return p(this._allTables).map(function(e){return t._allTables[e]})},enumerable:!1,configurable:!0}),Tt.prototype.transaction=function(){var t=(function(e,r,o){var u=arguments.length;if(u<2)throw new H.InvalidArgument("Too few arguments");for(var l=new Array(u-1);--u;)l[u-1]=arguments[u];return o=l.pop(),[e,ve(l),o]}).apply(this,arguments);return this._transaction.apply(this,t)},Tt.prototype._transaction=function(t,e,r){var o,u,l=this,d=z.trans,h=(d&&d.db===this&&t.indexOf("!")===-1||(d=null),t.indexOf("?")!==-1);t=t.replace("!","").replace("?","");try{if(u=e.map(function(D){if(D=D instanceof l.Table?D.name:D,typeof D!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return D}),t=="r"||t===Br)o=Br;else{if(t!="rw"&&t!=qr)throw new H.InvalidArgument("Invalid transaction mode: "+t);o=qr}if(d){if(d.mode===Br&&o===qr){if(!h)throw new H.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");d=null}d&&u.forEach(function(D){if(d&&d.storeNames.indexOf(D)===-1){if(!h)throw new H.SubTransaction("Table "+D+" not included in parent transaction.");d=null}}),h&&d&&!d.active&&(d=null)}}catch(D){return d?d._promise(null,function(b,g){g(D)}):xt(D)}var y=(function D(b,g,_,k,w){return K.resolve().then(function(){var E=z.transless||z,v=b._createTransaction(g,_,b._dbSchema,k),E=(v.explicit=!0,{trans:v,transless:E});if(k)v.idbtrans=k.idbtrans;else try{v.create(),v.idbtrans._explicit=!0,b._state.PR1398_maxLoop=3}catch(O){return O.name===Ar.InvalidState&&b.isOpen()&&0<--b._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),b.close({disableAutoOpen:!1}),b.open().then(function(){return D(b,g,_,null,w)})):xt(O)}var x,T=Ue(w),E=(T&&Ve(),K.follow(function(){var O;(x=w.call(v,v))&&(T?(O=_e.bind(null,null),x.then(O,O)):typeof x.next=="function"&&typeof x.throw=="function"&&(x=oi(x)))},E));return(x&&typeof x.then=="function"?K.resolve(x).then(function(O){return v.active?O:xt(new H.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):E.then(function(){return x})).then(function(O){return k&&v._resolve(),v._completion.then(function(){return O})}).catch(function(O){return v._reject(O),xt(O)})})}).bind(null,this,o,u,d,r);return d?d._promise(o,y,"lock"):z.trans?$e(z.transless,function(){return l._whenReady(y)}):this._whenReady(y)},Tt.prototype.table=function(t){if(A(this._allTables,t))return this._allTables[t];throw new H.InvalidTable("Table ".concat(t," does not exist"))};var fe=Tt;function Tt(t,e){var r,o,u,l,d,h=this,y=(this._middlewares={},this.verno=0,Tt.dependencies),y=(this._options=e=a({addons:Tt.addons,autoOpen:!0,indexedDB:y.indexedDB,IDBKeyRange:y.IDBKeyRange,cache:"cloned"},e),this._deps={indexedDB:e.indexedDB,IDBKeyRange:e.IDBKeyRange},e.addons),D=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:gt,dbReadyPromise:null,cancelOpen:gt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:e.autoOpen}),b=(D.dbReadyPromise=new K(function(g){D.dbReadyResolve=g}),D.openCanceller=new K(function(g,_){D.cancelOpen=_}),this._state=D,this.name=t,this.on=vn(this,"populate","blocked","versionchange","close",{ready:[Pr,gt]}),this.once=function(g,_){var k=function(){for(var w=[],v=0;v<arguments.length;v++)w[v]=arguments[v];h.on(g).unsubscribe(k),_.apply(h,w)};return h.on(g,k)},this.on.ready.subscribe=ht(this.on.ready.subscribe,function(g){return function(_,k){Tt.vip(function(){var w,v=h._state;v.openComplete?(v.dbOpenError||K.resolve().then(_),k&&g(_)):v.onReadyBeingFired?(v.onReadyBeingFired.push(_),k&&g(_)):(g(_),w=h,k||g(function x(){w.on.ready.unsubscribe(_),w.on.ready.unsubscribe(x)}))})}}),this.Collection=(r=this,yn(Ea.prototype,function(x,v){this.db=r;var k=Xi,w=null;if(v)try{k=v()}catch(E){w=E}var v=x._ctx,x=v.table,T=x.hook.reading.fire;this._ctx={table:x,index:v.index,isPrimKey:!v.index||x.schema.primKey.keyPath&&v.index===x.schema.primKey.name,range:k,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:w,or:v.or,valueMapper:T!==dn?T:null}})),this.Table=(o=this,yn(to.prototype,function(g,_,k){this.db=o,this._tx=k,this.name=g,this.schema=_,this.hook=o._allTables[g]?o._allTables[g].hook:vn(null,{creating:[ma,gt],reading:[pa,dn],updating:[va,gt],deleting:[ga,gt]})})),this.Transaction=(u=this,yn(Ta.prototype,function(g,_,k,w,v){var x=this;g!=="readonly"&&_.forEach(function(T){T=(T=k[T])==null?void 0:T.yProps,T&&(_=_.concat(T.map(function(E){return E.updatesTable})))}),this.db=u,this.mode=g,this.storeNames=_,this.schema=k,this.chromeTransactionDurability=w,this.idbtrans=null,this.on=vn(this,"complete","error","abort"),this.parent=v||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new K(function(T,E){x._resolve=T,x._reject=E}),this._completion.then(function(){x.active=!1,x.on.complete.fire()},function(T){var E=x.active;return x.active=!1,x.on.error.fire(T),x.parent?x.parent._reject(T):E&&x.idbtrans&&x.idbtrans.abort(),xt(T)})})),this.Version=(l=this,yn(Ma.prototype,function(g){this.db=l,this._cfg={version:g,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(d=this,yn(oo.prototype,function(g,_,k){if(this.db=d,this._ctx={table:g,index:_===":id"?null:_,or:k},this._cmp=this._ascending=ot,this._descending=function(w,v){return ot(v,w)},this._max=function(w,v){return 0<ot(w,v)?w:v},this._min=function(w,v){return ot(w,v)<0?w:v},this._IDBKeyRange=d._deps.IDBKeyRange,!this._IDBKeyRange)throw new H.MissingAPI})),this.on("versionchange",function(g){0<g.newVersion?console.warn("Another connection wants to upgrade database '".concat(h.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(h.name,"'. Closing db now to resume the delete request.")),h.close({disableAutoOpen:!1})}),this.on("blocked",function(g){!g.newVersion||g.newVersion<g.oldVersion?console.warn("Dexie.delete('".concat(h.name,"') was blocked")):console.warn("Upgrade '".concat(h.name,"' blocked by other connection holding version ").concat(g.oldVersion/10))}),this._maxKey=_n(e.IDBKeyRange),this._createTransaction=function(g,_,k,w){return new h.Transaction(g,_,k,h._options.chromeTransactionDurability,w)},this._fireOnBlocked=function(g){h.on("blocked").fire(g),Ge.filter(function(_){return _.name===h.name&&_!==h&&!_._state.vcFired}).map(function(_){return _.on("versionchange").fire(g)})},this.use(Ka),this.use(Fa),this.use(Na),this.use(La),this.use(Ra),new Proxy(this,{get:function(g,_,k){var w;return _==="_vip"||(_==="table"?function(v){return ar(h.table(v),b)}:(w=Reflect.get(g,_,k))instanceof to?ar(w,b):_==="tables"?w.map(function(v){return ar(v,b)}):_==="_createTransaction"?function(){return ar(w.apply(this,arguments),b)}:w)}}));this.vip=b,y.forEach(function(g){return g(h)})}var sr,tn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Wa=(li.prototype.subscribe=function(t,e,r){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:e,complete:r})},li.prototype[tn]=function(){return this},li);function li(t){this._subscribe=t}try{sr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{sr={indexedDB:null,IDBKeyRange:null}}function _o(t){var e,r=!1,o=new Wa(function(u){var l=Ue(t),d,h=!1,y={},D={},b={get closed(){return h},unsubscribe:function(){h||(h=!0,d&&d.abort(),g&&Ee.storagemutated.unsubscribe(k))}},g=(u.start&&u.start(b),!1),_=function(){return Nr(w)},k=function(v){rr(y,v),ei(D,y)&&_()},w=function(){var v,x,T;!h&&sr.indexedDB&&(y={},v={},d&&d.abort(),d=new AbortController,T=(E=>{var O=He();try{l&&Ve();var P=we(t,E);return P=l?P.finally(_e):P}finally{O&&Xe()}})(x={subscr:v,signal:d.signal,requery:_,querier:t,trans:null}),Promise.resolve(T).then(function(E){r=!0,e=E,h||x.signal.aborted||(y={},(O=>{for(var P in O)if(A(O,P))return;return 1})(D=v)||g||(Ee(wn,k),g=!0),Nr(function(){return!h&&u.next&&u.next(E)}))},function(E){r=!1,["DatabaseClosedError","AbortError"].includes(E==null?void 0:E.name)||h||Nr(function(){h||u.error&&u.error(E)})}))};return setTimeout(_,0),b});return o.hasValue=function(){return r},o.getValue=function(){return e},o}var Re=fe;function ci(t){var e=De;try{De=!0,Ee.storagemutated.fire(t),ii(t,!0)}finally{De=e}}U(Re,a(a({},te),{delete:function(t){return new Re(t,{addons:[]}).delete()},exists:function(t){return new Re(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return e=Re.dependencies,r=e.indexedDB,e=e.IDBKeyRange,(Jr(r)?Promise.resolve(r.databases()).then(function(o){return o.map(function(u){return u.name}).filter(function(u){return u!==Yn})}):Qr(r,e).toCollection().primaryKeys()).then(t)}catch{return xt(new H.MissingAPI)}var e,r},defineClass:function(){return function(t){S(this,t)}},ignoreTransaction:function(t){return z.trans?$e(z.transless,t):t()},vip:Zr,async:function(t){return function(){try{var e=oi(t.apply(this,arguments));return e&&typeof e.then=="function"?e:K.resolve(e)}catch(r){return xt(r)}}},spawn:function(t,e,r){try{var o=oi(t.apply(r,e||[]));return o&&typeof o.then=="function"?o:K.resolve(o)}catch(u){return xt(u)}},currentTransaction:{get:function(){return z.trans||null}},waitFor:function(t,e){return t=K.resolve(typeof t=="function"?Re.ignoreTransaction(t):t).timeout(e||6e4),z.trans?z.trans.waitFor(t):t},Promise:K,debug:{get:function(){return ie},set:function(t){qi(t)}},derive:q,extend:S,props:U,override:ht,Events:vn,on:Ee,liveQuery:_o,extendObservabilitySet:rr,getByKeyPath:pt,setByKeyPath:ft,delByKeyPath:function(t,e){typeof e=="string"?ft(t,e,void 0):"length"in e&&[].map.call(e,function(r){ft(t,r,void 0)})},shallowClone:mt,deepClone:$t,getObjectDiff:ai,cmp:ot,asap:et,minKey:-1/0,addons:[],connections:Ge,errnames:Ar,dependencies:sr,cache:Le,semVer:"4.3.0",version:"4.3.0".split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,r){return t+e/Math.pow(10,2*r)})})),Re.maxKey=_n(Re.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ee(wn,function(t){De||(t=new CustomEvent(Ur,{detail:t}),De=!0,dispatchEvent(t),De=!1)}),addEventListener(Ur,function(t){t=t.detail,De||ci(t)}));var en,De=!1,ko=function(){};return typeof BroadcastChannel<"u"&&((ko=function(){(en=new BroadcastChannel(Ur)).onmessage=function(t){return t.data&&ci(t.data)}})(),typeof en.unref=="function"&&en.unref(),Ee(wn,function(t){De||en.postMessage(t)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(t){if(!fe.disableBfCache&&t.persisted){ie&&console.debug("Dexie: handling persisted pagehide"),en!=null&&en.close();for(var e=0,r=Ge;e<r.length;e++)r[e].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(t){!fe.disableBfCache&&t.persisted&&(ie&&console.debug("Dexie: handling persisted pageshow"),ko(),ci({all:new jt(-1/0,[[]])}))})),K.rejectionMapper=function(t,e){return!t||t instanceof Ye||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Bi[t.name]?t:(e=new Bi[t.name](e||t.message,t),"stack"in t&&Y(e,"stack",{get:function(){return this.inner.stack}}),e)},qi(ie),a(fe,Object.freeze({__proto__:null,Dexie:fe,Entity:Vi,PropModification:gn,RangeSet:jt,add:function(t){return new gn({add:t})},cmp:ot,default:fe,liveQuery:_o,mergeRanges:En,rangesOverlap:co,remove:function(t){return new gn({remove:t})},replacePrefix:function(t,e){return new gn({replacePrefix:[t,e]})}}),{default:fe}),fe})})(Wo);var Va=Wo.exports;const Si=Xa(Va),Do=Symbol.for("Dexie"),_r=globalThis[Do]||(globalThis[Do]=Si);if(Si.semVer!==_r.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Si.semVer} and ${_r.semVer}`);const{liveQuery:Vs,mergeRanges:Gs,rangesOverlap:Qs,RangeSet:Js,cmp:Zs,Entity:tu,PropModification:eu,replacePrefix:nu,add:ru,remove:iu,DexieYProvider:ou}=_r;class Ga extends _r{constructor(){super("GymDatabase");he(this,"workouts");he(this,"logs");he(this,"workoutTypes");he(this,"profile");this.version(1).stores({workouts:"id, status, startTime, updatedAt, isDeleted",logs:"id, workoutId, workoutTypeId, date, updatedAt, isDeleted",workoutTypes:"id, updatedAt, isDeleted",profile:"id, updatedAt, isDeleted"})}}const tt=new Ga,Ai="gym_web_auth";function Ir(){const s=localStorage.getItem(Ai);try{return s?JSON.parse(s):null}catch{return null}}function Pi(s){localStorage.setItem(Ai,JSON.stringify(s))}function Uo(){localStorage.removeItem(Ai)}function Yo(){const s=Ir();if(!s)return null;const n=new URLSearchParams;return Object.entries(s).forEach(([i,a])=>{a!=null&&n.append(i,String(a))}),n.toString()}const Qa=Object.freeze(Object.defineProperty({__proto__:null,clearAuthData:Uo,getAuthData:Ir,getAuthString:Yo,saveAuthData:Pi},Symbol.toStringTag,{value:"Module"}));var No;const ur=(No=window.Telegram)==null?void 0:No.WebApp,xo="https://functions.yandexcloud.net/d4ehnqvq3a8fo55t7tj4";class To{static getHeaders(){const n={"Content-Type":"application/json"};if(ur!=null&&ur.initData)localStorage.getItem("skip_tma_auth")==="true"||(n["X-Telegram-Init-Data"]=ur.initData);else{const i=Yo();i&&(n["X-Telegram-Init-Data"]=i)}return n}static async sync(){if(!navigator.onLine)throw new Error("Offline");const n=this.getHeaders(),i=await fetch(xo,{headers:n});if(!i.ok)throw i.status===401?new Error("Unauthorized"):new Error("Sync failed");const a=await i.json();await this.mergeData(a);const c=await this.readAll();await fetch(xo,{method:"POST",headers:n,body:JSON.stringify(c)})}static async mergeData(n){await tt.transaction("rw",tt.workouts,tt.logs,tt.workoutTypes,tt.profile,async()=>{if(await this.mergeTable(tt.workouts,n.workouts),await this.mergeTable(tt.logs,n.logs),await this.mergeTable(tt.workoutTypes,n.workoutTypes),n.profile){const i={...n.profile,id:"me"};await this.mergeTable(tt.profile,[i])}})}static async mergeTable(n,i=[]){const a=await n.toArray(),c=new Map(a.map(f=>[f.id,f]));for(const f of i){const p=c.get(f.id);if(!p)await n.put(f);else{const m=new Date(f.updatedAt).getTime(),S=new Date(p.updatedAt).getTime();m>S&&await n.put(f)}}}static async readAll(){return{workouts:await tt.workouts.toArray(),logs:await tt.logs.toArray(),workoutTypes:await tt.workoutTypes.toArray(),profile:(await tt.profile.toArray())[0]}}}const Ja="gym_twa_data";var Bo;const nn=(Bo=window.Telegram)==null?void 0:Bo.WebApp,fi={workoutTypes:[{id:"1",name:"ÐÐ¸Ð¼ Ð»ÐµÐ¶Ð°",updatedAt:new Date().toISOString()},{id:"2",name:"ÐÑÐ¸ÑÐµÐ´Ð°Ð½Ð¸Ñ",updatedAt:new Date().toISOString()},{id:"3",name:"Ð¡ÑÐ°Ð½Ð¾Ð²Ð°Ñ ÑÑÐ³Ð°",updatedAt:new Date().toISOString()}],logs:[],workouts:[]};class Za{constructor(){he(this,"onUpdateCallback");he(this,"onSyncStatusChangeCallback");he(this,"status","idle");he(this,"cache",{...fi});this.init()}async init(){await this.migrateFromLocalStorage(),this.sync().catch(console.error)}async migrateFromLocalStorage(){const n=localStorage.getItem(Ja);if(n)try{const i=JSON.parse(n);if(await tt.workoutTypes.count()===0){console.log("Migrating from localStorage to IDB...");const c=new Date().toISOString(),f=(i.workoutTypes||fi.workoutTypes).map(S=>({...S,updatedAt:c}));await tt.workoutTypes.bulkPut(f);const p=(i.logs||[]).map(S=>({...S,updatedAt:c,workoutId:S.workoutId||"legacy"}));await tt.logs.bulkPut(p);const m=(i.workouts||[]).map(S=>({...S,updatedAt:c}));if(await tt.workouts.bulkPut(m),i.profile){const S={...i.profile,id:"me",updatedAt:c};await tt.profile.put(S)}}}catch(i){console.error("Migration failed",i)}else await tt.workoutTypes.count()===0&&await tt.workoutTypes.bulkPut(fi.workoutTypes)}onUpdate(n){this.onUpdateCallback=n}onSyncStatusChange(n){this.onSyncStatusChangeCallback=n}setStatus(n){var i;this.status=n,(i=this.onSyncStatusChangeCallback)==null||i.call(this,n),n==="success"&&setTimeout(()=>{this.status==="success"&&this.setStatus("idle")},2e3)}async sync(){var i;const n=localStorage.getItem("skip_tma_auth")==="true";if(n&&!(await Fo(async()=>{const{getAuthString:c}=await Promise.resolve().then(()=>Qa);return{getAuthString:c}},void 0,import.meta.url)).getAuthString()){this.setStatus("idle");return}try{this.setStatus("saving"),await To.sync(),this.setStatus("success"),(i=this.onUpdateCallback)==null||i.call(this)}catch(a){if(console.error("Sync failed",a),(a instanceof Error?a.message:String(a)).toLowerCase().includes("unauthorized")){if(n){this.setStatus("error");return}localStorage.setItem("skip_tma_auth","true"),Uo(),location.reload();return}a instanceof Error&&a.message==="Offline"?this.setStatus("idle"):this.setStatus("error")}}async reloadCache(){var n;this.cache=await To.readAll(),(n=this.onUpdateCallback)==null||n.call(this)}getWorkoutTypes(){return this.cache.workoutTypes.filter(i=>!i.isDeleted).sort((i,a)=>(i.order??1/0)-(a.order??1/0))}getLogs(){return this.cache.logs.filter(n=>!n.isDeleted)}getWorkouts(){return this.cache.workouts.filter(n=>!n.isDeleted)}getActiveWorkout(){return this.cache.workouts.find(n=>!n.isDeleted&&(n.status==="active"||n.status==="paused"))}getProfile(){return this.cache.profile}async addWorkoutType(n,i="strength"){const a=this.getWorkoutTypes(),c=a.length>0?Math.max(...a.map(p=>p.order??0)):0,f={id:Date.now().toString(),name:n,category:i,order:c+1,updatedAt:new Date().toISOString()};return await tt.workoutTypes.put(f),await this.reloadCache(),this.sync().catch(()=>{}),f}async deleteWorkoutType(n){const i=await tt.workoutTypes.get(n);i&&(i.isDeleted=!0,i.updatedAt=new Date().toISOString(),await tt.workoutTypes.put(i),await this.reloadCache(),this.sync().catch(()=>{}))}async updateWorkoutType(n,i,a){const c=await tt.workoutTypes.get(n);c&&(c.name=i,a&&(c.category=a),c.updatedAt=new Date().toISOString(),await tt.workoutTypes.put(c),await this.reloadCache(),this.sync().catch(()=>{}))}async startWorkout(n){this.getActiveWorkout()&&await this.finishWorkout();const a={id:Date.now().toString(),startTime:new Date().toISOString(),status:"active",name:n,isManual:!0,pauseIntervals:[],updatedAt:new Date().toISOString()};return await tt.workouts.put(a),await this.reloadCache(),this.sync().catch(()=>{}),a}async pauseWorkout(){const n=this.getActiveWorkout();n&&n.status==="active"&&(n.status="paused",n.pauseIntervals.push({start:new Date().toISOString()}),n.updatedAt=new Date().toISOString(),await tt.workouts.put(n),await this.reloadCache(),this.sync().catch(()=>{}))}async resumeWorkout(){const n=this.getActiveWorkout();if(n&&n.status==="paused"){n.status="active";const i=n.pauseIntervals[n.pauseIntervals.length-1];i&&!i.end&&(i.end=new Date().toISOString()),n.updatedAt=new Date().toISOString(),await tt.workouts.put(n),await this.reloadCache(),this.sync().catch(()=>{})}}async finishWorkout(){const n=this.getActiveWorkout();if(n){n.status="finished",n.endTime=new Date().toISOString();const i=n.pauseIntervals[n.pauseIntervals.length-1];i&&!i.end&&(i.end=n.endTime),n.updatedAt=new Date().toISOString(),await tt.workouts.put(n),await this.reloadCache(),this.sync().catch(()=>{})}}getWorkoutDuration(n){const i=new Date(n.startTime).getTime(),a=n.endTime?new Date(n.endTime).getTime():Date.now();let c=a-i;return n.pauseIntervals.forEach(p=>{const m=new Date(p.start).getTime(),S=p.end?new Date(p.end).getTime():n.status==="paused"?Date.now():a;S>m&&(c-=S-m)}),Math.floor(Math.max(0,c)/6e4)}async ensureActiveWorkout(){const n=this.getActiveWorkout();if(n)return n.id;const i=new Date().toISOString().split("T")[0],f=this.getWorkouts().filter(S=>S.startTime.startsWith(i)).sort((S,I)=>new Date(I.startTime).getTime()-new Date(S.startTime).getTime())[0];if(f&&!f.isManual&&f.status==="finished")return f.endTime=new Date().toISOString(),f.updatedAt=new Date().toISOString(),await tt.workouts.put(f),await this.reloadCache(),this.sync().catch(()=>{}),f.id;const p=`implicit_${i}_${Date.now()}`,m={id:p,startTime:new Date().toISOString(),endTime:new Date().toISOString(),status:"finished",isManual:!1,pauseIntervals:[],updatedAt:new Date().toISOString()};return await tt.workouts.put(m),await this.reloadCache(),this.sync().catch(()=>{}),p}async updateImplicitWorkoutBounds(n){const i=await tt.workouts.get(n);if(!i||i.isManual)return;const c=(await tt.logs.where("workoutId").equals(n).toArray()).filter(p=>!p.isDeleted);if(c.length===0)return;const f=c.sort((p,m)=>new Date(p.date).getTime()-new Date(m.date).getTime());i.startTime=f[0].date,i.endTime=f[f.length-1].date,i.status="finished",i.updatedAt=new Date().toISOString(),await tt.workouts.put(i)}async addLog(n){const i=await this.ensureActiveWorkout(),a={...n,id:Date.now().toString(),date:new Date().toISOString(),workoutId:i,updatedAt:new Date().toISOString()};return await tt.logs.put(a),await this.updateImplicitWorkoutBounds(i),await this.reloadCache(),this.sync().catch(()=>{}),a}async deleteLog(n){const i=await tt.logs.get(n);if(i){const a=i.workoutId;i.isDeleted=!0,i.updatedAt=new Date().toISOString(),await tt.logs.put(i),a&&await this.updateImplicitWorkoutBounds(a),await this.reloadCache(),this.sync().catch(()=>{})}}async updateLog(n){const i={...n,updatedAt:new Date().toISOString()};await tt.logs.put(i),await this.reloadCache(),this.sync().catch(()=>{})}getProfileIdentifier(){var a,c;const n=this.cache.profile;if(n!=null&&n.telegramUsername)return n.telegramUsername;if(n!=null&&n.telegramUserId)return`id_${n.telegramUserId}`;const i=(c=(a=nn==null?void 0:nn.initDataUnsafe)==null?void 0:a.user)==null?void 0:c.id;return i?`id_${i}`:""}async updateProfileSettings(n){var p;const i=(p=nn==null?void 0:nn.initDataUnsafe)==null?void 0:p.user,a=i==null?void 0:i.id;let c=this.cache.profile;c?i!=null&&i.photo_url&&(c.photoUrl=i.photo_url):c={id:"me",isPublic:!1,showFullHistory:!1,telegramUserId:a||0,telegramUsername:i==null?void 0:i.username,photoUrl:i==null?void 0:i.photo_url,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};const f={...c,...n,updatedAt:new Date().toISOString()};await tt.profile.put(f),await this.reloadCache(),this.sync().catch(()=>{})}async updateWorkoutTypeOrder(n){const i=n.map((a,c)=>{const f=this.cache.workoutTypes.find(p=>p.id===a);return f?{...f,order:c,updatedAt:new Date().toISOString()}:null}).filter(Boolean);i.length>0&&(await tt.workoutTypes.bulkPut(i),await this.reloadCache(),this.sync().catch(()=>{}))}async getPublicProfile(n){try{const a=await fetch(`https://functions.yandexcloud.net/d4ehnqvq3a8fo55t7tj4?profile=${encodeURIComponent(n)}`);return a.ok?await a.json():null}catch{return null}}}const J=new Za;J.reloadCache().then(()=>{});function ts(s=0,n=0){return n===1?s:Math.round(s*(1+n/30))}function es(s,n){const i=new Map;return s.filter(c=>c.workoutTypeId===n).forEach(c=>{const f=c.date.split("T")[0],p=ts(c.weight||0,c.reps||0),m=i.get(f)||0;p>m&&i.set(f,p)}),i}function ns(s,n){const i=new Set;return s.forEach(a=>i.add(a.startTime.split("T")[0])),n.forEach(a=>i.add(a.date.split("T")[0])),i}function rs(s){const n=s.filter(f=>f.endTime&&f.status==="finished");if(n.length===0)return{averageMinutes:0,totalMinutes:0,count:0};let i=0;n.forEach(f=>{const p=new Date(f.startTime).getTime(),m=new Date(f.endTime).getTime();let S=m-p;f.pauseIntervals&&f.pauseIntervals.forEach(I=>{const C=new Date(I.start).getTime(),A=I.end?new Date(I.end).getTime():m;S-=A-C}),i+=S});const a=Math.round(i/1e3/60);return{averageMinutes:Math.round(a/n.length),totalMinutes:a,count:n.length}}function is(s,n=6){const i=new Date,a=new Date(i);a.setMonth(i.getMonth()-n),a.setDate(a.getDate()-a.getDay());let c='<div class="heatmap-container"><div class="heatmap-grid">';const f=new Date(a),p=new Date(i);for(;f<=p;){const m=f.toISOString().split("T")[0],S=s.has(m),C=`heatmap-cell level-${S?4:0}`,A=`${m}: ${S?"Workout":"No workout"}`;c+=`<div class="${C}" title="${A}"></div>`,f.setDate(f.getDate()+1)}return c+="</div>",c+=`
        <div class="heatmap-legend">
            Less <div class="heatmap-cell level-0"></div>
            <div class="heatmap-cell level-4"></div> More
        </div>
    `,c+="</div>",c}function Io(s){const n=new Map;s.forEach(c=>{const f=c.date.split("T")[0],p=(c.weight||0)*(c.reps||0);n.set(f,(n.get(f)||0)+p)});const i=Array.from(n.keys()).sort().slice(-10);if(i.length<2)return'<p class="hint">ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð´Ð°Ð½Ð½ÑÑ Ð´Ð»Ñ Ð³ÑÐ°ÑÐ¸ÐºÐ° Ð¾Ð±ÑÐµÐ¼Ð°</p>';const a=i.map(c=>({label:new Date(c).toLocaleDateString(void 0,{day:"numeric",month:"short"}),value:n.get(c)}));return ss(a,"ÐºÐ³")}function os(s){const n=Array.from(s.keys()).sort();if(n.length<2)return'<p class="hint">ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð´Ð°Ð½Ð½ÑÑ Ð´Ð»Ñ Ð³ÑÐ°ÑÐ¸ÐºÐ° 1RM</p>';const i=n.map(a=>({label:new Date(a).toLocaleDateString(void 0,{day:"numeric",month:"short"}),value:s.get(a)}));return zo(i,"ÐºÐ³")}function as(s){const n=s.filter(a=>a.status==="finished"&&a.endTime).sort((a,c)=>new Date(a.startTime).getTime()-new Date(c.startTime).getTime()).slice(-10);if(n.length<2)return'<p class="hint">ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð´Ð°Ð½Ð½ÑÑ Ð´Ð»Ñ Ð³ÑÐ°ÑÐ¸ÐºÐ° Ð¿ÑÐ¾Ð´Ð¾Ð»Ð¶Ð¸ÑÐµÐ»ÑÐ½Ð¾ÑÑÐ¸</p>';const i=n.map(a=>{const c=new Date(a.startTime).getTime(),f=new Date(a.endTime).getTime();let p=(f-c)/1e3/60;return a.pauseIntervals&&a.pauseIntervals.forEach(m=>{const S=new Date(m.start).getTime(),I=m.end?new Date(m.end).getTime():f;p-=(I-S)/1e3/60}),{label:new Date(a.startTime).toLocaleDateString(void 0,{day:"numeric",month:"short"}),value:Math.round(p)}});return zo(i,"Ð¼Ð¸Ð½")}function ss(s,n){const c=Math.max(...s.map(p=>p.value))*1.1;return`
        <svg width="100%" height="150" preserveAspectRatio="none">
            ${s.map((p,m)=>{const S=p.value/c*100,I=m/s.length*100,C=1/s.length*80;return`
            <rect x="${I+5}%" y="${100-S}%" width="${C}%" height="${S}%" fill="var(--color-button)" rx="2" opacity="0.8">
               <title>${p.label}: ${p.value}${n}</title>
            </rect>
            <text x="${I+5+C/2}%" y="95%" font-size="10" text-anchor="middle" fill="var(--color-text)" style="pointer-events: none;">
                ${p.label}
            </text>
        `}).join("")}
        </svg>
    `}function zo(s,n){const f=s.map(W=>W.value),p=Math.min(...f),m=Math.max(...f),S=m-p||1,I=W=>20+W/(s.length-1)*(400-2*20),C=W=>130-(W-p)/S*(150-2*20),A=s.map((W,Y)=>`${I(Y)},${C(W.value)}`).join(" "),U=s.map((W,Y)=>`
        <circle cx="${I(Y)}" cy="${C(W.value)}" r="4" fill="var(--color-bg)" stroke="var(--color-button)" stroke-width="2">
            <title>${W.label}: ${W.value}${n}</title>
        </circle>
    `).join("");return`
        <svg viewBox="0 0 400 150" class="chart">
             <polyline
                fill="none"
                stroke="var(--color-button)"
                stroke-width="3"
                stroke-linejoin="round"
                stroke-linecap="round"
                points="${A}"
            />
            ${U}
        </svg>
        <div style="display: flex; justify-content: space-between; margin-top: 4px; font-size: 12px; color: var(--color-hint);">
            <span>${Math.round(p)}${n}</span>
            <span>${Math.round(m)}${n}</span>
        </div>
    `}function us(s,n){s.innerHTML=`
        <div class="page-content" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 80vh; text-align: center;">
            <div style="font-size: 48px; margin-bottom: 24px;">ðï¸</div>
            <h1 class="title" style="margin-bottom: 12px;">ÐÐ¸Ð¼-Ð¶Ð¸Ð¼ 21</h1>
            <p class="subtitle" style="margin-bottom: 32px; opacity: 0.7;">ÐÐ¾Ð¹Ð´Ð¸ÑÐµ ÑÐµÑÐµÐ· Telegram, ÑÑÐ¾Ð±Ñ ÑÐ¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð¸ÑÐ¾Ð²Ð°ÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸</p>
            <div id="telegram-login-container"></div>
        </div>
    `,window.onTelegramAuth=c=>{console.log("Telegram auth callback received:",c),Pi(c),localStorage.removeItem("skip_tma_auth"),n()};const i=document.createElement("script");i.src="https://telegram.org/js/telegram-widget.js?22",i.async=!0,i.setAttribute("data-telegram-login","gymgym21bot"),i.setAttribute("data-size","large"),i.setAttribute("data-radius","12"),i.setAttribute("data-onauth","onTelegramAuth(user)"),i.setAttribute("data-request-access","write");const a=document.getElementById("telegram-login-container");a&&a.appendChild(i)}function ls(s={}){const{immediate:n=!1,onNeedRefresh:i,onOfflineReady:a,onRegistered:c,onRegisteredSW:f,onRegisterError:p}=s;let m,S;const I=async(A=!0)=>{await S};async function C(){if("serviceWorker"in navigator){if(m=await Fo(async()=>{const{Workbox:A}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:A}},[],import.meta.url).then(({Workbox:A})=>new A("./sw.js",{scope:"./",type:"classic"})).catch(A=>{p==null||p(A)}),!m)return;m.addEventListener("activated",A=>{(A.isUpdate||A.isExternal)&&window.location.reload()}),m.addEventListener("installed",A=>{A.isUpdate||a==null||a()}),m.register({immediate:n}).then(A=>{f?f("./sw.js",A):c==null||c(A)}).catch(A=>{p==null||p(A)})}}return S=C(),I}/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Oo(s,n){var i=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);n&&(a=a.filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable})),i.push.apply(i,a)}return i}function ue(s){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Oo(Object(i),!0).forEach(function(a){cs(s,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(i)):Oo(Object(i)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(i,a))})}return s}function pr(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pr=function(n){return typeof n}:pr=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},pr(s)}function cs(s,n,i){return n in s?Object.defineProperty(s,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[n]=i,s}function me(){return me=Object.assign||function(s){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(s[a]=i[a])}return s},me.apply(this,arguments)}function ds(s,n){if(s==null)return{};var i={},a=Object.keys(s),c,f;for(f=0;f<a.length;f++)c=a[f],!(n.indexOf(c)>=0)&&(i[c]=s[c]);return i}function fs(s,n){if(s==null)return{};var i=ds(s,n),a,c;if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(s);for(c=0;c<f.length;c++)a=f[c],!(n.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(s,a)&&(i[a]=s[a])}return i}var hs="1.15.6";function pe(s){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(s)}var ge=pe(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Mn=pe(/Edge/i),Ao=pe(/firefox/i),On=pe(/safari/i)&&!pe(/chrome/i)&&!pe(/android/i),Ci=pe(/iP(ad|od|hone)/i),Ho=pe(/chrome/i)&&pe(/android/i),Xo={capture:!1,passive:!1};function at(s,n,i){s.addEventListener(n,i,!ge&&Xo)}function it(s,n,i){s.removeEventListener(n,i,!ge&&Xo)}function kr(s,n){if(n){if(n[0]===">"&&(n=n.substring(1)),s)try{if(s.matches)return s.matches(n);if(s.msMatchesSelector)return s.msMatchesSelector(n);if(s.webkitMatchesSelector)return s.webkitMatchesSelector(n)}catch{return!1}return!1}}function Vo(s){return s.host&&s!==document&&s.host.nodeType?s.host:s.parentNode}function ne(s,n,i,a){if(s){i=i||document;do{if(n!=null&&(n[0]===">"?s.parentNode===i&&kr(s,n):kr(s,n))||a&&s===i)return s;if(s===i)break}while(s=Vo(s))}return null}var Po=/\s+/g;function zt(s,n,i){if(s&&n)if(s.classList)s.classList[i?"add":"remove"](n);else{var a=(" "+s.className+" ").replace(Po," ").replace(" "+n+" "," ");s.className=(a+(i?" "+n:"")).replace(Po," ")}}function G(s,n,i){var a=s&&s.style;if(a){if(i===void 0)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(s,""):s.currentStyle&&(i=s.currentStyle),n===void 0?i:i[n];!(n in a)&&n.indexOf("webkit")===-1&&(n="-webkit-"+n),a[n]=i+(typeof i=="string"?"":"px")}}function ln(s,n){var i="";if(typeof s=="string")i=s;else do{var a=G(s,"transform");a&&a!=="none"&&(i=a+" "+i)}while(!n&&(s=s.parentNode));var c=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return c&&new c(i)}function Go(s,n,i){if(s){var a=s.getElementsByTagName(n),c=0,f=a.length;if(i)for(;c<f;c++)i(a[c],c);return a}return[]}function se(){var s=document.scrollingElement;return s||document.documentElement}function At(s,n,i,a,c){if(!(!s.getBoundingClientRect&&s!==window)){var f,p,m,S,I,C,A;if(s!==window&&s.parentNode&&s!==se()?(f=s.getBoundingClientRect(),p=f.top,m=f.left,S=f.bottom,I=f.right,C=f.height,A=f.width):(p=0,m=0,S=window.innerHeight,I=window.innerWidth,C=window.innerHeight,A=window.innerWidth),(n||i)&&s!==window&&(c=c||s.parentNode,!ge))do if(c&&c.getBoundingClientRect&&(G(c,"transform")!=="none"||i&&G(c,"position")!=="static")){var U=c.getBoundingClientRect();p-=U.top+parseInt(G(c,"border-top-width")),m-=U.left+parseInt(G(c,"border-left-width")),S=p+f.height,I=m+f.width;break}while(c=c.parentNode);if(a&&s!==window){var W=ln(c||s),Y=W&&W.a,q=W&&W.d;W&&(p/=q,m/=Y,A/=Y,C/=q,S=p+C,I=m+A)}return{top:p,left:m,bottom:S,right:I,width:A,height:C}}}function Co(s,n,i){for(var a=Ie(s,!0),c=At(s)[n];a;){var f=At(a)[i],p=void 0;if(p=c>=f,!p)return a;if(a===se())break;a=Ie(a,!1)}return!1}function cn(s,n,i,a){for(var c=0,f=0,p=s.children;f<p.length;){if(p[f].style.display!=="none"&&p[f]!==Q.ghost&&(a||p[f]!==Q.dragged)&&ne(p[f],i.draggable,s,!1)){if(c===n)return p[f];c++}f++}return null}function $i(s,n){for(var i=s.lastElementChild;i&&(i===Q.ghost||G(i,"display")==="none"||n&&!kr(i,n));)i=i.previousElementSibling;return i||null}function Qt(s,n){var i=0;if(!s||!s.parentNode)return-1;for(;s=s.previousElementSibling;)s.nodeName.toUpperCase()!=="TEMPLATE"&&s!==Q.clone&&(!n||kr(s,n))&&i++;return i}function $o(s){var n=0,i=0,a=se();if(s)do{var c=ln(s),f=c.a,p=c.d;n+=s.scrollLeft*f,i+=s.scrollTop*p}while(s!==a&&(s=s.parentNode));return[n,i]}function ps(s,n){for(var i in s)if(s.hasOwnProperty(i)){for(var a in n)if(n.hasOwnProperty(a)&&n[a]===s[i][a])return Number(i)}return-1}function Ie(s,n){if(!s||!s.getBoundingClientRect)return se();var i=s,a=!1;do if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var c=G(i);if(i.clientWidth<i.scrollWidth&&(c.overflowX=="auto"||c.overflowX=="scroll")||i.clientHeight<i.scrollHeight&&(c.overflowY=="auto"||c.overflowY=="scroll")){if(!i.getBoundingClientRect||i===document.body)return se();if(a||n)return i;a=!0}}while(i=i.parentNode);return se()}function ms(s,n){if(s&&n)for(var i in n)n.hasOwnProperty(i)&&(s[i]=n[i]);return s}function hi(s,n){return Math.round(s.top)===Math.round(n.top)&&Math.round(s.left)===Math.round(n.left)&&Math.round(s.height)===Math.round(n.height)&&Math.round(s.width)===Math.round(n.width)}var An;function Qo(s,n){return function(){if(!An){var i=arguments,a=this;i.length===1?s.call(a,i[0]):s.apply(a,i),An=setTimeout(function(){An=void 0},n)}}}function gs(){clearTimeout(An),An=void 0}function Jo(s,n,i){s.scrollLeft+=n,s.scrollTop+=i}function Zo(s){var n=window.Polymer,i=window.jQuery||window.Zepto;return n&&n.dom?n.dom(s).cloneNode(!0):i?i(s).clone(!0)[0]:s.cloneNode(!0)}function ta(s,n,i){var a={};return Array.from(s.children).forEach(function(c){var f,p,m,S;if(!(!ne(c,n.draggable,s,!1)||c.animated||c===i)){var I=At(c);a.left=Math.min((f=a.left)!==null&&f!==void 0?f:1/0,I.left),a.top=Math.min((p=a.top)!==null&&p!==void 0?p:1/0,I.top),a.right=Math.max((m=a.right)!==null&&m!==void 0?m:-1/0,I.right),a.bottom=Math.max((S=a.bottom)!==null&&S!==void 0?S:-1/0,I.bottom)}}),a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}var qt="Sortable"+new Date().getTime();function vs(){var s=[],n;return{captureAnimationState:function(){if(s=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(c){if(!(G(c,"display")==="none"||c===Q.ghost)){s.push({target:c,rect:At(c)});var f=ue({},s[s.length-1].rect);if(c.thisAnimationDuration){var p=ln(c,!0);p&&(f.top-=p.f,f.left-=p.e)}c.fromRect=f}})}},addAnimationState:function(a){s.push(a)},removeAnimationState:function(a){s.splice(ps(s,{target:a}),1)},animateAll:function(a){var c=this;if(!this.options.animation){clearTimeout(n),typeof a=="function"&&a();return}var f=!1,p=0;s.forEach(function(m){var S=0,I=m.target,C=I.fromRect,A=At(I),U=I.prevFromRect,W=I.prevToRect,Y=m.rect,q=ln(I,!0);q&&(A.top-=q.f,A.left-=q.e),I.toRect=A,I.thisAnimationDuration&&hi(U,A)&&!hi(C,A)&&(Y.top-A.top)/(Y.left-A.left)===(C.top-A.top)/(C.left-A.left)&&(S=bs(Y,U,W,c.options)),hi(A,C)||(I.prevFromRect=C,I.prevToRect=A,S||(S=c.options.animation),c.animate(I,Y,A,S)),S&&(f=!0,p=Math.max(p,S),clearTimeout(I.animationResetTimer),I.animationResetTimer=setTimeout(function(){I.animationTime=0,I.prevFromRect=null,I.fromRect=null,I.prevToRect=null,I.thisAnimationDuration=null},S),I.thisAnimationDuration=S)}),clearTimeout(n),f?n=setTimeout(function(){typeof a=="function"&&a()},p):typeof a=="function"&&a(),s=[]},animate:function(a,c,f,p){if(p){G(a,"transition",""),G(a,"transform","");var m=ln(this.el),S=m&&m.a,I=m&&m.d,C=(c.left-f.left)/(S||1),A=(c.top-f.top)/(I||1);a.animatingX=!!C,a.animatingY=!!A,G(a,"transform","translate3d("+C+"px,"+A+"px,0)"),this.forRepaintDummy=ys(a),G(a,"transition","transform "+p+"ms"+(this.options.easing?" "+this.options.easing:"")),G(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){G(a,"transition",""),G(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},p)}}}}function ys(s){return s.offsetWidth}function bs(s,n,i,a){return Math.sqrt(Math.pow(n.top-s.top,2)+Math.pow(n.left-s.left,2))/Math.sqrt(Math.pow(n.top-i.top,2)+Math.pow(n.left-i.left,2))*a.animation}var rn=[],pi={initializeByDefault:!0},jn={mount:function(n){for(var i in pi)pi.hasOwnProperty(i)&&!(i in n)&&(n[i]=pi[i]);rn.forEach(function(a){if(a.pluginName===n.pluginName)throw"Sortable: Cannot mount plugin ".concat(n.pluginName," more than once")}),rn.push(n)},pluginEvent:function(n,i,a){var c=this;this.eventCanceled=!1,a.cancel=function(){c.eventCanceled=!0};var f=n+"Global";rn.forEach(function(p){i[p.pluginName]&&(i[p.pluginName][f]&&i[p.pluginName][f](ue({sortable:i},a)),i.options[p.pluginName]&&i[p.pluginName][n]&&i[p.pluginName][n](ue({sortable:i},a)))})},initializePlugins:function(n,i,a,c){rn.forEach(function(m){var S=m.pluginName;if(!(!n.options[S]&&!m.initializeByDefault)){var I=new m(n,i,n.options);I.sortable=n,I.options=n.options,n[S]=I,me(a,I.defaults)}});for(var f in n.options)if(n.options.hasOwnProperty(f)){var p=this.modifyOption(n,f,n.options[f]);typeof p<"u"&&(n.options[f]=p)}},getEventProperties:function(n,i){var a={};return rn.forEach(function(c){typeof c.eventProperties=="function"&&me(a,c.eventProperties.call(i[c.pluginName],n))}),a},modifyOption:function(n,i,a){var c;return rn.forEach(function(f){n[f.pluginName]&&f.optionListeners&&typeof f.optionListeners[i]=="function"&&(c=f.optionListeners[i].call(n[f.pluginName],a))}),c}};function ws(s){var n=s.sortable,i=s.rootEl,a=s.name,c=s.targetEl,f=s.cloneEl,p=s.toEl,m=s.fromEl,S=s.oldIndex,I=s.newIndex,C=s.oldDraggableIndex,A=s.newDraggableIndex,U=s.originalEvent,W=s.putSortable,Y=s.extraEventProperties;if(n=n||i&&i[qt],!!n){var q,V=n.options,ut="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!ge&&!Mn?q=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(q=document.createEvent("Event"),q.initEvent(a,!0,!0)),q.to=p||i,q.from=m||i,q.item=c||i,q.clone=f,q.oldIndex=S,q.newIndex=I,q.oldDraggableIndex=C,q.newDraggableIndex=A,q.originalEvent=U,q.pullMode=W?W.lastPutMode:void 0;var lt=ue(ue({},Y),jn.getEventProperties(a,n));for(var ht in lt)q[ht]=lt[ht];i&&i.dispatchEvent(q),V[ut]&&V[ut].call(n,q)}}var _s=["evt"],Bt=function(n,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=a.evt,f=fs(a,_s);jn.pluginEvent.bind(Q)(n,i,ue({dragEl:R,parentEl:Dt,ghostEl:Z,rootEl:wt,nextEl:qe,lastDownEl:mr,cloneEl:kt,cloneHidden:Te,dragStarted:Dn,putSortable:Mt,activeSortable:Q.active,originalEvent:c,oldIndex:sn,oldDraggableIndex:Pn,newIndex:Ht,newDraggableIndex:xe,hideGhostForTarget:ia,unhideGhostForTarget:oa,cloneNowHidden:function(){Te=!0},cloneNowShown:function(){Te=!1},dispatchSortableEvent:function(m){Kt({sortable:i,name:m,originalEvent:c})}},f))};function Kt(s){ws(ue({putSortable:Mt,cloneEl:kt,targetEl:R,rootEl:wt,oldIndex:sn,oldDraggableIndex:Pn,newIndex:Ht,newDraggableIndex:xe},s))}var R,Dt,Z,wt,qe,mr,kt,Te,sn,Ht,Pn,xe,lr,Mt,an=!1,Sr=!1,Er=[],Ne,ee,mi,gi,Mo,jo,Dn,on,Cn,$n=!1,cr=!1,gr,Lt,vi=[],Ei=!1,Dr=[],Or=typeof document<"u",dr=Ci,Lo=Mn||ge?"cssFloat":"float",ks=Or&&!Ho&&!Ci&&"draggable"in document.createElement("div"),ea=function(){if(Or){if(ge)return!1;var s=document.createElement("x");return s.style.cssText="pointer-events:auto",s.style.pointerEvents==="auto"}}(),na=function(n,i){var a=G(n),c=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),f=cn(n,0,i),p=cn(n,1,i),m=f&&G(f),S=p&&G(p),I=m&&parseInt(m.marginLeft)+parseInt(m.marginRight)+At(f).width,C=S&&parseInt(S.marginLeft)+parseInt(S.marginRight)+At(p).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(f&&m.float&&m.float!=="none"){var A=m.float==="left"?"left":"right";return p&&(S.clear==="both"||S.clear===A)?"vertical":"horizontal"}return f&&(m.display==="block"||m.display==="flex"||m.display==="table"||m.display==="grid"||I>=c&&a[Lo]==="none"||p&&a[Lo]==="none"&&I+C>c)?"vertical":"horizontal"},Ss=function(n,i,a){var c=a?n.left:n.top,f=a?n.right:n.bottom,p=a?n.width:n.height,m=a?i.left:i.top,S=a?i.right:i.bottom,I=a?i.width:i.height;return c===m||f===S||c+p/2===m+I/2},Es=function(n,i){var a;return Er.some(function(c){var f=c[qt].options.emptyInsertThreshold;if(!(!f||$i(c))){var p=At(c),m=n>=p.left-f&&n<=p.right+f,S=i>=p.top-f&&i<=p.bottom+f;if(m&&S)return a=c}}),a},ra=function(n){function i(f,p){return function(m,S,I,C){var A=m.options.group.name&&S.options.group.name&&m.options.group.name===S.options.group.name;if(f==null&&(p||A))return!0;if(f==null||f===!1)return!1;if(p&&f==="clone")return f;if(typeof f=="function")return i(f(m,S,I,C),p)(m,S,I,C);var U=(p?m:S).options.group.name;return f===!0||typeof f=="string"&&f===U||f.join&&f.indexOf(U)>-1}}var a={},c=n.group;(!c||pr(c)!="object")&&(c={name:c}),a.name=c.name,a.checkPull=i(c.pull,!0),a.checkPut=i(c.put),a.revertClone=c.revertClone,n.group=a},ia=function(){!ea&&Z&&G(Z,"display","none")},oa=function(){!ea&&Z&&G(Z,"display","")};Or&&!Ho&&document.addEventListener("click",function(s){if(Sr)return s.preventDefault(),s.stopPropagation&&s.stopPropagation(),s.stopImmediatePropagation&&s.stopImmediatePropagation(),Sr=!1,!1},!0);var Be=function(n){if(R){n=n.touches?n.touches[0]:n;var i=Es(n.clientX,n.clientY);if(i){var a={};for(var c in n)n.hasOwnProperty(c)&&(a[c]=n[c]);a.target=a.rootEl=i,a.preventDefault=void 0,a.stopPropagation=void 0,i[qt]._onDragOver(a)}}},Ds=function(n){R&&R.parentNode[qt]._isOutsideThisEl(n.target)};function Q(s,n){if(!(s&&s.nodeType&&s.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(s));this.el=s,this.options=n=me({},n),s[qt]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(s.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return na(s,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(p,m){p.setData("Text",m.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Q.supportPointer!==!1&&"PointerEvent"in window&&(!On||Ci),emptyInsertThreshold:5};jn.initializePlugins(this,s,i);for(var a in i)!(a in n)&&(n[a]=i[a]);ra(n);for(var c in this)c.charAt(0)==="_"&&typeof this[c]=="function"&&(this[c]=this[c].bind(this));this.nativeDraggable=n.forceFallback?!1:ks,this.nativeDraggable&&(this.options.touchStartThreshold=1),n.supportPointer?at(s,"pointerdown",this._onTapStart):(at(s,"mousedown",this._onTapStart),at(s,"touchstart",this._onTapStart)),this.nativeDraggable&&(at(s,"dragover",this),at(s,"dragenter",this)),Er.push(this.el),n.store&&n.store.get&&this.sort(n.store.get(this)||[]),me(this,vs())}Q.prototype={constructor:Q,_isOutsideThisEl:function(n){!this.el.contains(n)&&n!==this.el&&(on=null)},_getDirection:function(n,i){return typeof this.options.direction=="function"?this.options.direction.call(this,n,i,R):this.options.direction},_onTapStart:function(n){if(n.cancelable){var i=this,a=this.el,c=this.options,f=c.preventOnFilter,p=n.type,m=n.touches&&n.touches[0]||n.pointerType&&n.pointerType==="touch"&&n,S=(m||n).target,I=n.target.shadowRoot&&(n.path&&n.path[0]||n.composedPath&&n.composedPath()[0])||S,C=c.filter;if($s(a),!R&&!(/mousedown|pointerdown/.test(p)&&n.button!==0||c.disabled)&&!I.isContentEditable&&!(!this.nativeDraggable&&On&&S&&S.tagName.toUpperCase()==="SELECT")&&(S=ne(S,c.draggable,a,!1),!(S&&S.animated)&&mr!==S)){if(sn=Qt(S),Pn=Qt(S,c.draggable),typeof C=="function"){if(C.call(this,n,S,this)){Kt({sortable:i,rootEl:I,name:"filter",targetEl:S,toEl:a,fromEl:a}),Bt("filter",i,{evt:n}),f&&n.preventDefault();return}}else if(C&&(C=C.split(",").some(function(A){if(A=ne(I,A.trim(),a,!1),A)return Kt({sortable:i,rootEl:A,name:"filter",targetEl:S,fromEl:a,toEl:a}),Bt("filter",i,{evt:n}),!0}),C)){f&&n.preventDefault();return}c.handle&&!ne(I,c.handle,a,!1)||this._prepareDragStart(n,m,S)}}},_prepareDragStart:function(n,i,a){var c=this,f=c.el,p=c.options,m=f.ownerDocument,S;if(a&&!R&&a.parentNode===f){var I=At(a);if(wt=f,R=a,Dt=R.parentNode,qe=R.nextSibling,mr=a,lr=p.group,Q.dragged=R,Ne={target:R,clientX:(i||n).clientX,clientY:(i||n).clientY},Mo=Ne.clientX-I.left,jo=Ne.clientY-I.top,this._lastX=(i||n).clientX,this._lastY=(i||n).clientY,R.style["will-change"]="all",S=function(){if(Bt("delayEnded",c,{evt:n}),Q.eventCanceled){c._onDrop();return}c._disableDelayedDragEvents(),!Ao&&c.nativeDraggable&&(R.draggable=!0),c._triggerDragStart(n,i),Kt({sortable:c,name:"choose",originalEvent:n}),zt(R,p.chosenClass,!0)},p.ignore.split(",").forEach(function(C){Go(R,C.trim(),yi)}),at(m,"dragover",Be),at(m,"mousemove",Be),at(m,"touchmove",Be),p.supportPointer?(at(m,"pointerup",c._onDrop),!this.nativeDraggable&&at(m,"pointercancel",c._onDrop)):(at(m,"mouseup",c._onDrop),at(m,"touchend",c._onDrop),at(m,"touchcancel",c._onDrop)),Ao&&this.nativeDraggable&&(this.options.touchStartThreshold=4,R.draggable=!0),Bt("delayStart",this,{evt:n}),p.delay&&(!p.delayOnTouchOnly||i)&&(!this.nativeDraggable||!(Mn||ge))){if(Q.eventCanceled){this._onDrop();return}p.supportPointer?(at(m,"pointerup",c._disableDelayedDrag),at(m,"pointercancel",c._disableDelayedDrag)):(at(m,"mouseup",c._disableDelayedDrag),at(m,"touchend",c._disableDelayedDrag),at(m,"touchcancel",c._disableDelayedDrag)),at(m,"mousemove",c._delayedDragTouchMoveHandler),at(m,"touchmove",c._delayedDragTouchMoveHandler),p.supportPointer&&at(m,"pointermove",c._delayedDragTouchMoveHandler),c._dragStartTimer=setTimeout(S,p.delay)}else S()}},_delayedDragTouchMoveHandler:function(n){var i=n.touches?n.touches[0]:n;Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){R&&yi(R),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var n=this.el.ownerDocument;it(n,"mouseup",this._disableDelayedDrag),it(n,"touchend",this._disableDelayedDrag),it(n,"touchcancel",this._disableDelayedDrag),it(n,"pointerup",this._disableDelayedDrag),it(n,"pointercancel",this._disableDelayedDrag),it(n,"mousemove",this._delayedDragTouchMoveHandler),it(n,"touchmove",this._delayedDragTouchMoveHandler),it(n,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(n,i){i=i||n.pointerType=="touch"&&n,!this.nativeDraggable||i?this.options.supportPointer?at(document,"pointermove",this._onTouchMove):i?at(document,"touchmove",this._onTouchMove):at(document,"mousemove",this._onTouchMove):(at(R,"dragend",this),at(wt,"dragstart",this._onDragStart));try{document.selection?vr(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(n,i){if(an=!1,wt&&R){Bt("dragStarted",this,{evt:i}),this.nativeDraggable&&at(document,"dragover",Ds);var a=this.options;!n&&zt(R,a.dragClass,!1),zt(R,a.ghostClass,!0),Q.active=this,n&&this._appendGhost(),Kt({sortable:this,name:"start",originalEvent:i})}else this._nulling()},_emulateDragOver:function(){if(ee){this._lastX=ee.clientX,this._lastY=ee.clientY,ia();for(var n=document.elementFromPoint(ee.clientX,ee.clientY),i=n;n&&n.shadowRoot&&(n=n.shadowRoot.elementFromPoint(ee.clientX,ee.clientY),n!==i);)i=n;if(R.parentNode[qt]._isOutsideThisEl(n),i)do{if(i[qt]){var a=void 0;if(a=i[qt]._onDragOver({clientX:ee.clientX,clientY:ee.clientY,target:n,rootEl:i}),a&&!this.options.dragoverBubble)break}n=i}while(i=Vo(i));oa()}},_onTouchMove:function(n){if(Ne){var i=this.options,a=i.fallbackTolerance,c=i.fallbackOffset,f=n.touches?n.touches[0]:n,p=Z&&ln(Z,!0),m=Z&&p&&p.a,S=Z&&p&&p.d,I=dr&&Lt&&$o(Lt),C=(f.clientX-Ne.clientX+c.x)/(m||1)+(I?I[0]-vi[0]:0)/(m||1),A=(f.clientY-Ne.clientY+c.y)/(S||1)+(I?I[1]-vi[1]:0)/(S||1);if(!Q.active&&!an){if(a&&Math.max(Math.abs(f.clientX-this._lastX),Math.abs(f.clientY-this._lastY))<a)return;this._onDragStart(n,!0)}if(Z){p?(p.e+=C-(mi||0),p.f+=A-(gi||0)):p={a:1,b:0,c:0,d:1,e:C,f:A};var U="matrix(".concat(p.a,",").concat(p.b,",").concat(p.c,",").concat(p.d,",").concat(p.e,",").concat(p.f,")");G(Z,"webkitTransform",U),G(Z,"mozTransform",U),G(Z,"msTransform",U),G(Z,"transform",U),mi=C,gi=A,ee=f}n.cancelable&&n.preventDefault()}},_appendGhost:function(){if(!Z){var n=this.options.fallbackOnBody?document.body:wt,i=At(R,!0,dr,!0,n),a=this.options;if(dr){for(Lt=n;G(Lt,"position")==="static"&&G(Lt,"transform")==="none"&&Lt!==document;)Lt=Lt.parentNode;Lt!==document.body&&Lt!==document.documentElement?(Lt===document&&(Lt=se()),i.top+=Lt.scrollTop,i.left+=Lt.scrollLeft):Lt=se(),vi=$o(Lt)}Z=R.cloneNode(!0),zt(Z,a.ghostClass,!1),zt(Z,a.fallbackClass,!0),zt(Z,a.dragClass,!0),G(Z,"transition",""),G(Z,"transform",""),G(Z,"box-sizing","border-box"),G(Z,"margin",0),G(Z,"top",i.top),G(Z,"left",i.left),G(Z,"width",i.width),G(Z,"height",i.height),G(Z,"opacity","0.8"),G(Z,"position",dr?"absolute":"fixed"),G(Z,"zIndex","100000"),G(Z,"pointerEvents","none"),Q.ghost=Z,n.appendChild(Z),G(Z,"transform-origin",Mo/parseInt(Z.style.width)*100+"% "+jo/parseInt(Z.style.height)*100+"%")}},_onDragStart:function(n,i){var a=this,c=n.dataTransfer,f=a.options;if(Bt("dragStart",this,{evt:n}),Q.eventCanceled){this._onDrop();return}Bt("setupClone",this),Q.eventCanceled||(kt=Zo(R),kt.removeAttribute("id"),kt.draggable=!1,kt.style["will-change"]="",this._hideClone(),zt(kt,this.options.chosenClass,!1),Q.clone=kt),a.cloneId=vr(function(){Bt("clone",a),!Q.eventCanceled&&(a.options.removeCloneOnHide||wt.insertBefore(kt,R),a._hideClone(),Kt({sortable:a,name:"clone"}))}),!i&&zt(R,f.dragClass,!0),i?(Sr=!0,a._loopId=setInterval(a._emulateDragOver,50)):(it(document,"mouseup",a._onDrop),it(document,"touchend",a._onDrop),it(document,"touchcancel",a._onDrop),c&&(c.effectAllowed="move",f.setData&&f.setData.call(a,c,R)),at(document,"drop",a),G(R,"transform","translateZ(0)")),an=!0,a._dragStartId=vr(a._dragStarted.bind(a,i,n)),at(document,"selectstart",a),Dn=!0,window.getSelection().removeAllRanges(),On&&G(document.body,"user-select","none")},_onDragOver:function(n){var i=this.el,a=n.target,c,f,p,m=this.options,S=m.group,I=Q.active,C=lr===S,A=m.sort,U=Mt||I,W,Y=this,q=!1;if(Ei)return;function V(Wt,ye){Bt(Wt,Y,ue({evt:n,isOwner:C,axis:W?"vertical":"horizontal",revert:p,dragRect:c,targetRect:f,canSort:A,fromSortable:U,target:a,completed:lt,onMove:function(Ue,te){return fr(wt,i,R,c,Ue,At(Ue),n,te)},changed:ht},ye))}function ut(){V("dragOverAnimationCapture"),Y.captureAnimationState(),Y!==U&&U.captureAnimationState()}function lt(Wt){return V("dragOverCompleted",{insertion:Wt}),Wt&&(C?I._hideClone():I._showClone(Y),Y!==U&&(zt(R,Mt?Mt.options.ghostClass:I.options.ghostClass,!1),zt(R,m.ghostClass,!0)),Mt!==Y&&Y!==Q.active?Mt=Y:Y===Q.active&&Mt&&(Mt=null),U===Y&&(Y._ignoreWhileAnimating=a),Y.animateAll(function(){V("dragOverAnimationComplete"),Y._ignoreWhileAnimating=null}),Y!==U&&(U.animateAll(),U._ignoreWhileAnimating=null)),(a===R&&!R.animated||a===i&&!a.animated)&&(on=null),!m.dragoverBubble&&!n.rootEl&&a!==document&&(R.parentNode[qt]._isOutsideThisEl(n.target),!Wt&&Be(n)),!m.dragoverBubble&&n.stopPropagation&&n.stopPropagation(),q=!0}function ht(){Ht=Qt(R),xe=Qt(R,m.draggable),Kt({sortable:Y,name:"change",toEl:i,newIndex:Ht,newDraggableIndex:xe,originalEvent:n})}if(n.preventDefault!==void 0&&n.cancelable&&n.preventDefault(),a=ne(a,m.draggable,i,!0),V("dragOver"),Q.eventCanceled)return q;if(R.contains(n.target)||a.animated&&a.animatingX&&a.animatingY||Y._ignoreWhileAnimating===a)return lt(!1);if(Sr=!1,I&&!m.disabled&&(C?A||(p=Dt!==wt):Mt===this||(this.lastPutMode=lr.checkPull(this,I,R,n))&&S.checkPut(this,I,R,n))){if(W=this._getDirection(n,a)==="vertical",c=At(R),V("dragOverValid"),Q.eventCanceled)return q;if(p)return Dt=wt,ut(),this._hideClone(),V("revert"),Q.eventCanceled||(qe?wt.insertBefore(R,qe):wt.appendChild(R)),lt(!0);var rt=$i(i,m.draggable);if(!rt||Os(n,W,this)&&!rt.animated){if(rt===R)return lt(!1);if(rt&&i===n.target&&(a=rt),a&&(f=At(a)),fr(wt,i,R,c,a,f,n,!!a)!==!1)return ut(),rt&&rt.nextSibling?i.insertBefore(R,rt.nextSibling):i.appendChild(R),Dt=i,ht(),lt(!0)}else if(rt&&Is(n,W,this)){var et=cn(i,0,m,!0);if(et===R)return lt(!1);if(a=et,f=At(a),fr(wt,i,R,c,a,f,n,!1)!==!1)return ut(),i.insertBefore(R,et),Dt=i,ht(),lt(!0)}else if(a.parentNode===i){f=At(a);var pt=0,ft,mt=R.parentNode!==i,Rt=!Ss(R.animated&&R.toRect||c,a.animated&&a.toRect||f,W),ve=W?"top":"left",Jt=Co(a,"top","top")||Co(R,"top","top"),Zt=Jt?Jt.scrollTop:void 0;on!==a&&(ft=f[ve],$n=!1,cr=!Rt&&m.invertSwap||mt),pt=As(n,a,f,W,Rt?1:m.swapThreshold,m.invertedSwapThreshold==null?m.swapThreshold:m.invertedSwapThreshold,cr,on===a);var $t;if(pt!==0){var le=Qt(R);do le-=pt,$t=Dt.children[le];while($t&&(G($t,"display")==="none"||$t===Z))}if(pt===0||$t===a)return lt(!1);on=a,Cn=pt;var ce=a.nextElementSibling,Vt=!1;Vt=pt===1;var We=fr(wt,i,R,c,a,f,n,Vt);if(We!==!1)return(We===1||We===-1)&&(Vt=We===1),Ei=!0,setTimeout(Ts,30),ut(),Vt&&!ce?i.appendChild(R):a.parentNode.insertBefore(R,Vt?ce:a),Jt&&Jo(Jt,0,Zt-Jt.scrollTop),Dt=R.parentNode,ft!==void 0&&!cr&&(gr=Math.abs(ft-At(a)[ve])),ht(),lt(!0)}if(i.contains(R))return lt(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){it(document,"mousemove",this._onTouchMove),it(document,"touchmove",this._onTouchMove),it(document,"pointermove",this._onTouchMove),it(document,"dragover",Be),it(document,"mousemove",Be),it(document,"touchmove",Be)},_offUpEvents:function(){var n=this.el.ownerDocument;it(n,"mouseup",this._onDrop),it(n,"touchend",this._onDrop),it(n,"pointerup",this._onDrop),it(n,"pointercancel",this._onDrop),it(n,"touchcancel",this._onDrop),it(document,"selectstart",this)},_onDrop:function(n){var i=this.el,a=this.options;if(Ht=Qt(R),xe=Qt(R,a.draggable),Bt("drop",this,{evt:n}),Dt=R&&R.parentNode,Ht=Qt(R),xe=Qt(R,a.draggable),Q.eventCanceled){this._nulling();return}an=!1,cr=!1,$n=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Di(this.cloneId),Di(this._dragStartId),this.nativeDraggable&&(it(document,"drop",this),it(i,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),On&&G(document.body,"user-select",""),G(R,"transform",""),n&&(Dn&&(n.cancelable&&n.preventDefault(),!a.dropBubble&&n.stopPropagation()),Z&&Z.parentNode&&Z.parentNode.removeChild(Z),(wt===Dt||Mt&&Mt.lastPutMode!=="clone")&&kt&&kt.parentNode&&kt.parentNode.removeChild(kt),R&&(this.nativeDraggable&&it(R,"dragend",this),yi(R),R.style["will-change"]="",Dn&&!an&&zt(R,Mt?Mt.options.ghostClass:this.options.ghostClass,!1),zt(R,this.options.chosenClass,!1),Kt({sortable:this,name:"unchoose",toEl:Dt,newIndex:null,newDraggableIndex:null,originalEvent:n}),wt!==Dt?(Ht>=0&&(Kt({rootEl:Dt,name:"add",toEl:Dt,fromEl:wt,originalEvent:n}),Kt({sortable:this,name:"remove",toEl:Dt,originalEvent:n}),Kt({rootEl:Dt,name:"sort",toEl:Dt,fromEl:wt,originalEvent:n}),Kt({sortable:this,name:"sort",toEl:Dt,originalEvent:n})),Mt&&Mt.save()):Ht!==sn&&Ht>=0&&(Kt({sortable:this,name:"update",toEl:Dt,originalEvent:n}),Kt({sortable:this,name:"sort",toEl:Dt,originalEvent:n})),Q.active&&((Ht==null||Ht===-1)&&(Ht=sn,xe=Pn),Kt({sortable:this,name:"end",toEl:Dt,originalEvent:n}),this.save()))),this._nulling()},_nulling:function(){Bt("nulling",this),wt=R=Dt=Z=qe=kt=mr=Te=Ne=ee=Dn=Ht=xe=sn=Pn=on=Cn=Mt=lr=Q.dragged=Q.ghost=Q.clone=Q.active=null,Dr.forEach(function(n){n.checked=!0}),Dr.length=mi=gi=0},handleEvent:function(n){switch(n.type){case"drop":case"dragend":this._onDrop(n);break;case"dragenter":case"dragover":R&&(this._onDragOver(n),xs(n));break;case"selectstart":n.preventDefault();break}},toArray:function(){for(var n=[],i,a=this.el.children,c=0,f=a.length,p=this.options;c<f;c++)i=a[c],ne(i,p.draggable,this.el,!1)&&n.push(i.getAttribute(p.dataIdAttr)||Cs(i));return n},sort:function(n,i){var a={},c=this.el;this.toArray().forEach(function(f,p){var m=c.children[p];ne(m,this.options.draggable,c,!1)&&(a[f]=m)},this),i&&this.captureAnimationState(),n.forEach(function(f){a[f]&&(c.removeChild(a[f]),c.appendChild(a[f]))}),i&&this.animateAll()},save:function(){var n=this.options.store;n&&n.set&&n.set(this)},closest:function(n,i){return ne(n,i||this.options.draggable,this.el,!1)},option:function(n,i){var a=this.options;if(i===void 0)return a[n];var c=jn.modifyOption(this,n,i);typeof c<"u"?a[n]=c:a[n]=i,n==="group"&&ra(a)},destroy:function(){Bt("destroy",this);var n=this.el;n[qt]=null,it(n,"mousedown",this._onTapStart),it(n,"touchstart",this._onTapStart),it(n,"pointerdown",this._onTapStart),this.nativeDraggable&&(it(n,"dragover",this),it(n,"dragenter",this)),Array.prototype.forEach.call(n.querySelectorAll("[draggable]"),function(i){i.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Er.splice(Er.indexOf(this.el),1),this.el=n=null},_hideClone:function(){if(!Te){if(Bt("hideClone",this),Q.eventCanceled)return;G(kt,"display","none"),this.options.removeCloneOnHide&&kt.parentNode&&kt.parentNode.removeChild(kt),Te=!0}},_showClone:function(n){if(n.lastPutMode!=="clone"){this._hideClone();return}if(Te){if(Bt("showClone",this),Q.eventCanceled)return;R.parentNode==wt&&!this.options.group.revertClone?wt.insertBefore(kt,R):qe?wt.insertBefore(kt,qe):wt.appendChild(kt),this.options.group.revertClone&&this.animate(R,kt),G(kt,"display",""),Te=!1}}};function xs(s){s.dataTransfer&&(s.dataTransfer.dropEffect="move"),s.cancelable&&s.preventDefault()}function fr(s,n,i,a,c,f,p,m){var S,I=s[qt],C=I.options.onMove,A;return window.CustomEvent&&!ge&&!Mn?S=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(S=document.createEvent("Event"),S.initEvent("move",!0,!0)),S.to=n,S.from=s,S.dragged=i,S.draggedRect=a,S.related=c||n,S.relatedRect=f||At(n),S.willInsertAfter=m,S.originalEvent=p,s.dispatchEvent(S),C&&(A=C.call(I,S,p)),A}function yi(s){s.draggable=!1}function Ts(){Ei=!1}function Is(s,n,i){var a=At(cn(i.el,0,i.options,!0)),c=ta(i.el,i.options,Z),f=10;return n?s.clientX<c.left-f||s.clientY<a.top&&s.clientX<a.right:s.clientY<c.top-f||s.clientY<a.bottom&&s.clientX<a.left}function Os(s,n,i){var a=At($i(i.el,i.options.draggable)),c=ta(i.el,i.options,Z),f=10;return n?s.clientX>c.right+f||s.clientY>a.bottom&&s.clientX>a.left:s.clientY>c.bottom+f||s.clientX>a.right&&s.clientY>a.top}function As(s,n,i,a,c,f,p,m){var S=a?s.clientY:s.clientX,I=a?i.height:i.width,C=a?i.top:i.left,A=a?i.bottom:i.right,U=!1;if(!p){if(m&&gr<I*c){if(!$n&&(Cn===1?S>C+I*f/2:S<A-I*f/2)&&($n=!0),$n)U=!0;else if(Cn===1?S<C+gr:S>A-gr)return-Cn}else if(S>C+I*(1-c)/2&&S<A-I*(1-c)/2)return Ps(n)}return U=U||p,U&&(S<C+I*f/2||S>A-I*f/2)?S>C+I/2?1:-1:0}function Ps(s){return Qt(R)<Qt(s)?1:-1}function Cs(s){for(var n=s.tagName+s.className+s.src+s.href+s.textContent,i=n.length,a=0;i--;)a+=n.charCodeAt(i);return a.toString(36)}function $s(s){Dr.length=0;for(var n=s.getElementsByTagName("input"),i=n.length;i--;){var a=n[i];a.checked&&Dr.push(a)}}function vr(s){return setTimeout(s,0)}function Di(s){return clearTimeout(s)}Or&&at(document,"touchmove",function(s){(Q.active||an)&&s.cancelable&&s.preventDefault()});Q.utils={on:at,off:it,css:G,find:Go,is:function(n,i){return!!ne(n,i,n,!1)},extend:ms,throttle:Qo,closest:ne,toggleClass:zt,clone:Zo,index:Qt,nextTick:vr,cancelNextTick:Di,detectDirection:na,getChild:cn,expando:qt};Q.get=function(s){return s[qt]};Q.mount=function(){for(var s=arguments.length,n=new Array(s),i=0;i<s;i++)n[i]=arguments[i];n[0].constructor===Array&&(n=n[0]),n.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(Q.utils=ue(ue({},Q.utils),a.utils)),jn.mount(a)})};Q.create=function(s,n){return new Q(s,n)};Q.version=hs;var Ot=[],xn,xi,Ti=!1,bi,wi,xr,Tn;function Ms(){function s(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var n in this)n.charAt(0)==="_"&&typeof this[n]=="function"&&(this[n]=this[n].bind(this))}return s.prototype={dragStarted:function(i){var a=i.originalEvent;this.sortable.nativeDraggable?at(document,"dragover",this._handleAutoScroll):this.options.supportPointer?at(document,"pointermove",this._handleFallbackAutoScroll):a.touches?at(document,"touchmove",this._handleFallbackAutoScroll):at(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(i){var a=i.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?it(document,"dragover",this._handleAutoScroll):(it(document,"pointermove",this._handleFallbackAutoScroll),it(document,"touchmove",this._handleFallbackAutoScroll),it(document,"mousemove",this._handleFallbackAutoScroll)),Ro(),yr(),gs()},nulling:function(){xr=xi=xn=Ti=Tn=bi=wi=null,Ot.length=0},_handleFallbackAutoScroll:function(i){this._handleAutoScroll(i,!0)},_handleAutoScroll:function(i,a){var c=this,f=(i.touches?i.touches[0]:i).clientX,p=(i.touches?i.touches[0]:i).clientY,m=document.elementFromPoint(f,p);if(xr=i,a||this.options.forceAutoScrollFallback||Mn||ge||On){_i(i,this.options,m,a);var S=Ie(m,!0);Ti&&(!Tn||f!==bi||p!==wi)&&(Tn&&Ro(),Tn=setInterval(function(){var I=Ie(document.elementFromPoint(f,p),!0);I!==S&&(S=I,yr()),_i(i,c.options,I,a)},10),bi=f,wi=p)}else{if(!this.options.bubbleScroll||Ie(m,!0)===se()){yr();return}_i(i,this.options,Ie(m,!1),!1)}}},me(s,{pluginName:"scroll",initializeByDefault:!0})}function yr(){Ot.forEach(function(s){clearInterval(s.pid)}),Ot=[]}function Ro(){clearInterval(Tn)}var _i=Qo(function(s,n,i,a){if(n.scroll){var c=(s.touches?s.touches[0]:s).clientX,f=(s.touches?s.touches[0]:s).clientY,p=n.scrollSensitivity,m=n.scrollSpeed,S=se(),I=!1,C;xi!==i&&(xi=i,yr(),xn=n.scroll,C=n.scrollFn,xn===!0&&(xn=Ie(i,!0)));var A=0,U=xn;do{var W=U,Y=At(W),q=Y.top,V=Y.bottom,ut=Y.left,lt=Y.right,ht=Y.width,rt=Y.height,et=void 0,pt=void 0,ft=W.scrollWidth,mt=W.scrollHeight,Rt=G(W),ve=W.scrollLeft,Jt=W.scrollTop;W===S?(et=ht<ft&&(Rt.overflowX==="auto"||Rt.overflowX==="scroll"||Rt.overflowX==="visible"),pt=rt<mt&&(Rt.overflowY==="auto"||Rt.overflowY==="scroll"||Rt.overflowY==="visible")):(et=ht<ft&&(Rt.overflowX==="auto"||Rt.overflowX==="scroll"),pt=rt<mt&&(Rt.overflowY==="auto"||Rt.overflowY==="scroll"));var Zt=et&&(Math.abs(lt-c)<=p&&ve+ht<ft)-(Math.abs(ut-c)<=p&&!!ve),$t=pt&&(Math.abs(V-f)<=p&&Jt+rt<mt)-(Math.abs(q-f)<=p&&!!Jt);if(!Ot[A])for(var le=0;le<=A;le++)Ot[le]||(Ot[le]={});(Ot[A].vx!=Zt||Ot[A].vy!=$t||Ot[A].el!==W)&&(Ot[A].el=W,Ot[A].vx=Zt,Ot[A].vy=$t,clearInterval(Ot[A].pid),(Zt!=0||$t!=0)&&(I=!0,Ot[A].pid=setInterval((function(){a&&this.layer===0&&Q.active._onTouchMove(xr);var ce=Ot[this.layer].vy?Ot[this.layer].vy*m:0,Vt=Ot[this.layer].vx?Ot[this.layer].vx*m:0;typeof C=="function"&&C.call(Q.dragged.parentNode[qt],Vt,ce,s,xr,Ot[this.layer].el)!=="continue"||Jo(Ot[this.layer].el,Vt,ce)}).bind({layer:A}),24))),A++}while(n.bubbleScroll&&U!==S&&(U=Ie(U,!1)));Ti=I}},30),aa=function(n){var i=n.originalEvent,a=n.putSortable,c=n.dragEl,f=n.activeSortable,p=n.dispatchSortableEvent,m=n.hideGhostForTarget,S=n.unhideGhostForTarget;if(i){var I=a||f;m();var C=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:i,A=document.elementFromPoint(C.clientX,C.clientY);S(),I&&!I.el.contains(A)&&(p("spill"),this.onSpill({dragEl:c,putSortable:a}))}};function Mi(){}Mi.prototype={startIndex:null,dragStart:function(n){var i=n.oldDraggableIndex;this.startIndex=i},onSpill:function(n){var i=n.dragEl,a=n.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var c=cn(this.sortable.el,this.startIndex,this.options);c?this.sortable.el.insertBefore(i,c):this.sortable.el.appendChild(i),this.sortable.animateAll(),a&&a.animateAll()},drop:aa};me(Mi,{pluginName:"revertOnSpill"});function ji(){}ji.prototype={onSpill:function(n){var i=n.dragEl,a=n.putSortable,c=a||this.sortable;c.captureAnimationState(),i.parentNode&&i.parentNode.removeChild(i),c.animateAll()},drop:aa};me(ji,{pluginName:"removeOnSpill"});Q.mount(new Ms);Q.mount(ji,Mi);ls({immediate:!0});var qo;const St=(qo=window.Telegram)==null?void 0:qo.WebApp;St&&(St.ready(),St.expand());let Xt="main",un="all",It=null,sa=null,Tr=null,Ii=!1,In=null,Nt=null,br="overview",Li=!1,wr=!1;function js(s){Xt=s,vt()}let ki=null;function Ko(s){let n=document.querySelector(".toast");n||(n=document.createElement("div"),n.className="toast",document.body.appendChild(n)),n.textContent=s,n.classList.add("visible"),ki&&clearTimeout(ki),ki=setTimeout(()=>{n==null||n.classList.remove("visible")},2e3)}function vt(){const s=document.getElementById("app");if(!s)return;const n=localStorage.getItem("skip_tma_auth")==="true",i=!!(St!=null&&St.initData)&&!n,c=!!Ir();!i&&!c||(s.innerHTML=`
    <main class="content">
      ${Ls()}
    </main>
    <nav class="navigation">
      <button class="navigation__item ${Xt==="main"?"navigation__item_active":""}" data-page="main">
        <span class="navigation__icon">ðï¸</span>
        <span class="navigation__label">Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ°</span>
      </button>
      <button class="navigation__item ${Xt==="stats"?"navigation__item_active":""}" data-page="stats">
        <span class="navigation__icon">ð</span>
        <span class="navigation__label">Ð¡ÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ°</span>
      </button>
      <button class="navigation__item ${Xt==="profile-settings"?"navigation__item_active":""}" data-page="profile-settings">
        <span class="navigation__icon">ð¤</span>
        <span class="navigation__label">ÐÑÐ¾ÑÐ¸Ð»Ñ</span>
      </button>
      <button class="navigation__item ${Xt==="settings"?"navigation__item_active":""}" data-page="settings">
        <span class="navigation__icon">âï¸</span>
        <span class="navigation__label">ÐÐ°ÑÑÑÐ¾Ð¹ÐºÐ¸</span>
      </button>
    </nav>
    <div id="sync-status" class="sync-status"></div>
  `,s.querySelectorAll(".navigation__item").forEach(f=>{f.addEventListener("click",()=>{const p=f.getAttribute("data-page");js(p)})}),Ys())}let ua="idle";J.onSyncStatusChange(s=>{ua=s,Ri()});function Ri(){const s=document.getElementById("sync-status");if(!s)return;s.className="sync-status";let n="",i="";switch(ua){case"saving":n="Ð¡Ð¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ñ...",i="ð",s.classList.add("sync-status_saving");break;case"success":n="Ð¡Ð¾ÑÑÐ°Ð½ÐµÐ½Ð¾",i="â",s.classList.add("sync-status_success");break;case"error":n="ÐÑÐ¸Ð±ÐºÐ° ÑÐ¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ð¸",i="â ï¸",s.classList.add("sync-status_error");break;case"idle":if(!navigator.onLine)n="ÐÑÑÐ»Ð°Ð¹Ð½",i="ð¡",s.classList.add("sync-status_offline");else return;break}s.innerHTML=`${i} ${n}`}window.addEventListener("online",()=>{J.sync(),Ri()});window.addEventListener("offline",()=>Ri());function Ls(){switch(Xt){case"main":return Ks();case"stats":return Ws();case"settings":return Bs();case"profile-settings":return qs();case"public-profile":return Fs();default:return""}}function Rs(){const s=J.getActiveWorkout();if(s){const n=s.status==="paused";return`
      <div class="workout-controls card">
        <div class="workout-controls__header">
          <span class="workout-status ${n?"workout-status_paused":""}">
            ${n?"â¸ï¸ ÐÐ°ÑÐ·Ð°":"ð¥ Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ° Ð°ÐºÑÐ¸Ð²Ð½Ð°"}
          </span>
          ${s.name?`<span class="workout-name">${s.name}</span>`:""}
        </div>
        <div class="workout-controls__actions">
          ${n?'<button class="button" id="resume-workout-btn">ÐÑÐ¾Ð´Ð¾Ð»Ð¶Ð¸ÑÑ</button>':'<button class="button button_secondary" id="pause-workout-btn">ÐÐ°ÑÐ·Ð°</button>'}
          <button class="button button_destructive" id="finish-workout-btn">ÐÐ°Ð²ÐµÑÑÐ¸ÑÑ</button>
        </div>
      </div>
    `}return wr?`
      <div class="workout-controls card">
        <h3 class="subtitle" style="margin-top: 0">ÐÐ°ÑÐ°Ð»Ð¾ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸</h3>
        <form id="start-workout-form" style="display: flex; flex-direction: column; gap: 12px;">
          <input class="input" type="text" name="workoutName" placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ (Ð¾Ð¿ÑÐ¸Ð¾Ð½Ð°Ð»ÑÐ½Ð¾)">
          <div style="display: flex; gap: 8px;">
            <button class="button" type="submit">ÐÐ°ÑÐ°ÑÑ</button>
            <button class="button button_secondary" type="button" id="cancel-start-workout-btn">ÐÑÐ¼ÐµÐ½Ð°</button>
          </div>
        </form>
      </div>
    `:`
    <button class="button" id="start-workout-btn" style="margin-bottom: 24px;">â¶ï¸ ÐÐ°ÑÐ°ÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÑ</button>
  `}let Ft=0,Oi="";function Ki(s){const n=new Date;n.setHours(0,0,0,0);const i=new Date(n);i.setDate(n.getDate()-s*7),i.setHours(23,59,59,999);const a=new Date(i);return a.setDate(i.getDate()-6),a.setHours(0,0,0,0),{start:a,end:i,label:`${a.toLocaleDateString("ru-RU",{day:"numeric",month:"short"})} - ${i.toLocaleDateString("ru-RU",{day:"numeric",month:"short"})}`}}function Ks(){var p;const s=J.getWorkoutTypes(),n=J.getLogs(),i=n[n.length-1],a=i==null?void 0:i.workoutTypeId,c=It?n.find(m=>m.id===It):null,{label:f}=Ki(Ft);return`
    <div class="page-content" id="main-content">
      ${Rs()}
      <h1 class="title">${It?"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´ÑÐ¾Ð´Ð°":"ÐÐ¾Ð²ÑÐ¹ Ð¿Ð¾Ð´ÑÐ¾Ð´"}</h1>
      <form class="workout-form" id="log-form">
        <div class="form-group">
          <label class="label">Ð¢Ð¸Ð¿ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸</label>
          <select class="select" name="typeId" id="workout-type-select" required>
            ${s.map(m=>`<option value="${m.id}" ${(It?c&&m.id===c.workoutTypeId:m.id===a)?"selected":""}>${m.name}</option>`).join("")}
          </select>
        </div>
        
        <div id="strength-inputs" style="display: none;">
            <div class="form-row">
              <div class="form-group">
                <label class="label">ÐÐµÑ (ÐºÐ³)</label>
                <input class="input" type="number" name="weight" step="0.5" placeholder="0" value="${It&&c?c.weight:""}">
              </div>
              <div class="form-group">
                <label class="label">ÐÐ¾Ð²ÑÐ¾ÑÐµÐ½Ð¸Ð¹</label>
                <input class="input" type="number" name="reps" placeholder="0" value="${It&&c?c.reps:""}">
              </div>
            </div>
        </div>

        <div id="time-inputs" style="display: none;">
            <div class="form-group">
                <label class="label">ÐÑÐµÐ¼Ñ (Ð¼Ð¸Ð½)</label>
                <input class="input" type="number" name="duration" placeholder="0" value="${It&&c&&c.duration||""}">
            </div>
        </div>

        <button class="button" type="submit">${It?"Ð¡Ð¾ÑÑÐ°Ð½Ð¸ÑÑ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ":"ÐÐ°ÑÐ¸ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ"}</button>
        ${It?'<button class="button button_secondary" type="button" id="cancel-edit-btn" style="margin-top: 12px;">ÐÑÐ¼ÐµÐ½Ð°</button>':""}
        ${!It&&i?`<button class="button button_secondary" type="button" id="duplicate-last-btn" style="margin-top: 12px;">ÐÐ¾Ð²ÑÐ¾ÑÐ¸ÑÑ: ${(p=s.find(m=>m.id===i.workoutTypeId))==null?void 0:p.name} ${i.weight?`${i.weight}ÐºÐ³ Ã ${i.reps}`:`${i.duration} Ð¼Ð¸Ð½`}</button>`:""}
      </form>
      <div class="recent-logs">
        <div class="recent-logs__header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
           <button class="icon-btn" id="prev-week-btn">âï¸</button>
           <div id="week-label-container" style="display: flex; align-items: center; gap: 8px; position: relative;">
             <span style="font-size: 18px; position: relative; display: inline-block;">
               ð
               <input type="date" id="calendar-input" value="${Oi}" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;">
             </span>
             <h2 class="subtitle" style="margin: 0;">${Ft===0?"ÐÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 7 Ð´Ð½ÐµÐ¹":f}</h2>
             <label class="filter-toggle" title="Ð¤Ð¸Ð»ÑÑÑ Ð¿Ð¾ ÑÐ¸Ð¿Ñ ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ñ">
               <input type="checkbox" id="filter-toggle-input" ${Li?"checked":""}>
               <span class="filter-toggle__icon">ð</span>
             </label>
           </div>
           <button class="icon-btn" id="next-week-btn" ${Ft===0?"disabled":""} style="${Ft===0?"opacity: 0.3; cursor: default;":""}">â¶ï¸</button>
        </div>
        <div id="logs-list">
          ${la()}
        </div>
      </div>
    </div>
  `}function la(){var f;const s=J.getLogs(),n=J.getWorkoutTypes(),{start:i,end:a}=Ki(Ft);let c=s.filter(p=>{const m=new Date(p.date);return m>=i&&m<=a});if(Li){const p=(f=document.querySelector('select[name="typeId"]'))==null?void 0:f.value;p&&(c=c.filter(m=>m.workoutTypeId===p))}return ca(c,n,!0)}function hr(){const s=document.getElementById("logs-list"),n=document.querySelector("#week-label-container .subtitle");if(s&&(s.innerHTML=la(),Ns()),n){const{label:a}=Ki(Ft);n.textContent=Ft===0?"ÐÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 7 Ð´Ð½ÐµÐ¹":a}const i=document.getElementById("next-week-btn");i&&(i.disabled=Ft===0,i.style.opacity=Ft===0?"0.3":"",i.style.cursor=Ft===0?"default":"")}function Ns(){document.querySelectorAll(".log-set__delete").forEach(s=>{s.addEventListener("click",async()=>{const n=s.getAttribute("data-id");n&&(It===n&&(It=null),await J.deleteLog(n),vt())})}),document.querySelectorAll(".log-set__edit").forEach(s=>{s.addEventListener("click",()=>{It=s.getAttribute("data-id"),vt(),window.scrollTo({top:0,behavior:"smooth"})})}),document.querySelectorAll(".share-btn").forEach(s=>{s.addEventListener("click",()=>{const n=s.getAttribute("data-date");n&&da(n)})})}function ca(s,n,i){if(s.length===0)return'<p class="hint">ÐÐµÑ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð·Ð° ÑÑÐ¾Ñ Ð¿ÐµÑÐ¸Ð¾Ð´</p>';const a=new Map;[...s].sort((p,m)=>new Date(m.date).getTime()-new Date(p.date).getTime()).forEach(p=>{const S=new Date(p.date).toLocaleDateString(void 0,{weekday:"long",day:"numeric",month:"long"});a.has(S)||a.set(S,[]),a.get(S).push(p)});const c=J.getWorkouts();let f="";return a.forEach((p,m)=>{var q;const S=((q=p[0])==null?void 0:q.date.split("T")[0])||"",I=new Set;p.forEach(V=>{V.workoutId&&I.add(V.workoutId)});const C=Array.from(I).sort((V,ut)=>{var pt,ft;const lt=c.find(mt=>mt.id===V),ht=c.find(mt=>mt.id===ut),rt=(lt==null?void 0:lt.startTime)||((pt=p.find(mt=>mt.workoutId===V))==null?void 0:pt.date)||"",et=(ht==null?void 0:ht.startTime)||((ft=p.find(mt=>mt.workoutId===ut))==null?void 0:ft.date)||"";return new Date(et).getTime()-new Date(rt).getTime()}),A=C.length===1?C[0]:null,U=A?c.find(V=>V.id===A):null,W=U&&U.name,Y=U?Math.round(J.getWorkoutDuration(U)):0;f+='<div class="log-day">',f+=`<div class="log-day__header">
      <span>${m}${W?` â¢ ${U.name}`:""}${U?` â¢ ${Y} Ð¼Ð¸Ð½`:""}</span>
      ${i?`<button class="share-btn" data-date="${S}" title="ÐÐ¾Ð´ÐµÐ»Ð¸ÑÑÑÑ">ð¤</button>`:""}
    </div>`,C.forEach(V=>{const ut=c.find(et=>et.id===V),lt=p.filter(et=>et.workoutId===V);if(!(C.length===1&&(W||!(ut!=null&&ut.name)))){const et=ut?Math.round(J.getWorkoutDuration(ut)):0;f+=`<h3 class="workout-subheader">
                ${(ut==null?void 0:ut.name)||"Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ°"} 
                <span class="workout-subheader__time">${et} Ð¼Ð¸Ð½</span>
            </h3>`}const rt=new Map;lt.forEach(et=>{rt.has(et.workoutTypeId)||rt.set(et.workoutTypeId,[]),rt.get(et.workoutTypeId).push(et)}),rt.forEach((et,pt)=>{const ft=n.find(mt=>mt.id===pt);f+=`
            <div class="log-exercise">
              <div class="log-exercise__name">${(ft==null?void 0:ft.name)||"Ð£Ð´Ð°Ð»ÐµÐ½Ð¾"}</div>
              <div class="log-exercise__sets">
                ${et.map(mt=>`
                  <div class="log-set ${mt.id===It?"log-set_active-edit":""} ${mt.id===In?"log-set_new":""}">
                    <div class="log-set__info">
                      ${mt.weight!==void 0&&mt.reps!==void 0?`
                        <span class="log-set__weight">${mt.weight} ÐºÐ³</span>
                        <span class="log-set__times">Ã</span>
                        <span class="log-set__reps">${mt.reps}</span>
                      `:`
                        <span class="log-set__reps">â± ${mt.duration} Ð¼Ð¸Ð½</span>
                      `}
                    </div>
                    ${i?`
                    <div class="log-set__actions">
                      <button class="log-set__edit" data-id="${mt.id}">âï¸</button>
                      <button class="log-set__delete" data-id="${mt.id}">Ã</button>
                    </div>
                    `:""}
                  </div>
                `).join("")}
              </div>
            </div>
          `})}),f+="</div>"}),f}function Bs(){const s=J.getWorkoutTypes(),n=Nt?s.find(i=>i.id===Nt):null;return`
    <div class="page-content">
      <h1 class="title">ÐÐ°ÑÑÑÐ¾Ð¹ÐºÐ¸</h1>
      <div class="settings-section">
        <h2 class="subtitle">${Nt?"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ¸Ð¿Ð°":"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ ÑÐ¸Ð¿ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸"}</h2>
        <form class="add-type-form" id="add-type-form" style="margin-bottom: 24px;">
          <div style="display: flex; gap: 8px; flex-direction: column;">
            <input class="input" type="text" id="new-type-name" placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ (Ð½Ð°Ð¿Ñ. ÐÐ¸Ð¼ Ð³Ð°Ð½ÑÐµÐ»ÐµÐ¹)" required value="${n?n.name:""}">
            
            <div class="category-switch" style="display: flex; gap: 12px; margin-bottom: 8px;">
                <label style="display: flex; align-items: center; gap: 4px;">
                    <input type="radio" name="new-type-category" value="strength" ${!n||n.category!=="time"?"checked":""}>
                    Ð¡Ð¸Ð»Ð¾Ð²Ð¾Ðµ
                </label>
                <label style="display: flex; align-items: center; gap: 4px;">
                    <input type="radio" name="new-type-category" value="time" ${n&&n.category==="time"?"checked":""}>
                    ÐÐ° Ð²ÑÐµÐ¼Ñ
                </label>
            </div>

            <button class="button" type="submit">${Nt?"Ð¡Ð¾ÑÑÐ°Ð½Ð¸ÑÑ":"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ"}</button>
          </div>
          ${Nt?'<button class="button button_secondary" type="button" id="cancel-edit-type-btn" style="margin-top: 8px; width: 100%;">ÐÑÐ¼ÐµÐ½Ð°</button>':""}
        </form>

        <h2 class="subtitle">Ð¢Ð¸Ð¿Ñ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</h2>
        <div class="type-list" id="workout-type-list">
          ${s.map(i=>`
            <div class="type-item" data-id="${i.id}">
              <span class="drag-handle" style="cursor: grab; margin-right: 12px; opacity: 0.5;">â®â®</span>
              <span style="flex-grow: 1;">${i.name}</span>
              <div style="display: flex; gap: 8px;">
                <button class="type-item__edit icon-btn" data-id="${i.id}" title="Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ">âï¸</button>
                <button class="type-item__delete icon-btn" data-id="${i.id}" title="Ð£Ð´Ð°Ð»Ð¸ÑÑ">Ã</button>
              </div>
            </div>
          `).join("")}
        </div>
      </div>
    </div>
  `}function qs(){var S,I;const s=J.getProfile(),n=(s==null?void 0:s.isPublic)??!1,i=(s==null?void 0:s.displayName)||((I=(S=St==null?void 0:St.initDataUnsafe)==null?void 0:S.user)==null?void 0:I.first_name)||"",a=J.getProfileIdentifier(),c=a?`https://t.me/gymgym21bot/app?startapp=profile_${a}`:"",f=J.getLogs(),p=f.reduce((C,A)=>C+(A.weight||0)*(A.reps||0),0),m=new Set(f.map(C=>C.date.split("T")[0])).size;return`
    <div class="page-content profile-page">
      <h1 class="title">ÐÑÐ¾ÑÐ¸Ð»Ñ</h1>
      
      <div class="profile-header">
        <div class="profile-avatar">
          ${s!=null&&s.photoUrl?`<img src="${s.photoUrl}" alt="${i}" class="profile-avatar-img">`:i.charAt(0).toUpperCase()}
        </div>
        <div class="profile-name">${i}</div>
        <div class="profile-subtitle">${n?"ÐÑÐ±Ð»Ð¸ÑÐ½ÑÐ¹ Ð¿ÑÐ¾ÑÐ¸Ð»Ñ":"ÐÑÐ¸Ð²Ð°ÑÐ½ÑÐ¹ Ð¿ÑÐ¾ÑÐ¸Ð»Ñ"}</div>
      </div>

      <div class="profile-settings">
        <div class="settings-section">
          <div class="settings-section-title">ÐÐ¸Ð´Ð¸Ð¼Ð¾ÑÑÑ</div>
          <div class="toggle-row">
            <div class="toggle-label">
              <span class="toggle-label-text">ÐÑÐ±Ð»Ð¸ÑÐ½ÑÐ¹ Ð¿ÑÐ¾ÑÐ¸Ð»Ñ</span>
              <span class="toggle-label-hint">ÐÑÑÐ³Ð¸Ðµ ÑÐ¼Ð¾Ð³ÑÑ Ð²Ð¸Ð´ÐµÑÑ Ð²Ð°ÑÑ ÑÑÐ°ÑÐ¸ÑÑÐ¸ÐºÑ</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="profile-public-toggle" ${n?"checked":""}>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-row" style="margin-top: 12px;">
            <div class="toggle-label">
              <span class="toggle-label-text">ÐÐ¾ÐºÐ°Ð·ÑÐ²Ð°ÑÑ Ð²ÑÐµ ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ñ</span>
              <span class="toggle-label-hint">ÐÐ¾Ð´ÑÐ¾Ð±Ð½ÑÐ¹ ÑÐ¿Ð¸ÑÐ¾Ðº ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ð¹ Ð² Ð¿ÑÐ±Ð»Ð¸ÑÐ½Ð¾Ð¼ Ð¿ÑÐ¾ÑÐ¸Ð»Ðµ</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="profile-history-toggle" ${s!=null&&s.showFullHistory?"checked":""}>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="settings-section">
          <div class="settings-section-title">ÐÐ¼Ñ</div>
          <input class="input" type="text" id="profile-display-name" value="${i}" placeholder="ÐÐ°ÑÐµ Ð¸Ð¼Ñ">
        </div>

        ${n&&a?`
          <div class="settings-section">
            <div class="settings-section-title">Ð¡ÑÑÐ»ÐºÐ° Ð½Ð° Ð¿ÑÐ¾ÑÐ¸Ð»Ñ</div>
            <div class="profile-link-section">
              <a href="${c}" target="_blank" class="profile-link-url">${c}</a>
              <div class="profile-link-actions">
                <button class="button button_secondary" id="copy-profile-link">ÐÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°ÑÑ</button>
                <button class="button" id="share-profile-link">ÐÐ¾Ð´ÐµÐ»Ð¸ÑÑÑÑ</button>
              </div>
            </div>
          </div>
        `:""}

        <div class="settings-section">
          <div class="settings-section-title">ÐÑÐµÐ²ÑÑ ÑÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ¸</div>
          <div class="profile-stats">
            <div class="stat-card">
              <div class="stat-value">${m}</div>
              <div class="stat-label">Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">${Math.round(p/1e3)}Ñ</div>
              <div class="stat-label">ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÑÐ¼</div>
            </div>
          </div>
        </div>

        <button class="button" id="save-profile-btn">Ð¡Ð¾ÑÑÐ°Ð½Ð¸ÑÑ</button>
      </div>
    </div>
  `}function Fs(){if(!sa)return`
      <div class="page-content">
        <div class="profile-not-found">
          <div class="profile-not-found-icon">ð</div>
          <div class="profile-not-found-text">ÐÑÐ¾ÑÐ¸Ð»Ñ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½</div>
        </div>
      </div>
    `;if(!Tr)return Ii?`
        <div class="page-content">
          <div class="profile-not-found">
            <div class="profile-not-found-icon">ð</div>
            <div class="profile-not-found-text">ÐÑÐ¾ÑÐ¸Ð»Ñ ÑÐºÑÑÑ Ð¸Ð»Ð¸ Ð½Ðµ ÑÑÑÐµÑÑÐ²ÑÐµÑ</div>
          </div>
        </div>
      `:`
      <div class="page-content">
        <div class="profile-loading">ÐÐ°Ð³ÑÑÐ·ÐºÐ° Ð¿ÑÐ¾ÑÐ¸Ð»Ñ...</div>
      </div>
    `;const s=Tr;return`
    <div class="page-content profile-page">
      <div class="profile-header">
        <div class="profile-avatar">
          ${s.photoUrl?`<img src="${s.photoUrl}" alt="${s.displayName}" class="profile-avatar-img">`:s.displayName.charAt(0).toUpperCase()}
        </div>
        <div class="profile-name">${s.displayName}</div>
        <div class="profile-subtitle">@${s.identifier}</div>
      </div>

      <div class="profile-stats">
        <div class="stat-card">
          <div class="stat-value">${s.stats.totalWorkouts}</div>
          <div class="stat-label">Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${Math.round(s.stats.totalVolume/1e3)}Ñ</div>
          <div class="stat-label">ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÑÐ¼</div>
        </div>
        ${s.stats.favoriteExercise?`
          <div class="stat-card">
            <div class="stat-value" style="font-size: 1rem;">${s.stats.favoriteExercise}</div>
            <div class="stat-label">ÐÑÐ±Ð¸Ð¼Ð¾Ðµ ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ðµ</div>
          </div>
        `:""}
        ${s.stats.lastWorkoutDate?`
          <div class="stat-card">
            <div class="stat-value" style="font-size: 1rem;">${new Date(s.stats.lastWorkoutDate).toLocaleDateString()}</div>
            <div class="stat-label">ÐÐ¾ÑÐ»ÐµÐ´Ð½ÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ°</div>
          </div>
        `:""}
      </div>

      ${s.recentActivity.length>0?`
        <div class="activity-list">
          <h2 class="subtitle">ÐÐµÐ´Ð°Ð²Ð½ÑÑ Ð°ÐºÑÐ¸Ð²Ð½Ð¾ÑÑÑ</h2>
          ${s.recentActivity.map(n=>`
            <div class="activity-item">
              <span class="activity-date">${new Date(n.date).toLocaleDateString()}</span>
              <span class="activity-count">${n.exerciseCount} ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ð¹</span>
            </div>
          `).join("")}
        </div>
      `:""}

      ${s.logs&&s.logs.length>0&&s.workoutTypes?`
        <div class="recent-logs">
          <h2 class="subtitle">ÐÑÑÐ¾ÑÐ¸Ñ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</h2>
          <div id="logs-list">
            ${ca(s.logs,s.workoutTypes,!1)}
          </div>
        </div>
      `:""}
    </div>
  `}function Ws(){const s=J.getLogs(),n=J.getWorkouts(),i=J.getWorkoutTypes();if(s.length===0)return`
      <div class="page-content">
        <h1 class="title">Ð¡ÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ°</h1>
        <p class="hint">ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð´Ð°Ð½Ð½ÑÑ Ð´Ð»Ñ ÑÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ¸</p>
      </div>
    `;const a=s.reduce((m,S)=>m+(S.weight||0)*(S.reps||0),0),c=s.reduce((m,S)=>m+(S.reps||0),0),f=rs(n);let p=`
    <div class="page-content">
      <h1 class="title">Ð¡ÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ°</h1>
      <div class="stats-tabs">
        <button class="stats-tab ${br==="overview"?"active":""}" data-tab="overview">ÐÐ±Ð·Ð¾Ñ</button>
        <button class="stats-tab ${br==="progress"?"active":""}" data-tab="progress">ÐÑÐ¾Ð³ÑÐµÑÑ</button>
      </div>
  `;if(br==="overview"){const m=ns(n,s);p+=`
        <div class="stats-section">
            <h2 class="subtitle">ÐÐºÑÐ¸Ð²Ð½Ð¾ÑÑÑ</h2>
            ${is(m)}
        </div>

        <div class="stats-summary">
            <div class="stat-metric">
                <div class="stat-metric__label">ÐÑÐµÐ³Ð¾ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</div>
                <div class="stat-metric__value">${m.size}</div>
            </div>
            <div class="stat-metric">
                <div class="stat-metric__label">Ð¡ÑÐµÐ´. Ð´Ð»Ð¸ÑÐµÐ»ÑÐ½Ð¾ÑÑÑ</div>
                <div class="stat-metric__value">${f.averageMinutes}<span class="stat-metric__unit">Ð¼Ð¸Ð½</span></div>
            </div>
             <div class="stat-metric">
                <div class="stat-metric__label">ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÐµÐ¼</div>
                <div class="stat-metric__value">${Math.round(a/1e3)}<span class="stat-metric__unit">Ñ</span></div>
            </div>
            <div class="stat-metric">
                <div class="stat-metric__label">ÐÑÐµÐ³Ð¾ Ð¿Ð¾Ð²ÑÐ¾ÑÐµÐ½Ð¸Ð¹</div>
                <div class="stat-metric__value">${c}</div>
            </div>
        </div>

        <div class="charts-section">
            <h2 class="subtitle">ÐÐ»Ð¸ÑÐµÐ»ÑÐ½Ð¾ÑÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</h2>
            <div class="chart-container">
                ${as(n)}
            </div>
        </div>
     `}else if(p+=`
        <div class="form-group">
            <label class="label">Ð£Ð¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ðµ</label>
            <select class="select" id="stat-type-select">
                <option value="all">ÐÑÐµ ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ñ (ÐÐ±ÑÐµÐ¼)</option>
                ${i.map(m=>`<option value="${m.id}" ${un===m.id?"selected":""}>${m.name}</option>`).join("")}
            </select>
        </div>
    `,un==="all")p+=`
            <div class="charts-section">
                <h2 class="subtitle">ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÐµÐ¼ Ð¿Ð¾ Ð´Ð½ÑÐ¼</h2>
                <div class="chart-container">
                    ${Io(s)}
                </div>
            </div>
        `;else{const m=s.filter(I=>I.workoutTypeId===un),S=es(m,un);p+=`
             <div class="charts-section">
                <h2 class="subtitle">ÐÑÐ¾Ð³ÑÐµÑÑ ÑÐ¸Ð»Ð¾Ð²ÑÑ (1RM)</h2>
                <div class="chart-container">
                    ${os(S)}
                </div>
            </div>
            
            <div class="charts-section" style="margin-top: 24px;">
                <h2 class="subtitle">ÐÐ±ÑÐµÐ¼ Ð½Ð°Ð³ÑÑÐ·ÐºÐ¸</h2>
                 <div class="chart-container">
                    ${Io(m)}
                </div>
            </div>
        `}return p+="</div>",p}function Us(s){const n=J.getLogs(),i=J.getWorkoutTypes(),a=n.filter(I=>I.date.startsWith(s));if(a.length===0)return"";const f=new Date(a[0].date).toLocaleDateString("ru-RU",{day:"numeric",month:"long"}),p=new Map;a.forEach(I=>{p.has(I.workoutTypeId)||p.set(I.workoutTypeId,[]),p.get(I.workoutTypeId).push(I)});let m=`ðï¸ Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ° ${f}

`;p.forEach((I,C)=>{const A=i.find(U=>U.id===C);m+=`${(A==null?void 0:A.name)||"Ð£Ð¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ðµ"}:
`,I.forEach(U=>{U.duration?m+=`  â± ${U.duration} Ð¼Ð¸Ð½
`:m+=`  ${U.weight} ÐºÐ³ Ã ${U.reps}
`}),m+=`
`});const S=a.reduce((I,C)=>I+(C.weight&&C.reps?C.weight*C.reps:0),0);return S&&(m+=`ðª ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÑÐ¼: ${Math.round(S)} ÐºÐ³`),m}function da(s){const n=Us(s);if(n)if(St!=null&&St.openTelegramLink){const i=`https://t.me/share/url?url=${encodeURIComponent("https://t.me/gymgym21bot")}&text=${encodeURIComponent(n)}`;St.openTelegramLink(i)}else navigator.clipboard.writeText(n).then(()=>{alert("Ð¢ÐµÐºÑÑ ÑÐºÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°Ð½ Ð² Ð±ÑÑÐµÑ Ð¾Ð±Ð¼ÐµÐ½Ð°")})}function Ys(){if(Xt==="main"){const s=document.getElementById("start-workout-btn");s==null||s.addEventListener("click",()=>{wr=!0,vt()});const n=document.getElementById("cancel-start-workout-btn");n==null||n.addEventListener("click",()=>{wr=!1,vt()});const i=document.getElementById("start-workout-form");i==null||i.addEventListener("submit",async q=>{q.preventDefault();const ut=new FormData(i).get("workoutName");await J.startWorkout(ut),wr=!1,vt()});const a=document.getElementById("pause-workout-btn");a==null||a.addEventListener("click",async()=>{await J.pauseWorkout(),vt()});const c=document.getElementById("resume-workout-btn");c==null||c.addEventListener("click",async()=>{await J.resumeWorkout(),vt()});const f=document.getElementById("finish-workout-btn");f==null||f.addEventListener("click",async()=>{confirm("ÐÐ°Ð²ÐµÑÑÐ¸ÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÑ?")&&(await J.finishWorkout(),vt())});const p=document.getElementById("log-form"),m=()=>{const q=document.getElementById("workout-type-select"),V=J.getWorkoutTypes(),ut=q==null?void 0:q.value,lt=V.find(et=>et.id===ut),ht=document.getElementById("strength-inputs"),rt=document.getElementById("time-inputs");lt&&lt.category==="time"?(ht&&(ht.style.display="none"),rt&&(rt.style.display="block"),p.querySelectorAll('input[name="weight"], input[name="reps"]').forEach(et=>et.removeAttribute("required")),p.querySelectorAll('input[name="duration"]').forEach(et=>et.setAttribute("required","true"))):(ht&&(ht.style.display="block"),rt&&(rt.style.display="none"),p.querySelectorAll('input[name="weight"], input[name="reps"]').forEach(et=>et.setAttribute("required","true")),p.querySelectorAll('input[name="duration"]').forEach(et=>et.removeAttribute("required")))};m();const S=document.getElementById("workout-type-select");S==null||S.addEventListener("change",m),p==null||p.addEventListener("submit",async q=>{q.preventDefault();const V=new FormData(p),ut=V.get("typeId"),ht=J.getWorkoutTypes().find(et=>et.id===ut),rt={workoutTypeId:ut};if((ht==null?void 0:ht.category)==="time"?rt.duration=parseInt(V.get("duration"),10):(rt.weight=parseFloat(V.get("weight")),rt.reps=parseInt(V.get("reps"),10)),It){const pt=J.getLogs().find(ft=>ft.id===It);pt&&(await J.updateLog({...pt,...rt}),It=null)}else In=(await J.addLog(rt)).id;vt(),In=null});const I=document.getElementById("duplicate-last-btn");I==null||I.addEventListener("click",async()=>{const q=J.getLogs(),V=q[q.length-1];V&&(In=(await J.addLog({workoutTypeId:V.workoutTypeId,weight:V.weight,reps:V.reps,duration:V.duration})).id,vt(),In=null)});const C=document.getElementById("cancel-edit-btn");C==null||C.addEventListener("click",()=>{It=null,vt()}),document.querySelectorAll(".log-set__delete").forEach(q=>{q.addEventListener("click",async()=>{const V=q.getAttribute("data-id");V&&(It===V&&(It=null),await J.deleteLog(V),vt())})}),document.querySelectorAll(".log-set__edit").forEach(q=>{q.addEventListener("click",()=>{It=q.getAttribute("data-id"),vt(),window.scrollTo({top:0,behavior:"smooth"})})}),document.querySelectorAll(".share-btn").forEach(q=>{q.addEventListener("click",()=>{const V=q.getAttribute("data-date");V&&da(V)})});const A=document.getElementById("prev-week-btn");A==null||A.addEventListener("click",()=>{Ft++,hr()});const U=document.getElementById("next-week-btn");U==null||U.addEventListener("click",()=>{Ft>0&&(Ft--,hr())});const W=document.getElementById("calendar-input");W==null||W.addEventListener("change",()=>{if(!W.value||W.value===Oi)return;Oi=W.value;const q=new Date(W.value),V=new Date;V.setHours(0,0,0,0);const ut=V.getTime()-q.getTime(),lt=Math.floor(ut/(1e3*60*60*24));Ft=Math.max(0,Math.floor(lt/7)),hr()});const Y=document.getElementById("filter-toggle-input");Y==null||Y.addEventListener("change",()=>{Li=Y.checked,hr()})}if(Xt==="settings"){const s=document.getElementById("add-type-form");s==null||s.addEventListener("submit",async i=>{var f;i.preventDefault();const a=document.getElementById("new-type-name"),c=(f=document.querySelector('input[name="new-type-category"]:checked'))==null?void 0:f.value;a.value&&(Nt?(await J.updateWorkoutType(Nt,a.value,c),Nt=null):await J.addWorkoutType(a.value,c),vt())});const n=document.getElementById("cancel-edit-type-btn");n==null||n.addEventListener("click",()=>{Nt=null,vt()}),document.querySelectorAll(".type-item__edit").forEach(i=>{i.addEventListener("click",()=>{Nt=i.getAttribute("data-id"),vt();const a=document.getElementById("new-type-name");a==null||a.focus()})}),document.querySelectorAll(".type-item__delete").forEach(i=>{i.addEventListener("click",async()=>{const a=i.getAttribute("data-id");a&&confirm("Ð£Ð´Ð°Ð»Ð¸ÑÑ ÑÑÐ¾Ñ ÑÐ¸Ð¿ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸?")&&(Nt===a&&(Nt=null),await J.deleteWorkoutType(a),vt())})})}if(Xt==="settings"){const s=document.getElementById("workout-type-list");s&&Q.create(s,{animation:150,handle:".type-item",onEnd:async()=>{const n=Array.from(s.children).map(i=>i.getAttribute("data-id")||"").filter(Boolean);await J.updateWorkoutTypeOrder(n)}}),document.querySelectorAll(".type-item__edit").forEach(n=>{n.addEventListener("click",()=>{Nt=n.getAttribute("data-id"),vt();const i=document.getElementById("new-type-name");i==null||i.focus()})}),document.querySelectorAll(".type-item__delete").forEach(n=>{n.addEventListener("click",async()=>{const i=n.getAttribute("data-id");i&&confirm("Ð£Ð´Ð°Ð»Ð¸ÑÑ ÑÑÐ¾Ñ ÑÐ¸Ð¿ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸?")&&(Nt===i&&(Nt=null),await J.deleteWorkoutType(i),vt())})})}if(Xt==="stats"){const s=document.getElementById("stat-type-select");s==null||s.addEventListener("change",()=>{un=s.value,vt()})}if(Xt==="profile-settings"){const s=document.getElementById("save-profile-btn");s==null||s.addEventListener("click",async()=>{const a=document.getElementById("profile-public-toggle"),c=document.getElementById("profile-history-toggle"),f=document.getElementById("profile-display-name");await J.updateProfileSettings({isPublic:(a==null?void 0:a.checked)??!1,showFullHistory:(c==null?void 0:c.checked)??!1,displayName:(f==null?void 0:f.value)||void 0}),vt()});const n=document.getElementById("copy-profile-link");n==null||n.addEventListener("click",()=>{const c=`https://t.me/gymgym21bot/app?startapp=profile_${J.getProfileIdentifier()}`;navigator.clipboard.writeText(c).then(()=>{Ko("Ð¡ÑÑÐ»ÐºÐ° ÑÐºÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°Ð½Ð°")})});const i=document.getElementById("share-profile-link");i==null||i.addEventListener("click",()=>{const c=`https://t.me/gymgym21bot/app?startapp=profile_${J.getProfileIdentifier()}`;if(St!=null&&St.openTelegramLink){const f=`https://t.me/share/url?url=${encodeURIComponent(c)}&text=${encodeURIComponent("ÐÐ¾Ð¹ Ð¿ÑÐ¾ÑÐ¸Ð»Ñ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº ðª")}`;St.openTelegramLink(f)}else navigator.clipboard.writeText(c).then(()=>{Ko("Ð¡ÑÑÐ»ÐºÐ° ÑÐºÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°Ð½Ð°")})})}if(Xt==="stats"){document.querySelectorAll(".stats-tab").forEach(i=>{i.addEventListener("click",()=>{const a=i.getAttribute("data-tab");(a==="overview"||a==="progress")&&(br=a,vt())})});const n=document.getElementById("stat-type-select");n==null||n.addEventListener("change",i=>{un=i.target.value,vt()})}}const Fe=document.createElement("div");Fe.className="sync-status";document.body.appendChild(Fe);function zs(s){switch(Fe.className="sync-status visible "+s,s){case"saving":Fe.textContent="Ð¡Ð¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ñ...";break;case"success":Fe.textContent="Ð¡Ð¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð¸ÑÐ¾Ð²Ð°Ð½Ð¾";break;case"error":Fe.textContent="ÐÑÐ¸Ð±ÐºÐ° ÑÐ¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ð¸";break;default:Fe.className="sync-status"}}J.onUpdate(()=>vt());J.onSyncStatusChange(zs);async function Hs(){var m;const s=new URLSearchParams(window.location.search);if(s.has("hash")&&s.has("id")){const S={id:parseInt(s.get("id")||"0",10),first_name:s.get("first_name")||"",last_name:s.get("last_name")||void 0,username:s.get("username")||void 0,photo_url:s.get("photo_url")||void 0,auth_date:parseInt(s.get("auth_date")||"0",10),hash:s.get("hash")||""};Pi(S),s.delete("hash"),s.delete("id"),s.delete("first_name"),s.delete("last_name"),s.delete("username"),s.delete("photo_url"),s.delete("auth_date"),s.delete("auth");const I=s.toString(),C=window.location.pathname+(I?"?"+I:"");window.history.replaceState({},document.title,C),location.reload();return}const n=localStorage.getItem("skip_tma_auth")==="true",i=!!(St!=null&&St.initData)&&!n,c=!!Ir();if(!i&&!c){us(document.getElementById("app"),()=>{location.reload()});return}const p=new URLSearchParams(window.location.search).get("startapp")||((m=St==null?void 0:St.initDataUnsafe)==null?void 0:m.start_param);if(p&&p.startsWith("profile_")){const S=p.replace("profile_","");sa=S,Xt="public-profile",Ii=!1,vt(),Tr=await J.getPublicProfile(S),Tr||(Ii=!0),vt()}else vt();await J.init()}Hs();
