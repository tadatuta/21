var Ya=Object.defineProperty;var Ga=(v,u,c)=>u in v?Ya(v,u,{enumerable:!0,configurable:!0,writable:!0,value:c}):v[u]=c;var Lt=(v,u,c)=>Ga(v,typeof u!="symbol"?u+"":u,c);(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))g(x);new MutationObserver(x=>{for(const T of x)if(T.type==="childList")for(const S of T.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&g(S)}).observe(document,{childList:!0,subtree:!0});function c(x){const T={};return x.integrity&&(T.integrity=x.integrity),x.referrerPolicy&&(T.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?T.credentials="include":x.crossOrigin==="anonymous"?T.credentials="omit":T.credentials="same-origin",T}function g(x){if(x.ep)return;x.ep=!0;const T=c(x);fetch(x.href,T)}})();const Qa="modulepreload",Xa=function(v,u){return new URL(v,u).href},Hr={},ra=function(u,c,g){let x=Promise.resolve();if(c&&c.length>0){const S=document.getElementsByTagName("link"),D=document.querySelector("meta[property=csp-nonce]"),$=(D==null?void 0:D.nonce)||(D==null?void 0:D.getAttribute("nonce"));x=Promise.allSettled(c.map(R=>{if(R=Xa(R,g),R in Hr)return;Hr[R]=!0;const U=R.endsWith(".css"),N=U?'[rel="stylesheet"]':"";if(!!g)for(let it=S.length-1;it>=0;it--){const H=S[it];if(H.href===R&&(!U||H.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${R}"]${N}`))return;const Q=document.createElement("link");if(Q.rel=U?"stylesheet":Qa,U||(Q.as="script"),Q.crossOrigin="",Q.href=R,$&&Q.setAttribute("nonce",$),document.head.appendChild(Q),U)return new Promise((it,H)=>{Q.addEventListener("load",it),Q.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${R}`)))})}))}function T(S){const D=new Event("vite:preloadError",{cancelable:!0});if(D.payload=S,window.dispatchEvent(D),!D.defaultPrevented)throw S}return x.then(S=>{for(const D of S||[])D.status==="rejected"&&T(D.reason);return u().catch(T)})};var Yr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ja(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}var aa={exports:{}};(function(v,u){((c,g)=>{v.exports=g()})(Yr,function(){var c=function(t,e){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(n,r){n.__proto__=r}:function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])}))(t,e)},g=function(){return(g=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};function x(t,e,n){for(var r,a=0,i=e.length;a<i;a++)!r&&a in e||((r=r||Array.prototype.slice.call(e,0,a))[a]=e[a]);return t.concat(r||Array.prototype.slice.call(e))}var T=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Yr,S=Object.keys,D=Array.isArray;function $(t,e){return typeof e=="object"&&S(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||T.Promise||(T.Promise=Promise);var R=Object.getPrototypeOf,U={}.hasOwnProperty;function N(t,e){return U.call(t,e)}function nt(t,e){typeof e=="function"&&(e=e(R(t))),(typeof Reflect>"u"?S:Reflect.ownKeys)(e).forEach(function(n){it(t,n,e[n])})}var Q=Object.defineProperty;function it(t,e,n,r){Q(t,e,$(n&&N(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function H(t){return{from:function(e){return t.prototype=Object.create(e.prototype),it(t.prototype,"constructor",t),{extend:nt.bind(null,t.prototype)}}}}var Y=Object.getOwnPropertyDescriptor,st=[].slice;function wt(t,e,n){return st.call(t,e,n)}function _t(t,e){return e(t)}function ut(t){if(!t)throw new Error("Assertion Failed")}function tt(t){T.setImmediate?setImmediate(t):setTimeout(t,0)}function bt(t,e){if(typeof e=="string"&&N(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],r=0,a=e.length;r<a;++r){var i=bt(t,e[r]);n.push(i)}return n}var o,s=e.indexOf(".");return s===-1||(o=t[e.substr(0,s)])==null?void 0:bt(o,e.substr(s+1))}function ct(t,e,n){if(t&&e!==void 0&&!("isFrozen"in Object&&Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){ut(typeof n!="string"&&"length"in n);for(var r=0,a=e.length;r<a;++r)ct(t,e[r],n[r])}else{var i,o,s=e.indexOf(".");s!==-1?(i=e.substr(0,s),(s=e.substr(s+1))===""?n===void 0?D(t)&&!isNaN(parseInt(i))?t.splice(i,1):delete t[i]:t[i]=n:ct(o=(o=t[i])&&N(t,i)?o:t[i]={},s,n)):n===void 0?D(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function ft(t){var e,n={};for(e in t)N(t,e)&&(n[e]=t[e]);return n}var pa=[].concat;function ur(t){return pa.apply([],t)}var $t="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ur([8,16,32,64].map(function(t){return["Int","Uint","Float"].map(function(e){return e+t+"Array"})}))).filter(function(t){return T[t]}),cr=new Set($t.map(function(t){return T[t]})),ve=null;function Ut(t){return ve=new WeakMap,t=function e(n){if(!n||typeof n!="object")return n;var r=ve.get(n);if(r)return r;if(D(n)){r=[],ve.set(n,r);for(var a=0,i=n.length;a<i;++a)r.push(e(n[a]))}else if(cr.has(n.constructor))r=n;else{var o,s=R(n);for(o in r=s===Object.prototype?{}:Object.create(s),ve.set(n,r),n)N(n,o)&&(r[o]=e(n[o]))}return r}(t),ve=null,t}var ha={}.toString;function pn(t){return ha.call(t).slice(8,-1)}var hn=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ma=typeof hn=="symbol"?function(t){var e;return t!=null&&(e=t[hn])&&e.apply(t)}:function(){return null};function Vt(t,e){e=t.indexOf(e),0<=e&&t.splice(e,1)}var re={};function Ct(t){var e,n,r,a;if(arguments.length===1){if(D(t))return t.slice();if(this===re&&typeof t=="string")return[t];if(a=ma(t))for(n=[];!(r=a.next()).done;)n.push(r.value);else{if(t==null)return[t];if(typeof(e=t.length)!="number")return[t];for(n=new Array(e);e--;)n[e]=t[e]}}else for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}var mn=typeof Symbol<"u"?function(t){return t[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},$t=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],St=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat($t),ya={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ae(t,e){this.name=t,this.message=e}function lr(t,e){return t+". Errors: "+Object.keys(e).map(function(n){return e[n].toString()}).filter(function(n,r,a){return a.indexOf(n)===r}).join(`
`)}function $e(t,e,n,r){this.failures=e,this.failedKeys=r,this.successCount=n,this.message=lr(t,e)}function ie(t,e){this.name="BulkError",this.failures=Object.keys(e).map(function(n){return e[n]}),this.failuresByPos=e,this.message=lr(t,this.failures)}H(ae).from(Error).extend({toString:function(){return this.name+": "+this.message}}),H($e).from(ae),H(ie).from(ae);var yn=St.reduce(function(t,e){return t[e]=e+"Error",t},{}),va=ae,B=St.reduce(function(t,e){var n=e+"Error";function r(a,i){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(i?`
 `+i:""),this.inner=i||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=ya[e]||n,this.inner=null)}return H(r).from(va),t[e]=r,t},{}),dr=(B.Syntax=SyntaxError,B.Type=TypeError,B.Range=RangeError,$t.reduce(function(t,e){return t[e+"Error"]=B[e],t},{}));$t=St.reduce(function(t,e){return["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=B[e]),t},{});function et(){}function ge(t){return t}function ga(t,e){return t==null||t===ge?e:function(n){return e(t(n))}}function zt(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function ba(t,e){return t===et?e:function(){var n=t.apply(this,arguments),r=(n!==void 0&&(arguments[0]=n),this.onsuccess),a=this.onerror,i=(this.onsuccess=null,this.onerror=null,e.apply(this,arguments));return r&&(this.onsuccess=this.onsuccess?zt(r,this.onsuccess):r),a&&(this.onerror=this.onerror?zt(a,this.onerror):a),i!==void 0?i:n}}function wa(t,e){return t===et?e:function(){t.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?zt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?zt(r,this.onerror):r)}}function _a(t,e){return t===et?e:function(a){var r=t.apply(this,arguments),a=($(a,r),this.onsuccess),i=this.onerror,o=(this.onsuccess=null,this.onerror=null,e.apply(this,arguments));return a&&(this.onsuccess=this.onsuccess?zt(a,this.onsuccess):a),i&&(this.onerror=this.onerror?zt(i,this.onerror):i),r===void 0?o===void 0?void 0:o:$(r,o)}}function ka(t,e){return t===et?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function vn(t,e){return t===et?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,a=arguments.length,i=new Array(a);a--;)i[a]=arguments[a];return n.then(function(){return e.apply(r,i)})}return e.apply(this,arguments)}}$t.ModifyError=$e,$t.DexieError=ae,$t.BulkError=ie;var Ot=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function fr(t){Ot=t}var be={},pr=100,we=typeof Promise>"u"?[]:(St=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[we=crypto.subtle.digest("SHA-512",new Uint8Array([0])),R(we),St]:[St,R(St),St]),St=we[0],pe=we[1],pe=pe&&pe.then,Ht=St&&St.constructor,gn=!!we[2],_e=function(t,e){ke.push([t,e]),Ke&&(queueMicrotask(Sa),Ke=!1)},bn=!0,Ke=!0,Yt=[],je=[],wn=ge,qt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:et,pgp:!1,env:{},finalize:et},M=qt,ke=[],Gt=0,Le=[];function K(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var e=this._PSD=M;if(typeof t!="function"){if(t!==be)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&kn(this,this._value)}else this._state=null,this._value=null,++e.ref,function n(r,a){try{a(function(i){if(r._state===null){if(i===r)throw new TypeError("A promise cannot be resolved with itself.");var o=r._lib&&oe();i&&typeof i.then=="function"?n(r,function(s,f){i instanceof K?i._then(s,f):i.then(s,f)}):(r._state=!0,r._value=i,mr(r)),o&&se()}},kn.bind(null,r))}catch(i){kn(r,i)}}(this,t)}var _n={get:function(){var t=M,e=Be;function n(r,a){var i=this,o=!t.global&&(t!==M||e!==Be),s=o&&!Mt(),f=new K(function(w,p){xn(i,new hr(vr(r,t,o,s),vr(a,t,o,s),w,p,t))});return this._consoleTask&&(f._consoleTask=this._consoleTask),f}return n.prototype=be,n},set:function(t){it(this,"then",t&&t.prototype===be?_n:{get:function(){return t},set:_n.set})}};function hr(t,e,n,r,a){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=r,this.psd=a}function kn(t,e){var n,r;je.push(e),t._state===null&&(n=t._lib&&oe(),e=wn(e),t._state=!1,t._value=e,r=t,Yt.some(function(a){return a._value===r._value})||Yt.push(r),mr(t),n)&&se()}function mr(t){var e=t._listeners;t._listeners=[];for(var n=0,r=e.length;n<r;++n)xn(t,e[n]);var a=t._PSD;--a.ref||a.finalize(),Gt===0&&(++Gt,_e(function(){--Gt==0&&Sn()},[]))}function xn(t,e){if(t._state===null)t._listeners.push(e);else{var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Gt,_e(xa,[n,t,e])}}function xa(t,e,n){try{var r,a=e._value;!e._state&&je.length&&(je=[]),r=Ot&&e._consoleTask?e._consoleTask.run(function(){return t(a)}):t(a),e._state||je.indexOf(a)!==-1||(i=>{for(var o=Yt.length;o;)if(Yt[--o]._value===i._value)return Yt.splice(o,1)})(e),n.resolve(r)}catch(i){n.reject(i)}finally{--Gt==0&&Sn(),--n.psd.ref||n.psd.finalize()}}function Sa(){Qt(qt,function(){oe()&&se()})}function oe(){var t=bn;return Ke=bn=!1,t}function se(){var t,e,n;do for(;0<ke.length;)for(t=ke,ke=[],n=t.length,e=0;e<n;++e){var r=t[e];r[0].apply(null,r[1])}while(0<ke.length);Ke=bn=!0}function Sn(){for(var t=Yt,e=(Yt=[],t.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)}),Le.slice(0)),n=e.length;n;)e[--n]()}function qe(t){return new K(be,!1,t)}function ot(t,e){var n=M;return function(){var r=oe(),a=M;try{return Bt(n,!0),t.apply(this,arguments)}catch(i){e&&e(i)}finally{Bt(a,!1),r&&se()}}}nt(K.prototype,{then:_n,_then:function(t,e){xn(this,new hr(null,null,t,e,M))},catch:function(t){var e,n;return arguments.length===1?this.then(null,t):(e=t,n=arguments[1],typeof e=="function"?this.then(null,function(r){return(r instanceof e?n:qe)(r)}):this.then(null,function(r){return(r&&r.name===e?n:qe)(r)}))},finally:function(t){return this.then(function(e){return K.resolve(t()).then(function(){return e})},function(e){return K.resolve(t()).then(function(){return qe(e)})})},timeout:function(t,e){var n=this;return t<1/0?new K(function(r,a){var i=setTimeout(function(){return a(new B.Timeout(e))},t);n.then(r,a).finally(clearTimeout.bind(null,i))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&it(K.prototype,Symbol.toStringTag,"Dexie.Promise"),qt.env=yr(),nt(K,{all:function(){var t=Ct.apply(null,arguments).map(Ne);return new K(function(e,n){t.length===0&&e([]);var r=t.length;t.forEach(function(a,i){return K.resolve(a).then(function(o){t[i]=o,--r||e(t)},n)})})},resolve:function(t){return t instanceof K?t:t&&typeof t.then=="function"?new K(function(e,n){t.then(e,n)}):new K(be,!0,t)},reject:qe,race:function(){var t=Ct.apply(null,arguments).map(Ne);return new K(function(e,n){t.map(function(r){return K.resolve(r).then(e,n)})})},PSD:{get:function(){return M},set:function(t){return M=t}},totalEchoes:{get:function(){return Be}},newPSD:Rt,usePSD:Qt,scheduler:{get:function(){return _e},set:function(t){_e=t}},rejectionMapper:{get:function(){return wn},set:function(t){wn=t}},follow:function(t,e){return new K(function(n,r){return Rt(function(a,i){var o=M;o.unhandleds=[],o.onunhandled=i,o.finalize=zt(function(){var s,f=this;s=function(){f.unhandleds.length===0?a():i(f.unhandleds[0])},Le.push(function w(){s(),Le.splice(Le.indexOf(w),1)}),++Gt,_e(function(){--Gt==0&&Sn()},[])},o.finalize),t()},e,n,r)})}}),Ht&&(Ht.allSettled&&it(K,"allSettled",function(){var t=Ct.apply(null,arguments).map(Ne);return new K(function(e){t.length===0&&e([]);var n=t.length,r=new Array(n);t.forEach(function(a,i){return K.resolve(a).then(function(o){return r[i]={status:"fulfilled",value:o}},function(o){return r[i]={status:"rejected",reason:o}}).then(function(){return--n||e(r)})})})}),Ht.any&&typeof AggregateError<"u"&&it(K,"any",function(){var t=Ct.apply(null,arguments).map(Ne);return new K(function(e,n){t.length===0&&n(new AggregateError([]));var r=t.length,a=new Array(r);t.forEach(function(i,o){return K.resolve(i).then(function(s){return e(s)},function(s){a[o]=s,--r||n(new AggregateError(a))})})})}),Ht.withResolvers)&&(K.withResolvers=Ht.withResolvers);var vt={awaits:0,echoes:0,id:0},Ea=0,Re=[],Me=0,Be=0,Ta=0;function Rt(t,o,n,r){var a=M,i=Object.create(a),o=(i.parent=a,i.ref=0,i.global=!1,i.id=++Ta,qt.env,i.env=gn?{Promise:K,PromiseProp:{value:K,configurable:!0,writable:!0},all:K.all,race:K.race,allSettled:K.allSettled,any:K.any,resolve:K.resolve,reject:K.reject}:{},o&&$(i,o),++a.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()},Qt(i,t,n,r));return i.ref===0&&i.finalize(),o}function ue(){return vt.id||(vt.id=++Ea),++vt.awaits,vt.echoes+=pr,vt.id}function Mt(){return!!vt.awaits&&(--vt.awaits==0&&(vt.id=0),vt.echoes=vt.awaits*pr,!0)}function Ne(t){return vt.echoes&&t&&t.constructor===Ht?(ue(),t.then(function(e){return Mt(),e},function(e){return Mt(),ht(e)})):t}function Da(){var t=Re[Re.length-1];Re.pop(),Bt(t,!1)}function Bt(t,e){var n,r,a=M;(e?!vt.echoes||Me++&&t===M:!Me||--Me&&t===M)||queueMicrotask(e?(function(i){++Be,vt.echoes&&--vt.echoes!=0||(vt.echoes=vt.awaits=vt.id=0),Re.push(M),Bt(i,!0)}).bind(null,t):Da),t!==M&&(M=t,a===qt&&(qt.env=yr()),gn)&&(n=qt.env.Promise,r=t.env,a.global||t.global)&&(Object.defineProperty(T,"Promise",r.PromiseProp),n.all=r.all,n.race=r.race,n.resolve=r.resolve,n.reject=r.reject,r.allSettled&&(n.allSettled=r.allSettled),r.any)&&(n.any=r.any)}function yr(){var t=T.Promise;return gn?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(T,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject}:{}}function Qt(t,e,n,r,a){var i=M;try{return Bt(t,!0),e(n,r,a)}finally{Bt(i,!1)}}function vr(t,e,n,r){return typeof t!="function"?t:function(){var a=M;n&&ue(),Bt(e,!0);try{return t.apply(this,arguments)}finally{Bt(a,!1),r&&queueMicrotask(Mt)}}}function En(t){Promise===Ht&&vt.echoes===0?Me===0?t():enqueueNativeMicroTask(t):setTimeout(t,0)}(""+pe).indexOf("[native code]")===-1&&(ue=Mt=et);var ht=K.reject,Xt="ï¿¿",Kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",gr="String expected.",ce=[],Fe="__dbnames",Tn="readonly",Dn="readwrite";function Jt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var br={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function We(t){return typeof t!="string"||/\./.test(t)?function(e){return e}:function(e){return e[t]===void 0&&t in e&&delete(e=Ut(e))[t],e}}function wr(){throw B.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function G(t,e){try{var n=_r(t),r=_r(e);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e<t?1:t<e?-1:0;case"binary":for(var a=kr(t),i=kr(e),o=a.length,s=i.length,f=o<s?o:s,w=0;w<f;++w)if(a[w]!==i[w])return a[w]<i[w]?-1:1;return o===s?0:o<s?-1:1;case"Array":for(var p=t,l=e,m=p.length,y=l.length,h=m<y?m:y,d=0;d<h;++d){var _=G(p[d],l[d]);if(_!==0)return _}return m===y?0:m<y?-1:1}}catch{}return NaN}function _r(t){var e=typeof t;return e=="object"&&(ArrayBuffer.isView(t)||(e=pn(t))==="ArrayBuffer")?"binary":e}function kr(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}function Ue(t,e,n){var r=t.schema.yProps;return r?(e&&0<n.numFailures&&(e=e.filter(function(a,i){return!n.failures[i]})),Promise.all(r.map(function(a){return a=a.updatesTable,e?t.db.table(a).where("k").anyOf(e).delete():t.db.table(a).clear()})).then(function(){return n})):n}xr.prototype.execute=function(t){var e=this["@@propmod"];if(e.add!==void 0){var n=e.add;if(D(n))return x(x([],D(t)?t:[],!0),n).sort();if(typeof n=="number")return(Number(t)||0)+n;if(typeof n=="bigint")try{return BigInt(t)+n}catch{return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(e.remove!==void 0){var r=e.remove;if(D(r))return D(t)?t.filter(function(a){return!r.includes(a)}).sort():[];if(typeof r=="number")return Number(t)-r;if(typeof r=="bigint")try{return BigInt(t)-r}catch{return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}return n=(n=e.replacePrefix)==null?void 0:n[0],n&&typeof t=="string"&&t.startsWith(n)?e.replacePrefix[1]+t.substring(n.length):t};var xe=xr;function xr(t){this["@@propmod"]=t}function Sr(t,e){for(var n=S(e),r=n.length,a=!1,i=0;i<r;++i){var o=n[i],s=e[o],f=bt(t,o);s instanceof xe?(ct(t,o,s.execute(f)),a=!0):f!==s&&(ct(t,o,s),a=!0)}return a}rt.prototype._trans=function(t,e,n){var r=this._tx||M.trans,a=this.name,i=Ot&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function o(w,p,l){if(l.schema[a])return e(l.idbtrans,l);throw new B.NotFound("Table "+a+" not part of transaction")}var s=oe();try{var f=r&&r.db._novip===this.db._novip?r===M.trans?r._promise(t,o,n):Rt(function(){return r._promise(t,o,n)},{trans:r,transless:M.transless||M}):function w(p,l,m,y){if(p.idbdb&&(p._state.openComplete||M.letThrough||p._vip)){var h=p._createTransaction(l,m,p._dbSchema);try{h.create(),p._state.PR1398_maxLoop=3}catch(d){return d.name===yn.InvalidState&&p.isOpen()&&0<--p._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),p.close({disableAutoOpen:!1}),p.open().then(function(){return w(p,l,m,y)})):ht(d)}return h._promise(l,function(d,_){return Rt(function(){return M.trans=h,y(d,_,h)})}).then(function(d){if(l==="readwrite")try{h.idbtrans.commit()}catch{}return l==="readonly"?d:h._completion.then(function(){return d})})}if(p._state.openComplete)return ht(new B.DatabaseClosed(p._state.dbOpenError));if(!p._state.isBeingOpened){if(!p._state.autoOpen)return ht(new B.DatabaseClosed);p.open().catch(et)}return p._state.dbReadyPromise.then(function(){return w(p,l,m,y)})}(this.db,t,[this.name],o);return i&&(f._consoleTask=i,f=f.catch(function(w){return console.trace(w),ht(w)})),f}finally{s&&se()}},rt.prototype.get=function(t,e){var n=this;return t&&t.constructor===Object?this.where(t).first(e):t==null?ht(new B.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:t}).then(function(a){return n.hook.reading.fire(a)})}).then(e)},rt.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(D(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var e=S(t);if(e.length===1)return this.where(e[0]).equals(t[e[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(s){if(s.compound&&e.every(function(w){return 0<=s.keyPath.indexOf(w)})){for(var f=0;f<e.length;++f)if(e.indexOf(s.keyPath[f])===-1)return!1;return!0}return!1}).sort(function(s,f){return s.keyPath.length-f.keyPath.length})[0];if(n&&this.db._maxKey!==Xt)return o=n.keyPath.slice(0,e.length),this.where(o).equals(o.map(function(s){return t[s]}));!n&&Ot&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(e.join("+"),"]"));var r=this.schema.idxByName;function a(s,f){return G(s,f)===0}var o=e.reduce(function(p,f){var w=p[0],p=p[1],l=r[f],m=t[f];return[w||l,w||!l?Jt(p,l&&l.multi?function(y){return y=bt(y,f),D(y)&&y.some(function(h){return a(m,h)})}:function(y){return a(m,bt(y,f))}):p]},[null,null]),i=o[0],o=o[1];return i?this.where(i.name).equals(t[i.keyPath]).filter(o):n?this.filter(o):this.where(e).equals("")},rt.prototype.filter=function(t){return this.toCollection().and(t)},rt.prototype.count=function(t){return this.toCollection().count(t)},rt.prototype.offset=function(t){return this.toCollection().offset(t)},rt.prototype.limit=function(t){return this.toCollection().limit(t)},rt.prototype.each=function(t){return this.toCollection().each(t)},rt.prototype.toArray=function(t){return this.toCollection().toArray(t)},rt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},rt.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,D(t)?"[".concat(t.join("+"),"]"):t))},rt.prototype.reverse=function(){return this.toCollection().reverse()},rt.prototype.mapToClass=function(t){for(var e=this.db,n=this.name,r=((this.schema.mappedClass=t).prototype instanceof wr&&(t=(o=>{var s=p,f=o;if(typeof f!="function"&&f!==null)throw new TypeError("Class extends value "+String(f)+" is not a constructor or null");function w(){this.constructor=s}function p(){return o!==null&&o.apply(this,arguments)||this}return c(s,f),s.prototype=f===null?Object.create(f):(w.prototype=f.prototype,new w),Object.defineProperty(p.prototype,"db",{get:function(){return e},enumerable:!1,configurable:!0}),p.prototype.table=function(){return n},p})(t)),new Set),a=t.prototype;a;a=R(a))Object.getOwnPropertyNames(a).forEach(function(o){return r.add(o)});function i(o){if(!o)return o;var s,f=Object.create(t.prototype);for(s in o)if(!r.has(s))try{f[s]=o[s]}catch{}return f}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=i,this.hook("reading",i),t},rt.prototype.defineClass=function(){return this.mapToClass(function(t){$(this,t)})},rt.prototype.add=function(t,e){var n=this,r=this.schema.primKey,a=r.auto,i=r.keyPath,o=t;return i&&a&&(o=We(i)(t)),this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"add",keys:e!=null?[e]:null,values:[o]})}).then(function(s){return s.numFailures?K.reject(s.failures[0]):s.lastResult}).then(function(s){if(i)try{ct(t,i,s)}catch{}return s})},rt.prototype.upsert=function(t,e){var n=this,r=this.schema.primKey.keyPath;return this._trans("readwrite",function(a){return n.core.get({trans:a,key:t}).then(function(i){var o=i??{};return Sr(o,e),r&&ct(o,r,t),n.core.mutate({trans:a,type:"put",values:[o],keys:[t],upsert:!0,updates:{keys:[t],changeSpecs:[e]}}).then(function(s){return s.numFailures?K.reject(s.failures[0]):!!i})})})},rt.prototype.update=function(t,e){return typeof t!="object"||D(t)?this.where(":id").equals(t).modify(e):(t=bt(t,this.schema.primKey.keyPath))===void 0?ht(new B.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(t).modify(e)},rt.prototype.put=function(t,e){var n=this,r=this.schema.primKey,a=r.auto,i=r.keyPath,o=t;return i&&a&&(o=We(i)(t)),this._trans("readwrite",function(s){return n.core.mutate({trans:s,type:"put",values:[o],keys:e!=null?[e]:null})}).then(function(s){return s.numFailures?K.reject(s.failures[0]):s.lastResult}).then(function(s){if(i)try{ct(t,i,s)}catch{}return s})},rt.prototype.delete=function(t){var e=this;return this._trans("readwrite",function(n){return e.core.mutate({trans:n,type:"delete",keys:[t]}).then(function(r){return Ue(e,[t],r)}).then(function(r){return r.numFailures?K.reject(r.failures[0]):void 0})})},rt.prototype.clear=function(){var t=this;return this._trans("readwrite",function(e){return t.core.mutate({trans:e,type:"deleteRange",range:br}).then(function(n){return Ue(t,null,n)})}).then(function(e){return e.numFailures?K.reject(e.failures[0]):void 0})},rt.prototype.bulkGet=function(t){var e=this;return this._trans("readonly",function(n){return e.core.getMany({keys:t,trans:n}).then(function(r){return r.map(function(a){return e.hook.reading.fire(a)})})})},rt.prototype.bulkAdd=function(t,e,n){var r=this,a=Array.isArray(e)?e:void 0,i=(n=n||(a?void 0:e))?n.allKeys:void 0;return this._trans("readwrite",function(o){var s=r.schema.primKey,w=s.auto,s=s.keyPath;if(s&&a)throw new B.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var f=t.length,w=s&&w?t.map(We(s)):t;return r.core.mutate({trans:o,type:"add",keys:a,values:w,wantResults:i}).then(function(p){var l=p.numFailures,m=p.failures;if(l===0)return i?p.results:p.lastResult;throw new ie("".concat(r.name,".bulkAdd(): ").concat(l," of ").concat(f," operations failed"),m)})})},rt.prototype.bulkPut=function(t,e,n){var r=this,a=Array.isArray(e)?e:void 0,i=(n=n||(a?void 0:e))?n.allKeys:void 0;return this._trans("readwrite",function(o){var s=r.schema.primKey,w=s.auto,s=s.keyPath;if(s&&a)throw new B.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var f=t.length,w=s&&w?t.map(We(s)):t;return r.core.mutate({trans:o,type:"put",keys:a,values:w,wantResults:i}).then(function(p){var l=p.numFailures,m=p.failures;if(l===0)return i?p.results:p.lastResult;throw new ie("".concat(r.name,".bulkPut(): ").concat(l," of ").concat(f," operations failed"),m)})})},rt.prototype.bulkUpdate=function(t){var e=this,n=this.core,r=t.map(function(o){return o.key}),a=t.map(function(o){return o.changes}),i=[];return this._trans("readwrite",function(o){return n.getMany({trans:o,keys:r,cache:"clone"}).then(function(s){var f=[],w=[],p=(t.forEach(function(l,m){var y=l.key,h=l.changes,d=s[m];if(d){for(var _=0,k=Object.keys(h);_<k.length;_++){var b=k[_],E=h[b];if(b===e.schema.primKey.keyPath){if(G(E,y)!==0)throw new B.Constraint("Cannot update primary key in bulkUpdate()")}else ct(d,b,E)}i.push(m),f.push(y),w.push(d)}}),f.length);return n.mutate({trans:o,type:"put",keys:f,values:w,updates:{keys:r,changeSpecs:a}}).then(function(l){var m=l.numFailures,y=l.failures;if(m===0)return p;for(var h=0,d=Object.keys(y);h<d.length;h++){var _,k=d[h],b=i[Number(k)];b!=null&&(_=y[k],delete y[k],y[b]=_)}throw new ie("".concat(e.name,".bulkUpdate(): ").concat(m," of ").concat(p," operations failed"),y)})})})},rt.prototype.bulkDelete=function(t){var e=this,n=t.length;return this._trans("readwrite",function(r){return e.core.mutate({trans:r,type:"delete",keys:t}).then(function(a){return Ue(e,t,a)})}).then(function(r){var a=r.numFailures,i=r.failures;if(a===0)return r.lastResult;throw new ie("".concat(e.name,".bulkDelete(): ").concat(a," of ").concat(n," operations failed"),i)})};var Er=rt;function rt(){}function Se(t){function e(o,s){if(s){for(var f=arguments.length,w=new Array(f-1);--f;)w[f-1]=arguments[f];return n[o].subscribe.apply(null,w),t}if(typeof o=="string")return n[o]}var n={};e.addEventType=i;for(var r=1,a=arguments.length;r<a;++r)i(arguments[r]);return e;function i(o,s,f){var w,p;if(typeof o!="object")return s=s||ka,p={subscribers:[],fire:f=f||et,subscribe:function(l){p.subscribers.indexOf(l)===-1&&(p.subscribers.push(l),p.fire=s(p.fire,l))},unsubscribe:function(l){p.subscribers=p.subscribers.filter(function(m){return m!==l}),p.fire=p.subscribers.reduce(s,f)}},n[o]=e[o]=p;S(w=o).forEach(function(l){var m=w[l];if(D(m))i(l,w[l][0],w[l][1]);else{if(m!=="asap")throw new B.InvalidArgument("Invalid event config");var y=i(l,ge,function(){for(var h=arguments.length,d=new Array(h);h--;)d[h]=arguments[h];y.subscribers.forEach(function(_){tt(function(){_.apply(null,d)})})})}})}}function Ee(t,e){return H(e).from({prototype:t}),e}function le(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function In(t,e){t.filter=Jt(t.filter,e)}function On(t,e,n){var r=t.replayFilter;t.replayFilter=r?function(){return Jt(r(),e())}:e,t.justLimit=n&&!r}function Ve(t,e){if(t.isPrimKey)return e.primaryKey;var n=e.getIndexByKeyPath(t.index);if(n)return n;throw new B.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed")}function Tr(t,e,n){var r=Ve(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:r,range:t.range}})}function ze(t,e,n,r){var a,i,o=t.replayFilter?Jt(t.filter,t.replayFilter()):t.filter;return t.or?(a={},i=function(s,f,w){var p,l;o&&!o(f,w,function(m){return f.stop(m)},function(m){return f.fail(m)})||((l=""+(p=f.primaryKey))=="[object ArrayBuffer]"&&(l=""+new Uint8Array(p)),N(a,l))||(a[l]=!0,e(s,f,w))},Promise.all([t.or._iterate(i,n),Dr(Tr(t,r,n),t.algorithm,i,!t.keysOnly&&t.valueMapper)])):Dr(Tr(t,r,n),Jt(t.algorithm,o),e,!t.keysOnly&&t.valueMapper)}function Dr(t,e,n,r){var a=ot(r?function(i,o,s){return n(r(i),o,s)}:n);return t.then(function(i){if(i)return i.start(function(){var o=function(){return i.continue()};e&&!e(i,function(s){return o=s},function(s){i.stop(s),o=et},function(s){i.fail(s),o=et})||a(i.value,i,function(s){return o=s}),o()})})}J.prototype._read=function(t,e){var n=this._ctx;return n.error?n.table._trans(null,ht.bind(null,n.error)):n.table._trans("readonly",t).then(e)},J.prototype._write=function(t){var e=this._ctx;return e.error?e.table._trans(null,ht.bind(null,e.error)):e.table._trans("readwrite",t,"locked")},J.prototype._addAlgorithm=function(t){var e=this._ctx;e.algorithm=Jt(e.algorithm,t)},J.prototype._iterate=function(t,e){return ze(this._ctx,t,e,this._ctx.table.core)},J.prototype.clone=function(t){var e=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&$(n,t),e._ctx=n,e},J.prototype.raw=function(){return this._ctx.valueMapper=null,this},J.prototype.each=function(t){var e=this._ctx;return this._read(function(n){return ze(e,t,n,e.table.core)})},J.prototype.count=function(t){var e=this;return this._read(function(n){var r,a=e._ctx,i=a.table.core;return le(a,!0)?i.count({trans:n,query:{index:Ve(a,i.schema),range:a.range}}).then(function(o){return Math.min(o,a.limit)}):(r=0,ze(a,function(){return++r,!1},n,i).then(function(){return r}))}).then(t)},J.prototype.sortBy=function(t,e){var n=t.split(".").reverse(),r=n[0],a=n.length-1;function i(f,w){return w?i(f[n[w]],w-1):f[r]}var o=this._ctx.dir==="next"?1:-1;function s(f,w){return G(i(f,a),i(w,a))*o}return this.toArray(function(f){return f.sort(s)}).then(e)},J.prototype.toArray=function(t){var e=this;return this._read(function(n){var r,a,i,o=e._ctx;return o.dir==="next"&&le(o,!0)&&0<o.limit?(r=o.valueMapper,a=Ve(o,o.table.core.schema),o.table.core.query({trans:n,limit:o.limit,values:!0,query:{index:a,range:o.range}}).then(function(s){return s=s.result,r?s.map(r):s})):(i=[],ze(o,function(s){return i.push(s)},n,o.table.core).then(function(){return i}))},t)},J.prototype.offset=function(t){var e=this._ctx;return t<=0||(e.offset+=t,le(e)?On(e,function(){var n=t;return function(r,a){return n===0||(n===1?--n:a(function(){r.advance(n),n=0}),!1)}}):On(e,function(){var n=t;return function(){return--n<0}})),this},J.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),On(this._ctx,function(){var e=t;return function(n,r,a){return--e<=0&&r(a),0<=e}},!0),this},J.prototype.until=function(t,e){return In(this._ctx,function(n,r,a){return!t(n.value)||(r(a),e)}),this},J.prototype.first=function(t){return this.limit(1).toArray(function(e){return e[0]}).then(t)},J.prototype.last=function(t){return this.reverse().first(t)},J.prototype.filter=function(t){var e;return In(this._ctx,function(n){return t(n.value)}),(e=this._ctx).isMatch=Jt(e.isMatch,t),this},J.prototype.and=function(t){return this.filter(t)},J.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},J.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},J.prototype.desc=function(){return this.reverse()},J.prototype.eachKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(n,r){t(r.key,r)})},J.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},J.prototype.eachPrimaryKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each(function(n,r){t(r.primaryKey,r)})},J.prototype.keys=function(t){var e=this._ctx,n=(e.keysOnly=!e.isMatch,[]);return this.each(function(r,a){n.push(a.key)}).then(function(){return n}).then(t)},J.prototype.primaryKeys=function(t){var e=this._ctx;if(e.dir==="next"&&le(e,!0)&&0<e.limit)return this._read(function(r){var a=Ve(e,e.table.core.schema);return e.table.core.query({trans:r,values:!1,limit:e.limit,query:{index:a,range:e.range}})}).then(function(r){return r.result}).then(t);e.keysOnly=!e.isMatch;var n=[];return this.each(function(r,a){n.push(a.primaryKey)}).then(function(){return n}).then(t)},J.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},J.prototype.firstKey=function(t){return this.limit(1).keys(function(e){return e[0]}).then(t)},J.prototype.lastKey=function(t){return this.reverse().firstKey(t)},J.prototype.distinct=function(){var t,e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];return e&&e.multi&&(t={},In(this._ctx,function(r){var r=r.primaryKey.toString(),a=N(t,r);return t[r]=!0,!a})),this},J.prototype.modify=function(t){var e=this,n=this._ctx;return this._write(function(r){function a(d,_){var k=_.failures;m+=d-_.numFailures;for(var b=0,E=S(k);b<E.length;b++){var I=E[b];l.push(k[I])}}var i=typeof t=="function"?t:function(d){return Sr(d,t)},o=n.table.core,p=o.schema.primaryKey,s=p.outbound,f=p.extractKey,w=200,p=e.db._options.modifyChunkSize,l=(p&&(w=typeof p=="object"?p[o.name]||p["*"]||200:p),[]),m=0,y=[],h=t===Ir;return e.clone().primaryKeys().then(function(d){function _(b){var E=Math.min(w,d.length-b),I=d.slice(b,b+E);return(h?Promise.resolve([]):o.getMany({trans:r,keys:I,cache:"immutable"})).then(function(P){var C=[],O=[],L=s?[]:null,j=h?I:[];if(!h)for(var A=0;A<E;++A){var q=P[A],X={value:Ut(q),primKey:d[b+A]};i.call(X,X.value,X)!==!1&&(X.value==null?j.push(d[b+A]):s||G(f(q),f(X.value))===0?(O.push(X.value),s&&L.push(d[b+A])):(j.push(d[b+A]),C.push(X.value)))}return Promise.resolve(0<C.length&&o.mutate({trans:r,type:"add",values:C}).then(function(Z){for(var F in Z.failures)j.splice(parseInt(F),1);a(C.length,Z)})).then(function(){return(0<O.length||k&&typeof t=="object")&&o.mutate({trans:r,type:"put",keys:L,values:O,criteria:k,changeSpec:typeof t!="function"&&t,isAdditionalChunk:0<b}).then(function(Z){return a(O.length,Z)})}).then(function(){return(0<j.length||k&&h)&&o.mutate({trans:r,type:"delete",keys:j,criteria:k,isAdditionalChunk:0<b}).then(function(Z){return Ue(n.table,j,Z)}).then(function(Z){return a(j.length,Z)})}).then(function(){return d.length>b+E&&_(b+w)})})}var k=le(n)&&n.limit===1/0&&(typeof t!="function"||h)&&{index:n.index,range:n.range};return _(0).then(function(){if(0<l.length)throw new $e("Error modifying one or more objects",l,m,y);return d.length})})})},J.prototype.delete=function(){var t=this._ctx,e=t.range;return!le(t)||t.table.schema.yProps||!t.isPrimKey&&e.type!==3?this.modify(Ir):this._write(function(n){var r=t.table.core.schema.primaryKey,a=e;return t.table.core.count({trans:n,query:{index:r,range:a}}).then(function(i){return t.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(function(f){var s=f.failures,f=f.numFailures;if(f)throw new $e("Could not delete some values",Object.keys(s).map(function(w){return s[w]}),i-f);return i-f})})})};var Ia=J;function J(){}var Ir=function(t,e){return e.value=null};function Oa(t,e){return t<e?-1:t===e?0:1}function Aa(t,e){return e<t?-1:t===e?0:1}function Et(t,e,n){return t=t instanceof Ar?new t.Collection(t):t,t._ctx.error=new(n||TypeError)(e),t}function de(t){return new t.Collection(t,function(){return Or("")}).limit(0)}function He(y,e,n,r){var a,i,o,s,f,w,p,l=n.length;if(!n.every(function(d){return typeof d=="string"}))return Et(y,gr);function m(d){a=d==="next"?function(k){return k.toUpperCase()}:function(k){return k.toLowerCase()},i=d==="next"?function(k){return k.toLowerCase()}:function(k){return k.toUpperCase()},o=d==="next"?Oa:Aa;var _=n.map(function(k){return{lower:i(k),upper:a(k)}}).sort(function(k,b){return o(k.lower,b.lower)});s=_.map(function(k){return k.upper}),f=_.map(function(k){return k.lower}),p=(w=d)==="next"?"":r}m("next");var y=new y.Collection(y,function(){return Nt(s[0],f[l-1]+r)}),h=(y._ondirectionchange=function(d){m(d)},0);return y._addAlgorithm(function(d,_,k){var b=d.key;if(typeof b=="string"){var E=i(b);if(e(E,f,h))return!0;for(var I=null,P=h;P<l;++P){var C=((O,L,j,A,q,X)=>{for(var Z=Math.min(O.length,A.length),F=-1,V=0;V<Z;++V){var lt=L[V];if(lt!==A[V])return q(O[V],j[V])<0?O.substr(0,V)+j[V]+j.substr(V+1):q(O[V],A[V])<0?O.substr(0,V)+A[V]+j.substr(V+1):0<=F?O.substr(0,F)+L[F]+j.substr(F+1):null;q(O[V],lt)<0&&(F=V)}return Z<A.length&&X==="next"?O+j.substr(O.length):Z<O.length&&X==="prev"?O.substr(0,j.length):F<0?null:O.substr(0,F)+A[F]+j.substr(F+1)})(b,E,s[P],f[P],o,w);C===null&&I===null?h=P+1:(I===null||0<o(I,C))&&(I=C)}_(I!==null?function(){d.continue(I+p)}:k)}return!1}),y}function Nt(t,e,n,r){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:r}}function Or(t){return{type:1,lower:t,upper:t}}Object.defineProperty(gt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),gt.prototype.between=function(t,e,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(t,e)||this._cmp(t,e)===0&&(n||r)&&(!n||!r)?de(this):new this.Collection(this,function(){return Nt(t,e,!n,!r)})}catch{return Et(this,Kt)}},gt.prototype.equals=function(t){return t==null?Et(this,Kt):new this.Collection(this,function(){return Or(t)})},gt.prototype.above=function(t){return t==null?Et(this,Kt):new this.Collection(this,function(){return Nt(t,void 0,!0)})},gt.prototype.aboveOrEqual=function(t){return t==null?Et(this,Kt):new this.Collection(this,function(){return Nt(t,void 0,!1)})},gt.prototype.below=function(t){return t==null?Et(this,Kt):new this.Collection(this,function(){return Nt(void 0,t,!1,!0)})},gt.prototype.belowOrEqual=function(t){return t==null?Et(this,Kt):new this.Collection(this,function(){return Nt(void 0,t)})},gt.prototype.startsWith=function(t){return typeof t!="string"?Et(this,gr):this.between(t,t+Xt,!0,!0)},gt.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):He(this,function(e,n){return e.indexOf(n[0])===0},[t],Xt)},gt.prototype.equalsIgnoreCase=function(t){return He(this,function(e,n){return e===n[0]},[t],"")},gt.prototype.anyOfIgnoreCase=function(){var t=Ct.apply(re,arguments);return t.length===0?de(this):He(this,function(e,n){return n.indexOf(e)!==-1},t,"")},gt.prototype.startsWithAnyOfIgnoreCase=function(){var t=Ct.apply(re,arguments);return t.length===0?de(this):He(this,function(e,n){return n.some(function(r){return e.indexOf(r)===0})},t,Xt)},gt.prototype.anyOf=function(){var t,e,n=this,r=Ct.apply(re,arguments),a=this._cmp;try{r.sort(a)}catch{return Et(this,Kt)}return r.length===0?de(this):((t=new this.Collection(this,function(){return Nt(r[0],r[r.length-1])}))._ondirectionchange=function(i){a=i==="next"?n._ascending:n._descending,r.sort(a)},e=0,t._addAlgorithm(function(i,o,s){for(var f=i.key;0<a(f,r[e]);)if(++e===r.length)return o(s),!1;return a(f,r[e])===0||(o(function(){i.continue(r[e])}),!1)}),t)},gt.prototype.notEqual=function(t){return this.inAnyRange([[-1/0,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},gt.prototype.noneOf=function(){var t=Ct.apply(re,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Et(this,Kt)}var e=t.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},gt.prototype.inAnyRange=function(t,k){var n=this,r=this._cmp,a=this._ascending,i=this._descending,o=this._min,s=this._max;if(t.length===0)return de(this);if(!t.every(function(b){return b[0]!==void 0&&b[1]!==void 0&&a(b[0],b[1])<=0}))return Et(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",B.InvalidArgument);var f=!k||k.includeLowers!==!1,w=k&&k.includeUppers===!0,p,l=a;function m(b,E){return l(b[0],E[0])}try{(p=t.reduce(function(b,E){for(var I=0,P=b.length;I<P;++I){var C=b[I];if(r(E[0],C[1])<0&&0<r(E[1],C[0])){C[0]=o(C[0],E[0]),C[1]=s(C[1],E[1]);break}}return I===P&&b.push(E),b},[])).sort(m)}catch{return Et(this,Kt)}var y=0,h=w?function(b){return 0<a(b,p[y][1])}:function(b){return 0<=a(b,p[y][1])},d=f?function(b){return 0<i(b,p[y][0])}:function(b){return 0<=i(b,p[y][0])},_=h,k=new this.Collection(this,function(){return Nt(p[0][0],p[p.length-1][1],!f,!w)});return k._ondirectionchange=function(b){l=b==="next"?(_=h,a):(_=d,i),p.sort(m)},k._addAlgorithm(function(b,E,I){for(var P,C=b.key;_(C);)if(++y===p.length)return E(I),!1;return!h(P=C)&&!d(P)||(n._cmp(C,p[y][1])===0||n._cmp(C,p[y][0])===0||E(function(){l===a?b.continue(p[y][0]):b.continue(p[y][1])}),!1)}),k},gt.prototype.startsWithAnyOf=function(){var t=Ct.apply(re,arguments);return t.every(function(e){return typeof e=="string"})?t.length===0?de(this):this.inAnyRange(t.map(function(e){return[e,e+Xt]})):Et(this,"startsWithAnyOf() only works with strings")};var Ar=gt;function gt(){}function At(t){return ot(function(e){return Te(e),t(e.target.error),!1})}function Te(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var De="storagemutated",An="x-storagemutated-1",Ft=Se(null,De),Pa=(Pt.prototype._lock=function(){return ut(!M.global),++this._reculock,this._reculock!==1||M.global||(M.lockOwnerFor=this),this},Pt.prototype._unlock=function(){if(ut(!M.global),--this._reculock==0)for(M.global||(M.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var t=this._blockedFuncs.shift();try{Qt(t[1],t[0])}catch{}}return this},Pt.prototype._locked=function(){return this._reculock&&M.lockOwnerFor!==this},Pt.prototype.create=function(t){var e=this;if(this.mode){var n=this.db.idbdb,r=this.db._state.dbOpenError;if(ut(!this.idbtrans),!t&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new B.DatabaseClosed(r);case"MissingAPIError":throw new B.MissingAPI(r.message,r);default:throw new B.OpenFailed(r)}if(!this.active)throw new B.TransactionInactive;ut(this._completion._state===null),(t=this.idbtrans=t||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=ot(function(a){Te(a),e._reject(t.error)}),t.onabort=ot(function(a){Te(a),e.active&&e._reject(new B.Abort(t.error)),e.active=!1,e.on("abort").fire(a)}),t.oncomplete=ot(function(){e.active=!1,e._resolve(),"mutatedParts"in t&&Ft.storagemutated.fire(t.mutatedParts)})}return this},Pt.prototype._promise=function(t,e,n){var r,a=this;return t==="readwrite"&&this.mode!=="readwrite"?ht(new B.ReadOnly("Transaction is readonly")):this.active?this._locked()?new K(function(i,o){a._blockedFuncs.push([function(){a._promise(t,e,n).then(i,o)},M])}):n?Rt(function(){var i=new K(function(o,s){a._lock();var f=e(o,s,a);f&&f.then&&f.then(o,s)});return i.finally(function(){return a._unlock()}),i._lib=!0,i}):((r=new K(function(i,o){var s=e(i,o,a);s&&s.then&&s.then(i,o)}))._lib=!0,r):ht(new B.TransactionInactive)},Pt.prototype._root=function(){return this.parent?this.parent._root():this},Pt.prototype.waitFor=function(t){var e,n=this._root(),r=K.resolve(t),a=(n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],e=n.idbtrans.objectStore(n.storeNames[0]),function i(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(e.get(-1/0).onsuccess=i)}()),n._waitingFor);return new K(function(i,o){r.then(function(s){return n._waitingQueue.push(ot(i.bind(null,s)))},function(s){return n._waitingQueue.push(ot(o.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},Pt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new B.Abort))},Pt.prototype.table=function(t){var e=this._memoizedTables||(this._memoizedTables={});if(N(e,t))return e[t];var n=this.schema[t];if(n)return(n=new this.db.Table(t,n,this)).core=this.db.core.table(t),e[t]=n;throw new B.NotFound("Table "+t+" not part of transaction")},Pt);function Pt(){}function Pn(t,e,n,r,a,i,o,s){return{name:t,keyPath:e,unique:n,multi:r,auto:a,compound:i,src:(n&&!o?"&":"")+(r?"*":"")+(a?"++":"")+Pr(e),type:s}}function Pr(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Cn(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:(r=function(a){return[a.name,a]},n.reduce(function(a,i,o){return i=r(i,o),i&&(a[i[0]]=i[1]),a},{}))};var r}var Ie=function(t){try{return t.only([[]]),Ie=function(){return[[]]},[[]]}catch{return Ie=function(){return Xt},Xt}};function $n(t){return t==null?function(){}:typeof t=="string"?(e=t).split(".").length===1?function(n){return n[e]}:function(n){return bt(n,e)}:function(n){return bt(n,t)};var e}function Cr(t){return[].slice.call(t)}var Ca=0;function Oe(t){return t==null?":id":typeof t=="string"?t:"[".concat(t.join("+"),"]")}function $a(t,e,f){function r(h){if(h.type===3)return null;if(h.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var l=h.lower,m=h.upper,y=h.lowerOpen,h=h.upperOpen;return l===void 0?m===void 0?null:e.upperBound(m,!!h):m===void 0?e.lowerBound(l,!!y):e.bound(l,m,!!y,!!h)}function a(p){var l,m=p.name;return{name:m,schema:p,mutate:function(y){var h=y.trans,d=y.type,_=y.keys,k=y.values,b=y.range;return new Promise(function(E,I){E=ot(E);var P=h.objectStore(m),C=P.keyPath==null,O=d==="put"||d==="add";if(!O&&d!=="delete"&&d!=="deleteRange")throw new Error("Invalid operation type: "+d);var L,j=(_||k||{length:1}).length;if(_&&k&&_.length!==k.length)throw new Error("Given keys array must have same length as given values array.");if(j===0)return E({numFailures:0,failures:{},results:[],lastResult:void 0});function A(pt){++Z,Te(pt)}var q=[],X=[],Z=0;if(d==="deleteRange"){if(b.type===4)return E({numFailures:Z,failures:X,results:[],lastResult:void 0});b.type===3?q.push(L=P.clear()):q.push(L=P.delete(r(b)))}else{var C=O?C?[k,_]:[k,null]:[_,null],F=C[0],V=C[1];if(O)for(var lt=0;lt<j;++lt)q.push(L=V&&V[lt]!==void 0?P[d](F[lt],V[lt]):P[d](F[lt])),L.onerror=A;else for(lt=0;lt<j;++lt)q.push(L=P[d](F[lt])),L.onerror=A}function Tt(pt){pt=pt.target.result,q.forEach(function(ee,Xn){return ee.error!=null&&(X[Xn]=ee.error)}),E({numFailures:Z,failures:X,results:d==="delete"?_:q.map(function(ee){return ee.result}),lastResult:pt})}L.onerror=function(pt){A(pt),Tt(pt)},L.onsuccess=Tt})},getMany:function(y){var h=y.trans,d=y.keys;return new Promise(function(_,k){_=ot(_);for(var b,E=h.objectStore(m),I=d.length,P=new Array(I),C=0,O=0,L=function(q){q=q.target,P[q._pos]=q.result,++O===C&&_(P)},j=At(k),A=0;A<I;++A)d[A]!=null&&((b=E.get(d[A]))._pos=A,b.onsuccess=L,b.onerror=j,++C);C===0&&_(P)})},get:function(y){var h=y.trans,d=y.key;return new Promise(function(_,k){_=ot(_);var b=h.objectStore(m).get(d);b.onsuccess=function(E){return _(E.target.result)},b.onerror=At(k)})},query:(l=s,function(y){return new Promise(function(h,d){h=ot(h);var _,k,b,O=y.trans,E=y.values,I=y.limit,C=y.query,P=I===1/0?void 0:I,L=C.index,C=C.range,O=O.objectStore(m),O=L.isPrimaryKey?O:O.index(L.name),L=r(C);if(I===0)return h({result:[]});l?((C=E?O.getAll(L,P):O.getAllKeys(L,P)).onsuccess=function(j){return h({result:j.target.result})},C.onerror=At(d)):(_=0,k=!E&&"openKeyCursor"in O?O.openKeyCursor(L):O.openCursor(L),b=[],k.onsuccess=function(j){var A=k.result;return!A||(b.push(E?A.value:A.primaryKey),++_===I)?h({result:b}):void A.continue()},k.onerror=At(d))})}),openCursor:function(y){var h=y.trans,d=y.values,_=y.query,k=y.reverse,b=y.unique;return new Promise(function(E,I){E=ot(E);var O=_.index,P=_.range,C=h.objectStore(m),C=O.isPrimaryKey?C:C.index(O.name),O=k?b?"prevunique":"prev":b?"nextunique":"next",L=!d&&"openKeyCursor"in C?C.openKeyCursor(r(P),O):C.openCursor(r(P),O);L.onerror=At(I),L.onsuccess=ot(function(j){var A,q,X,Z,F=L.result;F?(F.___id=++Ca,F.done=!1,A=F.continue.bind(F),q=(q=F.continuePrimaryKey)&&q.bind(F),X=F.advance.bind(F),Z=function(){throw new Error("Cursor not stopped")},F.trans=h,F.stop=F.continue=F.continuePrimaryKey=F.advance=function(){throw new Error("Cursor not started")},F.fail=ot(I),F.next=function(){var V=this,lt=1;return this.start(function(){return lt--?V.continue():V.stop()}).then(function(){return V})},F.start=function(V){function lt(){if(L.result)try{V()}catch(pt){F.fail(pt)}else F.done=!0,F.start=function(){throw new Error("Cursor behind last entry")},F.stop()}var Tt=new Promise(function(pt,ee){pt=ot(pt),L.onerror=At(ee),F.fail=ee,F.stop=function(Xn){F.stop=F.continue=F.continuePrimaryKey=F.advance=Z,pt(Xn)}});return L.onsuccess=ot(function(pt){L.onsuccess=lt,lt()}),F.continue=A,F.continuePrimaryKey=q,F.advance=X,lt(),Tt},E(F)):E(null)},I)})},count:function(y){var h=y.query,d=y.trans,_=h.index,k=h.range;return new Promise(function(b,E){var I=d.objectStore(m),I=_.isPrimaryKey?I:I.index(_.name),P=r(k),P=P?I.count(P):I.count();P.onsuccess=ot(function(C){return b(C.target.result)}),P.onerror=At(E)})}}}i=f,o=Cr((f=t).objectStoreNames);var i,f={schema:{name:f.name,tables:o.map(function(p){return i.objectStore(p)}).map(function(p){var l=p.keyPath,m=p.autoIncrement,h=D(l),y={},h={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:l==null,compound:h,keyPath:l,autoIncrement:m,unique:!0,extractKey:$n(l)},indexes:Cr(p.indexNames).map(function(d){return p.index(d)}).map(function(b){var E=b.name,_=b.unique,k=b.multiEntry,b=b.keyPath,E={name:E,compound:D(b),keyPath:b,unique:_,multiEntry:k,extractKey:$n(b)};return y[Oe(b)]=E}),getIndexByKeyPath:function(d){return y[Oe(d)]}};return y[":id"]=h.primaryKey,l!=null&&(y[Oe(l)]=h.primaryKey),h})},hasGetAll:0<o.length&&"getAll"in i.objectStore(o[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},o=f.schema,s=f.hasGetAll,f=o.tables.map(a),w={};return f.forEach(function(p){return w[p.name]=p}),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(p){if(w[p])return w[p];throw new Error("Table '".concat(p,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ie(e),schema:o}}function Ka(t,e,n,r){return n=n.IDBKeyRange,e=$a(e,n,r),{dbcore:t.dbcore.reduce(function(a,i){return i=i.create,g(g({},a),i(a))},e)}}function Ye(t,e){var n=e.db,n=Ka(t._middlewares,n,t._deps,e);t.core=n.dbcore,t.tables.forEach(function(r){var a=r.name;t.core.schema.tables.some(function(i){return i.name===a})&&(r.core=t.core.table(a),t[a]instanceof t.Table)&&(t[a].core=r.core)})}function Ge(t,e,n,r){n.forEach(function(a){var i=r[a];e.forEach(function(o){var s=function f(w,p){return Y(w,p)||(w=R(w))&&f(w,p)}(o,a);(!s||"value"in s&&s.value===void 0)&&(o===t.Transaction.prototype||o instanceof t.Transaction?it(o,a,{get:function(){return this.table(a)},set:function(f){Q(this,a,{value:f,writable:!0,configurable:!0,enumerable:!0})}}):o[a]=new t.Table(a,i))})})}function Kn(t,e){e.forEach(function(n){for(var r in n)n[r]instanceof t.Table&&delete n[r]})}function ja(t,e){return t._cfg.version-e._cfg.version}function La(t,e,n,r){var a=t._dbSchema,i=(n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=Cn("$meta",Kr("")[0],[]),t._storeNames.push("$meta")),t._createTransaction("readwrite",t._storeNames,a)),o=(i.create(n),i._completion.catch(r),i._reject.bind(i)),s=M.transless||M;Rt(function(){if(M.trans=i,M.transless=s,e!==0)return Ye(t,n),w=e,((f=i).storeNames.includes("$meta")?f.table("$meta").get("version").then(function(p){return p??w}):K.resolve(w)).then(function(_){var l=t,m=_,y=i,h=n,d=[],_=l._versions,k=l._dbSchema=Xe(0,l.idbdb,h);return(_=_.filter(function(b){return b._cfg.version>=m})).length===0?K.resolve():(_.forEach(function(b){d.push(function(){var E,I,P,C=k,O=b._cfg.dbschema,L=(Je(l,C,h),Je(l,O,h),k=l._dbSchema=O,jn(C,O)),j=(L.add.forEach(function(A){Ln(h,A[0],A[1].primKey,A[1].indexes)}),L.change.forEach(function(A){if(A.recreate)throw new B.Upgrade("Not yet support for changing primary key");var q=h.objectStore(A.name);A.add.forEach(function(X){return Qe(q,X)}),A.change.forEach(function(X){q.deleteIndex(X.name),Qe(q,X)}),A.del.forEach(function(X){return q.deleteIndex(X)})}),b._cfg.contentUpgrade);if(j&&b._cfg.version>m)return Ye(l,h),y._memoizedTables={},E=ft(O),L.del.forEach(function(A){E[A]=C[A]}),Kn(l,[l.Transaction.prototype]),Ge(l,[l.Transaction.prototype],S(E),E),y.schema=E,(I=mn(j))&&ue(),O=K.follow(function(){var A;(P=j(y))&&I&&(A=Mt.bind(null,null),P.then(A,A))}),P&&typeof P.then=="function"?K.resolve(P):O.then(function(){return P})}),d.push(function(E){var I,P,C=b._cfg.dbschema;I=C,P=E,[].slice.call(P.db.objectStoreNames).forEach(function(O){return I[O]==null&&P.db.deleteObjectStore(O)}),Kn(l,[l.Transaction.prototype]),Ge(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),y.schema=l._dbSchema}),d.push(function(E){l.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(l.idbdb.version/10)===b._cfg.version?(l.idbdb.deleteObjectStore("$meta"),delete l._dbSchema.$meta,l._storeNames=l._storeNames.filter(function(I){return I!=="$meta"})):E.objectStore("$meta").put(b._cfg.version,"version"))})}),function b(){return d.length?K.resolve(d.shift()(y.idbtrans)).then(b):K.resolve()}().then(function(){$r(k,h)}))}).catch(o);var f,w;S(a).forEach(function(p){Ln(n,p,a[p].primKey,a[p].indexes)}),Ye(t,n),K.follow(function(){return t.on.populate.fire(i)}).catch(o)})}function qa(t,e){$r(t._dbSchema,e),e.db.version%10!=0||e.objectStoreNames.contains("$meta")||e.db.createObjectStore("$meta").add(Math.ceil(e.db.version/10-1),"version");var n=Xe(0,t.idbdb,e);Je(t,t._dbSchema,e);for(var r=0,a=jn(n,t._dbSchema).change;r<a.length;r++){var i=(o=>{if(o.change.length||o.recreate)return console.warn("Unable to patch indexes of table ".concat(o.name," because it has changes on the type of index or primary key.")),{value:void 0};var s=e.objectStore(o.name);o.add.forEach(function(f){Ot&&console.debug("Dexie upgrade patch: Creating missing index ".concat(o.name,".").concat(f.src)),Qe(s,f)})})(a[r]);if(typeof i=="object")return i.value}}function jn(t,e){var n,r={del:[],add:[],change:[]};for(n in t)e[n]||r.del.push(n);for(n in e){var a=t[n],i=e[n];if(a){var o={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||a.primKey.auto!==i.primKey.auto)o.recreate=!0,r.change.push(o);else{var s=a.idxByName,f=i.idxByName,w=void 0;for(w in s)f[w]||o.del.push(w);for(w in f){var p=s[w],l=f[w];p?p.src!==l.src&&o.change.push(l):o.add.push(l)}(0<o.del.length||0<o.add.length||0<o.change.length)&&r.change.push(o)}}else r.add.push([n,i])}return r}function Ln(t,e,n,r){var a=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});r.forEach(function(i){return Qe(a,i)})}function $r(t,e){S(t).forEach(function(n){e.db.objectStoreNames.contains(n)||(Ot&&console.debug("Dexie: Creating missing table",n),Ln(e,n,t[n].primKey,t[n].indexes))})}function Qe(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Xe(t,e,n){var r={};return wt(e.objectStoreNames,0).forEach(function(a){for(var i=n.objectStore(a),o=Pn(Pr(w=i.keyPath),w||"",!0,!1,!!i.autoIncrement,w&&typeof w!="string",!0),s=[],f=0;f<i.indexNames.length;++f){var p=i.index(i.indexNames[f]),w=p.keyPath,p=Pn(p.name,w,!!p.unique,!!p.multiEntry,!1,w&&typeof w!="string",!1);s.push(p)}r[a]=Cn(a,o,s)}),r}function Je(t,e,n){for(var r=n.db.objectStoreNames,a=0;a<r.length;++a){var i=r[a],o=n.objectStore(i);t._hasGetAll="getAll"in o;for(var s=0;s<o.indexNames.length;++s){var f,w=o.indexNames[s],p=o.index(w).keyPath,p=typeof p=="string"?p:"["+wt(p).join("+")+"]";e[i]&&(f=e[i].idxByName[p])&&(f.name=w,delete e[i].idxByName[p],e[i].idxByName[w]=f)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&T.WorkerGlobalScope&&T instanceof T.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}function Kr(t){return t.split(",").map(function(e,n){var a=e.split(":"),r=(r=a[1])==null?void 0:r.trim(),a=(e=a[0].trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(a)?a.match(/^\[(.*)\]$/)[1].split("+"):a;return Pn(a,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),D(i),n===0,r)})}fe.prototype._createTableSchema=Cn,fe.prototype._parseIndexSyntax=Kr,fe.prototype._parseStoresSpec=function(t,e){var n=this;S(t).forEach(function(r){if(t[r]!==null){var a=n._parseIndexSyntax(t[r]),i=a.shift();if(!i)throw new B.Schema("Invalid schema for table "+r+": "+t[r]);if(i.unique=!0,i.multi)throw new B.Schema("Primary key cannot be multiEntry*");a.forEach(function(o){if(o.auto)throw new B.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new B.Schema("Index must have a name and cannot be an empty string")}),i=n._createTableSchema(r,i,a),e[r]=i}})},fe.prototype.stores=function(n){var e=this.db,n=(this._cfg.storesSource=this._cfg.storesSource?$(this._cfg.storesSource,n):n,e._versions),r={},a={};return n.forEach(function(i){$(r,i._cfg.storesSource),a=i._cfg.dbschema={},i._parseStoresSpec(r,a)}),e._dbSchema=a,Kn(e,[e._allTables,e,e.Transaction.prototype]),Ge(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],S(a),a),e._storeNames=S(a),this},fe.prototype.upgrade=function(t){return this._cfg.contentUpgrade=vn(this._cfg.contentUpgrade||et,t),this};var Ra=fe;function fe(){}function qn(t,e){var n=t._dbNamesDB;return n||(n=t._dbNamesDB=new jt(Fe,{addons:[],indexedDB:t,IDBKeyRange:e})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Rn(t){return t&&typeof t.databases=="function"}function Mn(t){return Rt(function(){return M.letThrough=!0,t()})}function Bn(t){return!("from"in t)}var kt=function(t,e){var n;if(!this)return n=new kt,t&&"d"in t&&$(n,t),n;$(this,arguments.length?{d:1,from:t,to:1<arguments.length?e:t}:{d:0})};function Ae(t,e,n){var r=G(e,n);if(!isNaN(r)){if(0<r)throw RangeError();if(Bn(t))return $(t,{from:e,to:n,d:1});var r=t.l,a=t.r;if(G(n,t.from)<0)return r?Ae(r,e,n):t.l={from:e,to:n,d:1,l:null,r:null},Lr(t);if(0<G(e,t.to))return a?Ae(a,e,n):t.r={from:e,to:n,d:1,l:null,r:null},Lr(t);G(e,t.from)<0&&(t.from=e,t.l=null,t.d=a?a.d+1:1),0<G(n,t.to)&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1),e=!t.r,r&&!t.l&&Pe(t,r),a&&e&&Pe(t,a)}}function Pe(t,e){Bn(e)||function n(r,a){var i=a.from,o=a.l,s=a.r;Ae(r,i,a.to),o&&n(r,o),s&&n(r,s)}(t,e)}function jr(t,e){var n=Ze(e),r=n.next();if(!r.done)for(var a=r.value,i=Ze(t),o=i.next(a.from),s=o.value;!r.done&&!o.done;){if(G(s.from,a.to)<=0&&0<=G(s.to,a.from))return!0;G(a.from,s.from)<0?a=(r=n.next(s.from)).value:s=(o=i.next(a.from)).value}return!1}function Ze(t){var e=Bn(t)?null:{s:0,n:t};return{next:function(n){for(var r=0<arguments.length;e;)switch(e.s){case 0:if(e.s=1,r)for(;e.n.l&&G(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!r||G(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function Lr(t){var e,n,r,a=(((a=t.r)==null?void 0:a.d)||0)-(((a=t.l)==null?void 0:a.d)||0),a=1<a?"r":a<-1?"l":"";a&&(e=a=="r"?"l":"r",n=g({},t),r=t[a],t.from=r.from,t.to=r.to,t[a]=r[a],n[a]=r[e],(t[e]=n).d=qr(n)),t.d=qr(t)}function qr(n){var e=n.r,n=n.l;return(e?n?Math.max(e.d,n.d):e.d:n?n.d:0)+1}function tn(t,e){return S(e).forEach(function(n){t[n]?Pe(t[n],e[n]):t[n]=function r(a){var i,o,s={};for(i in a)N(a,i)&&(o=a[i],s[i]=!o||typeof o!="object"||cr.has(o.constructor)?o:r(o));return s}(e[n])}),t}function Nn(t,e){return t.all||e.all||Object.keys(t).some(function(n){return e[n]&&jr(e[n],t[n])})}nt(kt.prototype,((St={add:function(t){return Pe(this,t),this},addKey:function(t){return Ae(this,t,t),this},addKeys:function(t){var e=this;return t.forEach(function(n){return Ae(e,n,n)}),this},hasKey:function(t){var e=Ze(this).next(t).value;return e&&G(e.from,t)<=0&&0<=G(e.to,t)}})[hn]=function(){return Ze(this)},St));var Zt={},Fn={},Wn=!1;function en(t){tn(Fn,t),Wn||(Wn=!0,setTimeout(function(){Wn=!1,Un(Fn,!(Fn={}))},0))}function Un(t,e){e===void 0&&(e=!1);var n=new Set;if(t.all)for(var r=0,a=Object.values(Zt);r<a.length;r++)Rr(s=a[r],t,n,e);else for(var i in t){var o,s,i=/^idb\:\/\/(.*)\/(.*)\//.exec(i);i&&(o=i[1],i=i[2],s=Zt["idb://".concat(o,"/").concat(i)])&&Rr(s,t,n,e)}n.forEach(function(f){return f()})}function Rr(t,e,n,r){for(var a=[],i=0,o=Object.entries(t.queries.query);i<o.length;i++){for(var s=o[i],f=s[0],w=[],p=0,l=s[1];p<l.length;p++){var m=l[p];Nn(e,m.obsSet)?m.subscribers.forEach(function(_){return n.add(_)}):r&&w.push(m)}r&&a.push([f,w])}if(r)for(var y=0,h=a;y<h.length;y++){var d=h[y],f=d[0],w=d[1];t.queries.query[f]=w}}function Ma(t){var e=t._state,n=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(function(){return e.dbOpenError?ht(e.dbOpenError):t});e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var r=e.openCanceller,a=Math.round(10*t.verno),i=!1;function o(){if(e.openCanceller!==r)throw new B.DatabaseClosed("db.open() was cancelled")}function s(){return new K(function(m,y){if(o(),!n)throw new B.MissingAPI;var h=t.name,d=e.autoSchema||!a?n.open(h):n.open(h,a);if(!d)throw new B.MissingAPI;d.onerror=At(y),d.onblocked=ot(t._fireOnBlocked),d.onupgradeneeded=ot(function(_){var k;p=d.transaction,e.autoSchema&&!t._options.allowEmptyDB?(d.onerror=Te,p.abort(),d.result.close(),(k=n.deleteDatabase(h)).onsuccess=k.onerror=ot(function(){y(new B.NoSuchDatabase("Database ".concat(h," doesnt exist")))})):(p.onerror=At(y),k=_.oldVersion>Math.pow(2,62)?0:_.oldVersion,l=k<1,t.idbdb=d.result,i&&qa(t,p),La(t,k/10,p,y))},y),d.onsuccess=ot(function(){p=null;var _,k,b,E,I,P,C=t.idbdb=d.result,O=wt(C.objectStoreNames);if(0<O.length)try{var L=C.transaction((I=O).length===1?I[0]:I,"readonly");if(e.autoSchema)P=C,E=L,(b=t).verno=P.version/10,E=b._dbSchema=Xe(0,P,E),b._storeNames=wt(P.objectStoreNames,0),Ge(b,[b._allTables],S(E),E);else if(Je(t,t._dbSchema,L),k=L,((k=jn(Xe(0,(_=t).idbdb,k),_._dbSchema)).add.length||k.change.some(function(j){return j.add.length||j.change.length}))&&!i)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),C.close(),a=C.version+1,i=!0,m(s());Ye(t,L)}catch{}ce.push(t),C.onversionchange=ot(function(j){e.vcFired=!0,t.on("versionchange").fire(j)}),C.onclose=ot(function(){t.close({disableAutoOpen:!1})}),l&&(O=t._deps,I=h,Rn(P=O.indexedDB)||I===Fe||qn(P,O.IDBKeyRange).put({name:I}).catch(et)),m()},y)}).catch(function(m){switch(m==null?void 0:m.name){case"UnknownError":if(0<e.PR1398_maxLoop)return e.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),s();break;case"VersionError":if(0<a)return a=0,s()}return K.reject(m)})}var f,w=e.dbReadyResolve,p=null,l=!1;return K.race([r,(typeof navigator>"u"?K.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(m){function y(){return indexedDB.databases().finally(m)}f=setInterval(y,100),y()}).finally(function(){return clearInterval(f)}):Promise.resolve()).then(s)]).then(function(){return o(),e.onReadyBeingFired=[],K.resolve(Mn(function(){return t.on.ready.fire(t.vip)})).then(function m(){var y;if(0<e.onReadyBeingFired.length)return y=e.onReadyBeingFired.reduce(vn,et),e.onReadyBeingFired=[],K.resolve(Mn(function(){return y(t.vip)})).then(m)})}).finally(function(){e.openCanceller===r&&(e.onReadyBeingFired=null,e.isBeingOpened=!1)}).catch(function(m){e.dbOpenError=m;try{p&&p.abort()}catch{}return r===e.openCanceller&&t._close(),ht(m)}).finally(function(){e.openComplete=!0,w()}).then(function(){var m;return l&&(m={},t.tables.forEach(function(y){y.schema.indexes.forEach(function(h){h.name&&(m["idb://".concat(t.name,"/").concat(y.name,"/").concat(h.name)]=new kt(-1/0,[[[]]]))}),m["idb://".concat(t.name,"/").concat(y.name,"/")]=m["idb://".concat(t.name,"/").concat(y.name,"/:dels")]=new kt(-1/0,[[[]]])}),Ft(De).fire(m),Un(m,!0)),t})}function Vn(t){function e(i){return t.next(i)}var n=a(e),r=a(function(i){return t.throw(i)});function a(i){return function(s){var s=i(s),f=s.value;return s.done?f:f&&typeof f.then=="function"?f.then(n,r):D(f)?Promise.all(f).then(n,r):n(f)}}return a(e)()}function nn(t,e,n){for(var r=D(t)?t.slice():[t],a=0;a<n;++a)r.push(e);return r}var Ba={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return g(g({},t),{table:function(r){var n=t.table(r),r=n.schema,a={},i=[];function o(m,y,h){var b=Oe(m),d=a[b]=a[b]||[],_=m==null?0:typeof m=="string"?1:m.length,k=0<y,b=g(g({},h),{name:k?"".concat(b,"(virtual-from:").concat(h.name,")"):h.name,lowLevelIndex:h,isVirtual:k,keyTail:y,keyLength:_,extractKey:$n(m),unique:!k&&h.unique});return d.push(b),b.isPrimaryKey||i.push(b),1<_&&o(_===2?m[0]:m.slice(0,_-1),y+1,h),d.sort(function(E,I){return E.keyTail-I.keyTail}),b}var s=o(r.primaryKey.keyPath,0,r.primaryKey);a[":id"]=[s];for(var f=0,w=r.indexes;f<w.length;f++){var p=w[f];o(p.keyPath,0,p)}function l(m){var y,h=m.query.index;return h.isVirtual?g(g({},m),{query:{index:h.lowLevelIndex,range:(y=m.query.range,h=h.keyTail,{type:y.type===1?2:y.type,lower:nn(y.lower,y.lowerOpen?t.MAX_KEY:t.MIN_KEY,h),lowerOpen:!0,upper:nn(y.upper,y.upperOpen?t.MIN_KEY:t.MAX_KEY,h),upperOpen:!0})}}):m}return g(g({},n),{schema:g(g({},r),{primaryKey:s,indexes:i,getIndexByKeyPath:function(m){return(m=a[Oe(m)])&&m[0]}}),count:function(m){return n.count(l(m))},query:function(m){return n.query(l(m))},openCursor:function(m){var y=m.query.index,h=y.keyTail,d=y.keyLength;return y.isVirtual?n.openCursor(l(m)).then(function(k){return k&&_(k)}):n.openCursor(m);function _(k){return Object.create(k,{continue:{value:function(b){b!=null?k.continue(nn(b,m.reverse?t.MAX_KEY:t.MIN_KEY,h)):m.unique?k.continue(k.key.slice(0,d).concat(m.reverse?t.MIN_KEY:t.MAX_KEY,h)):k.continue()}},continuePrimaryKey:{value:function(b,E){k.continuePrimaryKey(nn(b,t.MAX_KEY,h),E)}},primaryKey:{get:function(){return k.primaryKey}},key:{get:function(){var b=k.key;return d===1?b[0]:b.slice(0,d)}},value:{get:function(){return k.value}}})}}})}})}};function zn(t,e,n,r){return n=n||{},r=r||"",S(t).forEach(function(a){var i,o,s;N(e,a)?(i=t[a],o=e[a],typeof i=="object"&&typeof o=="object"&&i&&o?(s=pn(i))!==pn(o)?n[r+a]=e[a]:s==="Object"?zn(i,o,n,r+a+"."):i!==o&&(n[r+a]=e[a]):i!==o&&(n[r+a]=e[a])):n[r+a]=void 0}),S(e).forEach(function(a){N(t,a)||(n[r+a]=e[a])}),n}function Hn(t,e){return e.type==="delete"?e.keys:e.keys||e.values.map(t.extractKey)}var Na={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return g(g({},t),{table:function(e){var n=t.table(e),r=n.schema.primaryKey;return g(g({},n),{mutate:function(a){var i=M.trans,o=i.table(e).hook,s=o.deleting,f=o.creating,w=o.updating;switch(a.type){case"add":if(f.fire===et)break;return i._promise("readwrite",function(){return p(a)},!0);case"put":if(f.fire===et&&w.fire===et)break;return i._promise("readwrite",function(){return p(a)},!0);case"delete":if(s.fire===et)break;return i._promise("readwrite",function(){return p(a)},!0);case"deleteRange":if(s.fire===et)break;return i._promise("readwrite",function(){return function l(m,y,h){return n.query({trans:m,values:!1,query:{index:r,range:y},limit:h}).then(function(d){var _=d.result;return p({type:"delete",keys:_,trans:m}).then(function(k){return 0<k.numFailures?Promise.reject(k.failures[0]):_.length<h?{failures:[],numFailures:0,lastResult:void 0}:l(m,g(g({},y),{lower:_[_.length-1],lowerOpen:!0}),h)})})}(a.trans,a.range,1e4)},!0)}return n.mutate(a);function p(l){var m,y,h,d=M.trans,_=l.keys||Hn(r,l);if(_)return(l=l.type==="add"||l.type==="put"?g(g({},l),{keys:_}):g({},l)).type!=="delete"&&(l.values=x([],l.values)),l.keys&&(l.keys=x([],l.keys)),m=n,h=_,((y=l).type==="add"?Promise.resolve([]):m.getMany({trans:y.trans,keys:h,cache:"immutable"})).then(function(k){var b=_.map(function(E,I){var P,C,O,L=k[I],j={onerror:null,onsuccess:null};return l.type==="delete"?s.fire.call(j,E,L,d):l.type==="add"||L===void 0?(P=f.fire.call(j,E,l.values[I],d),E==null&&P!=null&&(l.keys[I]=E=P,r.outbound||ct(l.values[I],r.keyPath,E))):(P=zn(L,l.values[I]),(C=w.fire.call(j,P,E,L,d))&&(O=l.values[I],Object.keys(C).forEach(function(A){N(O,A)?O[A]=C[A]:ct(O,A,C[A])}))),j});return n.mutate(l).then(function(E){for(var I=E.failures,P=E.results,C=E.numFailures,E=E.lastResult,O=0;O<_.length;++O){var L=(P||_)[O],j=b[O];L==null?j.onerror&&j.onerror(I[O]):j.onsuccess&&j.onsuccess(l.type==="put"&&k[O]?l.values[O]:L)}return{failures:I,results:P,numFailures:C,lastResult:E}}).catch(function(E){return b.forEach(function(I){return I.onerror&&I.onerror(E)}),Promise.reject(E)})});throw new Error("Keys missing")}}})}})}};function Mr(t,e,n){try{if(!e||e.keys.length<t.length)return null;for(var r=[],a=0,i=0;a<e.keys.length&&i<t.length;++a)G(e.keys[a],t[i])===0&&(r.push(n?Ut(e.values[a]):e.values[a]),++i);return r.length===t.length?r:null}catch{return null}}var Fa={stack:"dbcore",level:-1,create:function(t){return{table:function(e){var n=t.table(e);return g(g({},n),{getMany:function(r){var a;return r.cache?(a=Mr(r.keys,r.trans._cache,r.cache==="clone"))?K.resolve(a):n.getMany(r).then(function(i){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Ut(i):i},i}):n.getMany(r)},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function Br(t,e){return t.trans.mode==="readonly"&&!!t.subscr&&!t.trans.explicit&&t.trans.db._options.cache!=="disabled"&&!e.schema.primaryKey.outbound}function Nr(t,e){switch(t){case"query":return e.values&&!e.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Wa={stack:"dbcore",level:0,name:"Observability",create:function(t){var e=t.schema.name,n=new kt(t.MIN_KEY,t.MAX_KEY);return g(g({},t),{transaction:function(r,a,i){if(M.subscr&&a!=="readonly")throw new B.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(M.querier));return t.transaction(r,a,i)},table:function(r){function a(_){var d,_=_.query;return[d=_.index,new kt((d=(_=_.range).lower)!=null?d:t.MIN_KEY,(d=_.upper)!=null?d:t.MAX_KEY)]}var i=t.table(r),o=i.schema,s=o.primaryKey,f=o.indexes,w=s.extractKey,p=s.outbound,l=s.autoIncrement&&f.filter(function(h){return h.compound&&h.keyPath.includes(s.keyPath)}),m=g(g({},i),{mutate:function(h){function d(q){return q="idb://".concat(e,"/").concat(r,"/").concat(q),I[q]||(I[q]=new kt)}var _,k,b,E=h.trans,I=h.mutatedParts||(h.mutatedParts={}),P=d(""),C=d(":dels"),O=h.type,j=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[Hn(s,h).filter(function(q){return q}),h.values]:[],L=j[0],j=j[1],A=h.trans._cache;return D(L)?(P.addKeys(L),(O=O==="delete"||L.length===j.length?Mr(L,A):null)||C.addKeys(L),(O||j)&&(_=d,k=O,b=j,o.indexes.forEach(function(q){var X=_(q.name||"");function Z(V){return V!=null?q.extractKey(V):null}function F(V){q.multiEntry&&D(V)?V.forEach(function(lt){return X.addKey(lt)}):X.addKey(V)}(k||b).forEach(function(V,pt){var Tt=k&&Z(k[pt]),pt=b&&Z(b[pt]);G(Tt,pt)!==0&&(Tt!=null&&F(Tt),pt!=null)&&F(pt)})}))):L?(j={from:(A=L.lower)!=null?A:t.MIN_KEY,to:(O=L.upper)!=null?O:t.MAX_KEY},C.add(j),P.add(j)):(P.add(n),C.add(n),o.indexes.forEach(function(q){return d(q.name).add(n)})),i.mutate(h).then(function(q){return!L||h.type!=="add"&&h.type!=="put"||(P.addKeys(q.results),l&&l.forEach(function(X){for(var Z=h.values.map(function(Tt){return X.extractKey(Tt)}),F=X.keyPath.findIndex(function(Tt){return Tt===s.keyPath}),V=0,lt=q.results.length;V<lt;++V)Z[V][F]=q.results[V];d(X.name).addKeys(Z)})),E.mutatedParts=tn(E.mutatedParts||{},I),q})}}),y={get:function(h){return[s,new kt(h.key)]},getMany:function(h){return[s,new kt().addKeys(h.keys)]},count:a,query:a,openCursor:a};return S(y).forEach(function(h){m[h]=function(d){var _=M.subscr,k=!!_,b=Br(M,i)&&Nr(h,d)?d.obsSet={}:_;if(k){var E,_=function(j){return j="idb://".concat(e,"/").concat(r,"/").concat(j),b[j]||(b[j]=new kt)},I=_(""),P=_(":dels"),k=y[h](d),C=k[0],k=k[1];if((h==="query"&&C.isPrimaryKey&&!d.values?P:_(C.name||"")).add(k),!C.isPrimaryKey){if(h!=="count")return E=h==="query"&&p&&d.values&&i.query(g(g({},d),{values:!1})),i[h].apply(this,arguments).then(function(j){if(h==="query"){if(p&&d.values)return E.then(function(Z){return Z=Z.result,I.addKeys(Z),j});var A=d.values?j.result.map(w):j.result;(d.values?I:P).addKeys(A)}else{var q,X;if(h==="openCursor")return X=d.values,(q=j)&&Object.create(q,{key:{get:function(){return P.addKey(q.primaryKey),q.key}},primaryKey:{get:function(){var Z=q.primaryKey;return P.addKey(Z),Z}},value:{get:function(){return X&&I.addKey(q.primaryKey),q.value}}})}return j});P.add(n)}}return i[h].apply(this,arguments)}}),m}})}};function Fr(t,e,n){var r;return n.numFailures===0?e:e.type==="deleteRange"||(r=e.keys?e.keys.length:"values"in e&&e.values?e.values.length:1,n.numFailures===r)?null:(r=g({},e),D(r.keys)&&(r.keys=r.keys.filter(function(a,i){return!(i in n.failures)})),"values"in r&&D(r.values)&&(r.values=r.values.filter(function(a,i){return!(i in n.failures)})),r)}function Yn(t,e){return n=t,((r=e).lower===void 0||(r.lowerOpen?0<G(n,r.lower):0<=G(n,r.lower)))&&(n=t,(r=e).upper===void 0||(r.upperOpen?G(n,r.upper)<0:G(n,r.upper)<=0));var n,r}function Wr(t,e,n,r,a,i){var o,s,f,w,p,l;return!n||n.length===0||(o=e.query.index,s=o.multiEntry,f=e.query.range,w=r.schema.primaryKey.extractKey,p=o.extractKey,l=(o.lowLevelIndex||o).extractKey,(r=n.reduce(function(m,y){var h=m,d=[];if(y.type==="add"||y.type==="put")for(var _=new kt,k=y.values.length-1;0<=k;--k){var b,E=y.values[k],I=w(E);!_.hasKey(I)&&(b=p(E),s&&D(b)?b.some(function(j){return Yn(j,f)}):Yn(b,f))&&(_.addKey(I),d.push(E))}switch(y.type){case"add":var P=new kt().addKeys(e.values?m.map(function(A){return w(A)}):m),h=m.concat(e.values?d.filter(function(A){return A=w(A),!P.hasKey(A)&&(P.addKey(A),!0)}):d.map(function(A){return w(A)}).filter(function(A){return!P.hasKey(A)&&(P.addKey(A),!0)}));break;case"put":var C=new kt().addKeys(y.values.map(function(A){return w(A)}));h=m.filter(function(A){return!C.hasKey(e.values?w(A):A)}).concat(e.values?d:d.map(function(A){return w(A)}));break;case"delete":var O=new kt().addKeys(y.keys);h=m.filter(function(A){return!O.hasKey(e.values?w(A):A)});break;case"deleteRange":var L=y.range;h=m.filter(function(A){return!Yn(w(A),L)})}return h},t))===t)?t:(r.sort(function(m,y){return G(l(m),l(y))||G(w(m),w(y))}),e.limit&&e.limit<1/0&&(r.length>e.limit?r.length=e.limit:t.length===e.limit&&r.length<e.limit&&(a.dirty=!0)),i?Object.freeze(r):r)}function Ur(t,e){return G(t.lower,e.lower)===0&&G(t.upper,e.upper)===0&&!!t.lowerOpen==!!e.lowerOpen&&!!t.upperOpen==!!e.upperOpen}function Ua(t,e){return((n,r,a,i)=>{if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((n=G(n,r))===0){if(a&&i)return 0;if(a)return 1;if(i)return-1}return n})(t.lower,e.lower,t.lowerOpen,e.lowerOpen)<=0&&0<=((n,r,a,i)=>{if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((n=G(n,r))===0){if(a&&i)return 0;if(a)return-1;if(i)return 1}return n})(t.upper,e.upper,t.upperOpen,e.upperOpen)}function Va(t,e,n,r){t.subscribers.add(n),r.addEventListener("abort",function(){var a,i;t.subscribers.delete(n),t.subscribers.size===0&&(a=t,i=e,setTimeout(function(){a.subscribers.size===0&&Vt(i,a)},3e3))})}var za={stack:"dbcore",level:0,name:"Cache",create:function(t){var e=t.schema.name;return g(g({},t),{transaction:function(n,r,a){var i,o,s=t.transaction(n,r,a);return r==="readwrite"&&(a=(i=new AbortController).signal,s.addEventListener("abort",(o=function(f){return function(){if(i.abort(),r==="readwrite"){for(var w=new Set,p=0,l=n;p<l.length;p++){var m=l[p],y=Zt["idb://".concat(e,"/").concat(m)];if(y){var h=t.table(m),d=y.optimisticOps.filter(function(q){return q.trans===s});if(s._explicit&&f&&s.mutatedParts)for(var _=0,k=Object.values(y.queries.query);_<k.length;_++)for(var b=0,E=(C=k[_]).slice();b<E.length;b++)Nn((O=E[b]).obsSet,s.mutatedParts)&&(Vt(C,O),O.subscribers.forEach(function(q){return w.add(q)}));else if(0<d.length){y.optimisticOps=y.optimisticOps.filter(function(q){return q.trans!==s});for(var I=0,P=Object.values(y.queries.query);I<P.length;I++)for(var C,O,L,j=0,A=(C=P[I]).slice();j<A.length;j++)(O=A[j]).res!=null&&s.mutatedParts&&(f&&!O.dirty?(L=Object.isFrozen(O.res),L=Wr(O.res,O.req,d,h,O,L),O.dirty?(Vt(C,O),O.subscribers.forEach(function(q){return w.add(q)})):L!==O.res&&(O.res=L,O.promise=K.resolve({result:L}))):(O.dirty&&Vt(C,O),O.subscribers.forEach(function(q){return w.add(q)})))}}}w.forEach(function(q){return q()})}}})(!1),{signal:a}),s.addEventListener("error",o(!1),{signal:a}),s.addEventListener("complete",o(!0),{signal:a})),s},table:function(n){var r=t.table(n),a=r.schema.primaryKey;return g(g({},r),{mutate:function(i){var o,s=M.trans;return!a.outbound&&s.db._options.cache!=="disabled"&&!s.explicit&&s.idbtrans.mode==="readwrite"&&(o=Zt["idb://".concat(e,"/").concat(n)])?(s=r.mutate(i),i.type!=="add"&&i.type!=="put"||!(50<=i.values.length||Hn(a,i).some(function(f){return f==null}))?(o.optimisticOps.push(i),i.mutatedParts&&en(i.mutatedParts),s.then(function(f){0<f.numFailures&&(Vt(o.optimisticOps,i),(f=Fr(0,i,f))&&o.optimisticOps.push(f),i.mutatedParts)&&en(i.mutatedParts)}),s.catch(function(){Vt(o.optimisticOps,i),i.mutatedParts&&en(i.mutatedParts)})):s.then(function(f){var w=Fr(0,g(g({},i),{values:i.values.map(function(p,l){var m;return f.failures[l]?p:(ct(m=(m=a.keyPath)!=null&&m.includes(".")?Ut(p):g({},p),a.keyPath,f.results[l]),m)})}),f);o.optimisticOps.push(w),queueMicrotask(function(){return i.mutatedParts&&en(i.mutatedParts)})}),s):r.mutate(i)},query:function(i){var o,s,f,w,p,l,m;return Br(M,r)&&Nr("query",i)?(o=((f=M.trans)==null?void 0:f.db._options.cache)==="immutable",s=(f=M).requery,f=f.signal,l=((y,h,d,_)=>{var k=Zt["idb://".concat(y,"/").concat(h)];if(!k)return[];if(!(y=k.queries[d]))return[null,!1,k,null];var b=y[(_.query?_.query.index.name:null)||""];if(!b)return[null,!1,k,null];switch(d){case"query":var E=b.find(function(I){return I.req.limit===_.limit&&I.req.values===_.values&&Ur(I.req.query.range,_.query.range)});return E?[E,!0,k,b]:[b.find(function(I){return("limit"in I.req?I.req.limit:1/0)>=_.limit&&(!_.values||I.req.values)&&Ua(I.req.query.range,_.query.range)}),!1,k,b];case"count":return E=b.find(function(I){return Ur(I.req.query.range,_.query.range)}),[E,!!E,k,b]}})(e,n,"query",i),m=l[0],w=l[2],p=l[3],m&&l[1]?m.obsSet=i.obsSet:(l=r.query(i).then(function(y){var h=y.result;if(m&&(m.res=h),o){for(var d=0,_=h.length;d<_;++d)Object.freeze(h[d]);Object.freeze(h)}else y.result=Ut(h);return y}).catch(function(y){return p&&m&&Vt(p,m),Promise.reject(y)}),m={obsSet:i.obsSet,promise:l,subscribers:new Set,type:"query",req:i,dirty:!1},p?p.push(m):(p=[m],(w=w||(Zt["idb://".concat(e,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[i.query.index.name||""]=p)),Va(m,p,s,f),m.promise.then(function(y){return{result:Wr(y.result,i,w==null?void 0:w.optimisticOps,r,m,o)}})):r.query(i)}})}})}};function rn(t,e){return new Proxy(t,{get:function(n,r,a){return r==="db"?e:Reflect.get(n,r,a)}})}mt.prototype.version=function(t){if(isNaN(t)||t<.1)throw new B.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new B.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=this._versions,n=e.filter(function(r){return r._cfg.version===t})[0];return n||(n=new this.Version(t),e.push(n),e.sort(ja),n.stores({}),this._state.autoSchema=!1),n},mt.prototype._whenReady=function(t){var e=this;return this.idbdb&&(this._state.openComplete||M.letThrough||this._vip)?t():new K(function(n,r){if(e._state.openComplete)return r(new B.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return void r(new B.DatabaseClosed);e.open().catch(et)}e._state.dbReadyPromise.then(n,r)}).then(t)},mt.prototype.use=function(a){var e=a.stack,n=a.create,r=a.level,a=a.name,i=(a&&this.unuse({stack:e,name:a}),this._middlewares[e]||(this._middlewares[e]=[]));return i.push({stack:e,create:n,level:r??10,name:a}),i.sort(function(o,s){return o.level-s.level}),this},mt.prototype.unuse=function(t){var e=t.stack,n=t.name,r=t.create;return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(function(a){return r?a.create!==r:!!n&&a.name!==n})),this},mt.prototype.open=function(){var t=this;return Qt(qt,function(){return Ma(t)})},mt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var t=this._state,e=ce.indexOf(this);if(0<=e&&ce.splice(e,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new K(function(n){t.dbReadyResolve=n}),t.openCanceller=new K(function(n,r){t.cancelOpen=r}))},mt.prototype.close=function(e){var e=(e===void 0?{disableAutoOpen:!0}:e).disableAutoOpen,n=this._state;e?(n.isBeingOpened&&n.cancelOpen(new B.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new B.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},mt.prototype.delete=function(t){var e=this,n=(t===void 0&&(t={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),r=this._state;return new K(function(a,i){function o(){e.close(t);var s=e._deps.indexedDB.deleteDatabase(e.name);s.onsuccess=ot(function(){var f,w,p;f=e._deps,w=e.name,Rn(p=f.indexedDB)||w===Fe||qn(p,f.IDBKeyRange).delete(w).catch(et),a()}),s.onerror=At(i),s.onblocked=e._fireOnBlocked}if(n)throw new B.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})},mt.prototype.backendDB=function(){return this.idbdb},mt.prototype.isOpen=function(){return this.idbdb!==null},mt.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},mt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},mt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(mt.prototype,"tables",{get:function(){var t=this;return S(this._allTables).map(function(e){return t._allTables[e]})},enumerable:!1,configurable:!0}),mt.prototype.transaction=function(){var t=(function(e,n,r){var a=arguments.length;if(a<2)throw new B.InvalidArgument("Too few arguments");for(var i=new Array(a-1);--a;)i[a-1]=arguments[a];return r=i.pop(),[e,ur(i),r]}).apply(this,arguments);return this._transaction.apply(this,t)},mt.prototype._transaction=function(t,e,n){var r,a,i=this,o=M.trans,s=(o&&o.db===this&&t.indexOf("!")===-1||(o=null),t.indexOf("?")!==-1);t=t.replace("!","").replace("?","");try{if(a=e.map(function(w){if(w=w instanceof i.Table?w.name:w,typeof w!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return w}),t=="r"||t===Tn)r=Tn;else{if(t!="rw"&&t!=Dn)throw new B.InvalidArgument("Invalid transaction mode: "+t);r=Dn}if(o){if(o.mode===Tn&&r===Dn){if(!s)throw new B.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&a.forEach(function(w){if(o&&o.storeNames.indexOf(w)===-1){if(!s)throw new B.SubTransaction("Table "+w+" not included in parent transaction.");o=null}}),s&&o&&!o.active&&(o=null)}}catch(w){return o?o._promise(null,function(p,l){l(w)}):ht(w)}var f=(function w(p,l,m,y,h){return K.resolve().then(function(){var b=M.transless||M,d=p._createTransaction(l,m,p._dbSchema,y),b=(d.explicit=!0,{trans:d,transless:b});if(y)d.idbtrans=y.idbtrans;else try{d.create(),d.idbtrans._explicit=!0,p._state.PR1398_maxLoop=3}catch(E){return E.name===yn.InvalidState&&p.isOpen()&&0<--p._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),p.close({disableAutoOpen:!1}),p.open().then(function(){return w(p,l,m,null,h)})):ht(E)}var _,k=mn(h),b=(k&&ue(),K.follow(function(){var E;(_=h.call(d,d))&&(k?(E=Mt.bind(null,null),_.then(E,E)):typeof _.next=="function"&&typeof _.throw=="function"&&(_=Vn(_)))},b));return(_&&typeof _.then=="function"?K.resolve(_).then(function(E){return d.active?E:ht(new B.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):b.then(function(){return _})).then(function(E){return y&&d._resolve(),d._completion.then(function(){return E})}).catch(function(E){return d._reject(E),ht(E)})})}).bind(null,this,r,a,o,n);return o?o._promise(r,f,"lock"):M.trans?Qt(M.transless,function(){return i._whenReady(f)}):this._whenReady(f)},mt.prototype.table=function(t){if(N(this._allTables,t))return this._allTables[t];throw new B.InvalidTable("Table ".concat(t," does not exist"))};var jt=mt;function mt(t,e){var n,r,a,i,o,s=this,f=(this._middlewares={},this.verno=0,mt.dependencies),f=(this._options=e=g({addons:mt.addons,autoOpen:!0,indexedDB:f.indexedDB,IDBKeyRange:f.IDBKeyRange,cache:"cloned"},e),this._deps={indexedDB:e.indexedDB,IDBKeyRange:e.IDBKeyRange},e.addons),w=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:et,dbReadyPromise:null,cancelOpen:et,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:e.autoOpen}),p=(w.dbReadyPromise=new K(function(l){w.dbReadyResolve=l}),w.openCanceller=new K(function(l,m){w.cancelOpen=m}),this._state=w,this.name=t,this.on=Se(this,"populate","blocked","versionchange","close",{ready:[vn,et]}),this.once=function(l,m){var y=function(){for(var h=[],d=0;d<arguments.length;d++)h[d]=arguments[d];s.on(l).unsubscribe(y),m.apply(s,h)};return s.on(l,y)},this.on.ready.subscribe=_t(this.on.ready.subscribe,function(l){return function(m,y){mt.vip(function(){var h,d=s._state;d.openComplete?(d.dbOpenError||K.resolve().then(m),y&&l(m)):d.onReadyBeingFired?(d.onReadyBeingFired.push(m),y&&l(m)):(l(m),h=s,y||l(function _(){h.on.ready.unsubscribe(m),h.on.ready.unsubscribe(_)}))})}}),this.Collection=(n=this,Ee(Ia.prototype,function(_,d){this.db=n;var y=br,h=null;if(d)try{y=d()}catch(b){h=b}var d=_._ctx,_=d.table,k=_.hook.reading.fire;this._ctx={table:_,index:d.index,isPrimKey:!d.index||_.schema.primKey.keyPath&&d.index===_.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:h,or:d.or,valueMapper:k!==ge?k:null}})),this.Table=(r=this,Ee(Er.prototype,function(l,m,y){this.db=r,this._tx=y,this.name=l,this.schema=m,this.hook=r._allTables[l]?r._allTables[l].hook:Se(null,{creating:[ba,et],reading:[ga,ge],updating:[_a,et],deleting:[wa,et]})})),this.Transaction=(a=this,Ee(Pa.prototype,function(l,m,y,h,d){var _=this;l!=="readonly"&&m.forEach(function(k){k=(k=y[k])==null?void 0:k.yProps,k&&(m=m.concat(k.map(function(b){return b.updatesTable})))}),this.db=a,this.mode=l,this.storeNames=m,this.schema=y,this.chromeTransactionDurability=h,this.idbtrans=null,this.on=Se(this,"complete","error","abort"),this.parent=d||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new K(function(k,b){_._resolve=k,_._reject=b}),this._completion.then(function(){_.active=!1,_.on.complete.fire()},function(k){var b=_.active;return _.active=!1,_.on.error.fire(k),_.parent?_.parent._reject(k):b&&_.idbtrans&&_.idbtrans.abort(),ht(k)})})),this.Version=(i=this,Ee(Ra.prototype,function(l){this.db=i,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(o=this,Ee(Ar.prototype,function(l,m,y){if(this.db=o,this._ctx={table:l,index:m===":id"?null:m,or:y},this._cmp=this._ascending=G,this._descending=function(h,d){return G(d,h)},this._max=function(h,d){return 0<G(h,d)?h:d},this._min=function(h,d){return G(h,d)<0?h:d},this._IDBKeyRange=o._deps.IDBKeyRange,!this._IDBKeyRange)throw new B.MissingAPI})),this.on("versionchange",function(l){0<l.newVersion?console.warn("Another connection wants to upgrade database '".concat(s.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(s.name,"'. Closing db now to resume the delete request.")),s.close({disableAutoOpen:!1})}),this.on("blocked",function(l){!l.newVersion||l.newVersion<l.oldVersion?console.warn("Dexie.delete('".concat(s.name,"') was blocked")):console.warn("Upgrade '".concat(s.name,"' blocked by other connection holding version ").concat(l.oldVersion/10))}),this._maxKey=Ie(e.IDBKeyRange),this._createTransaction=function(l,m,y,h){return new s.Transaction(l,m,y,s._options.chromeTransactionDurability,h)},this._fireOnBlocked=function(l){s.on("blocked").fire(l),ce.filter(function(m){return m.name===s.name&&m!==s&&!m._state.vcFired}).map(function(m){return m.on("versionchange").fire(l)})},this.use(Fa),this.use(za),this.use(Wa),this.use(Ba),this.use(Na),new Proxy(this,{get:function(l,m,y){var h;return m==="_vip"||(m==="table"?function(d){return rn(s.table(d),p)}:(h=Reflect.get(l,m,y))instanceof Er?rn(h,p):m==="tables"?h.map(function(d){return rn(d,p)}):m==="_createTransaction"?function(){return rn(h.apply(this,arguments),p)}:h)}}));this.vip=p,f.forEach(function(l){return l(s)})}var an,pe=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ha=(Gn.prototype.subscribe=function(t,e,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:e,complete:n})},Gn.prototype[pe]=function(){return this},Gn);function Gn(t){this._subscribe=t}try{an={indexedDB:T.indexedDB||T.mozIndexedDB||T.webkitIndexedDB||T.msIndexedDB,IDBKeyRange:T.IDBKeyRange||T.webkitIDBKeyRange}}catch{an={indexedDB:null,IDBKeyRange:null}}function Vr(t){var e,n=!1,r=new Ha(function(a){var i=mn(t),o,s=!1,f={},w={},p={get closed(){return s},unsubscribe:function(){s||(s=!0,o&&o.abort(),l&&Ft.storagemutated.unsubscribe(y))}},l=(a.start&&a.start(p),!1),m=function(){return En(h)},y=function(d){tn(f,d),Nn(w,f)&&m()},h=function(){var d,_,k;!s&&an.indexedDB&&(f={},d={},o&&o.abort(),o=new AbortController,k=(b=>{var E=oe();try{i&&ue();var I=Rt(t,b);return I=i?I.finally(Mt):I}finally{E&&se()}})(_={subscr:d,signal:o.signal,requery:m,querier:t,trans:null}),Promise.resolve(k).then(function(b){n=!0,e=b,s||_.signal.aborted||(f={},(E=>{for(var I in E)if(N(E,I))return;return 1})(w=d)||l||(Ft(De,y),l=!0),En(function(){return!s&&a.next&&a.next(b)}))},function(b){n=!1,["DatabaseClosedError","AbortError"].includes(b==null?void 0:b.name)||s||En(function(){s||a.error&&a.error(b)})}))};return setTimeout(m,0),p});return r.hasValue=function(){return n},r.getValue=function(){return e},r}var te=jt;function Qn(t){var e=Wt;try{Wt=!0,Ft.storagemutated.fire(t),Un(t,!0)}finally{Wt=e}}nt(te,g(g({},$t),{delete:function(t){return new te(t,{addons:[]}).delete()},exists:function(t){return new te(t,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(t){try{return e=te.dependencies,n=e.indexedDB,e=e.IDBKeyRange,(Rn(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(a){return a.name}).filter(function(a){return a!==Fe})}):qn(n,e).toCollection().primaryKeys()).then(t)}catch{return ht(new B.MissingAPI)}var e,n},defineClass:function(){return function(t){$(this,t)}},ignoreTransaction:function(t){return M.trans?Qt(M.transless,t):t()},vip:Mn,async:function(t){return function(){try{var e=Vn(t.apply(this,arguments));return e&&typeof e.then=="function"?e:K.resolve(e)}catch(n){return ht(n)}}},spawn:function(t,e,n){try{var r=Vn(t.apply(n,e||[]));return r&&typeof r.then=="function"?r:K.resolve(r)}catch(a){return ht(a)}},currentTransaction:{get:function(){return M.trans||null}},waitFor:function(t,e){return t=K.resolve(typeof t=="function"?te.ignoreTransaction(t):t).timeout(e||6e4),M.trans?M.trans.waitFor(t):t},Promise:K,debug:{get:function(){return Ot},set:function(t){fr(t)}},derive:H,extend:$,props:nt,override:_t,Events:Se,on:Ft,liveQuery:Vr,extendObservabilitySet:tn,getByKeyPath:bt,setByKeyPath:ct,delByKeyPath:function(t,e){typeof e=="string"?ct(t,e,void 0):"length"in e&&[].map.call(e,function(n){ct(t,n,void 0)})},shallowClone:ft,deepClone:Ut,getObjectDiff:zn,cmp:G,asap:tt,minKey:-1/0,addons:[],connections:ce,errnames:yn,dependencies:an,cache:Zt,semVer:"4.3.0",version:"4.3.0".split(".").map(function(t){return parseInt(t)}).reduce(function(t,e,n){return t+e/Math.pow(10,2*n)})})),te.maxKey=Ie(te.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ft(De,function(t){Wt||(t=new CustomEvent(An,{detail:t}),Wt=!0,dispatchEvent(t),Wt=!1)}),addEventListener(An,function(t){t=t.detail,Wt||Qn(t)}));var he,Wt=!1,zr=function(){};return typeof BroadcastChannel<"u"&&((zr=function(){(he=new BroadcastChannel(An)).onmessage=function(t){return t.data&&Qn(t.data)}})(),typeof he.unref=="function"&&he.unref(),Ft(De,function(t){Wt||he.postMessage(t)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(t){if(!jt.disableBfCache&&t.persisted){Ot&&console.debug("Dexie: handling persisted pagehide"),he!=null&&he.close();for(var e=0,n=ce;e<n.length;e++)n[e].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(t){!jt.disableBfCache&&t.persisted&&(Ot&&console.debug("Dexie: handling persisted pageshow"),zr(),Qn({all:new kt(-1/0,[[]])}))})),K.rejectionMapper=function(t,e){return!t||t instanceof ae||t instanceof TypeError||t instanceof SyntaxError||!t.name||!dr[t.name]?t:(e=new dr[t.name](e||t.message,t),"stack"in t&&it(e,"stack",{get:function(){return this.inner.stack}}),e)},fr(Ot),g(jt,Object.freeze({__proto__:null,Dexie:jt,Entity:wr,PropModification:xe,RangeSet:kt,add:function(t){return new xe({add:t})},cmp:G,default:jt,liveQuery:Vr,mergeRanges:Pe,rangesOverlap:jr,remove:function(t){return new xe({remove:t})},replacePrefix:function(t,e){return new xe({replacePrefix:[t,e]})}}),{default:jt}),jt})})(aa);var Za=aa.exports;const tr=Ja(Za),Gr=Symbol.for("Dexie"),ln=globalThis[Gr]||(globalThis[Gr]=tr);if(tr.semVer!==ln.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${tr.semVer} and ${ln.semVer}`);const{liveQuery:Ii,mergeRanges:Oi,rangesOverlap:Ai,RangeSet:Pi,cmp:Ci,Entity:$i,PropModification:Ki,replacePrefix:ji,add:Li,remove:qi,DexieYProvider:Ri}=ln;class ti extends ln{constructor(){super("GymDatabase");Lt(this,"workouts");Lt(this,"logs");Lt(this,"workoutTypes");Lt(this,"profile");this.version(1).stores({workouts:"id, status, startTime, updatedAt, isDeleted",logs:"id, workoutId, workoutTypeId, date, updatedAt, isDeleted",workoutTypes:"id, updatedAt, isDeleted",profile:"id, updatedAt, isDeleted"})}}const z=new ti,rr="gym_web_auth";function fn(){const v=localStorage.getItem(rr);try{return v?JSON.parse(v):null}catch{return null}}function ar(v){localStorage.setItem(rr,JSON.stringify(v))}function ia(){localStorage.removeItem(rr)}function oa(){const v=fn();if(!v)return null;const u=new URLSearchParams;return Object.entries(v).forEach(([c,g])=>{g!=null&&u.append(c,String(g))}),u.toString()}const ei=Object.freeze(Object.defineProperty({__proto__:null,clearAuthData:ia,getAuthData:fn,getAuthString:oa,saveAuthData:ar},Symbol.toStringTag,{value:"Module"}));var ta;const on=(ta=window.Telegram)==null?void 0:ta.WebApp,Qr="https://functions.yandexcloud.net/d4ehnqvq3a8fo55t7tj4";class Xr{static getHeaders(){const u={"Content-Type":"application/json"};if(on!=null&&on.initData)localStorage.getItem("skip_tma_auth")==="true"||(u["X-Telegram-Init-Data"]=on.initData);else{const c=oa();c&&(u["X-Telegram-Init-Data"]=c)}return u}static async sync(){if(!navigator.onLine)throw new Error("Offline");const u=this.getHeaders(),c=await fetch(Qr,{headers:u});if(!c.ok)throw c.status===401?new Error("Unauthorized"):new Error("Sync failed");const g=await c.json();await this.mergeData(g);const x=await this.readAll();await fetch(Qr,{method:"POST",headers:u,body:JSON.stringify(x)})}static async mergeData(u){await z.transaction("rw",z.workouts,z.logs,z.workoutTypes,z.profile,async()=>{if(await this.mergeTable(z.workouts,u.workouts),await this.mergeTable(z.logs,u.logs),await this.mergeTable(z.workoutTypes,u.workoutTypes),u.profile){const c={...u.profile,id:"me"};await this.mergeTable(z.profile,[c])}})}static async mergeTable(u,c=[]){const g=await u.toArray(),x=new Map(g.map(T=>[T.id,T]));for(const T of c){const S=x.get(T.id);if(!S)await u.put(T);else{const D=new Date(T.updatedAt).getTime(),$=new Date(S.updatedAt).getTime();D>$&&await u.put(T)}}}static async readAll(){return{workouts:await z.workouts.toArray(),logs:await z.logs.toArray(),workoutTypes:await z.workoutTypes.toArray(),profile:(await z.profile.toArray())[0]}}}const ni="gym_twa_data";var ea;const me=(ea=window.Telegram)==null?void 0:ea.WebApp,Jn={workoutTypes:[{id:"1",name:"ÐÐ¸Ð¼ Ð»ÐµÐ¶Ð°",updatedAt:new Date().toISOString()},{id:"2",name:"ÐÑÐ¸ÑÐµÐ´Ð°Ð½Ð¸Ñ",updatedAt:new Date().toISOString()},{id:"3",name:"Ð¡ÑÐ°Ð½Ð¾Ð²Ð°Ñ ÑÑÐ³Ð°",updatedAt:new Date().toISOString()}],logs:[],workouts:[]};class ri{constructor(){Lt(this,"onUpdateCallback");Lt(this,"onSyncStatusChangeCallback");Lt(this,"status","idle");Lt(this,"cache",{...Jn});this.init()}async init(){await this.migrateFromLocalStorage(),this.sync().catch(console.error)}async migrateFromLocalStorage(){const u=localStorage.getItem(ni);if(u)try{const c=JSON.parse(u);if(await z.workoutTypes.count()===0){console.log("Migrating from localStorage to IDB...");const x=new Date().toISOString(),T=(c.workoutTypes||Jn.workoutTypes).map($=>({...$,updatedAt:x}));await z.workoutTypes.bulkPut(T);const S=(c.logs||[]).map($=>({...$,updatedAt:x,workoutId:$.workoutId||"legacy"}));await z.logs.bulkPut(S);const D=(c.workouts||[]).map($=>({...$,updatedAt:x}));if(await z.workouts.bulkPut(D),c.profile){const $={...c.profile,id:"me",updatedAt:x};await z.profile.put($)}}}catch(c){console.error("Migration failed",c)}else await z.workoutTypes.count()===0&&await z.workoutTypes.bulkPut(Jn.workoutTypes)}onUpdate(u){this.onUpdateCallback=u}onSyncStatusChange(u){this.onSyncStatusChangeCallback=u}setStatus(u){var c;this.status=u,(c=this.onSyncStatusChangeCallback)==null||c.call(this,u),u==="success"&&setTimeout(()=>{this.status==="success"&&this.setStatus("idle")},2e3)}async sync(){var c;const u=localStorage.getItem("skip_tma_auth")==="true";if(u&&!(await ra(async()=>{const{getAuthString:x}=await Promise.resolve().then(()=>ei);return{getAuthString:x}},void 0,import.meta.url)).getAuthString()){this.setStatus("idle");return}try{this.setStatus("saving"),await Xr.sync(),this.setStatus("success"),(c=this.onUpdateCallback)==null||c.call(this)}catch(g){if(console.error("Sync failed",g),(g instanceof Error?g.message:String(g)).toLowerCase().includes("unauthorized")){if(u){this.setStatus("error");return}localStorage.setItem("skip_tma_auth","true"),ia(),location.reload();return}g instanceof Error&&g.message==="Offline"?this.setStatus("idle"):this.setStatus("error")}}async reloadCache(){var u;this.cache=await Xr.readAll(),(u=this.onUpdateCallback)==null||u.call(this)}getWorkoutTypes(){return this.cache.workoutTypes.filter(u=>!u.isDeleted)}getLogs(){return this.cache.logs.filter(u=>!u.isDeleted)}getWorkouts(){return this.cache.workouts.filter(u=>!u.isDeleted)}getActiveWorkout(){return this.cache.workouts.find(u=>!u.isDeleted&&(u.status==="active"||u.status==="paused"))}getProfile(){return this.cache.profile}async addWorkoutType(u,c="strength"){const g={id:Date.now().toString(),name:u,category:c,updatedAt:new Date().toISOString()};return await z.workoutTypes.put(g),await this.reloadCache(),this.sync().catch(()=>{}),g}async deleteWorkoutType(u){const c=await z.workoutTypes.get(u);c&&(c.isDeleted=!0,c.updatedAt=new Date().toISOString(),await z.workoutTypes.put(c),await this.reloadCache(),this.sync().catch(()=>{}))}async updateWorkoutType(u,c,g){const x=await z.workoutTypes.get(u);x&&(x.name=c,g&&(x.category=g),x.updatedAt=new Date().toISOString(),await z.workoutTypes.put(x),await this.reloadCache(),this.sync().catch(()=>{}))}async startWorkout(u){this.getActiveWorkout()&&await this.finishWorkout();const g={id:Date.now().toString(),startTime:new Date().toISOString(),status:"active",name:u,isManual:!0,pauseIntervals:[],updatedAt:new Date().toISOString()};return await z.workouts.put(g),await this.reloadCache(),this.sync().catch(()=>{}),g}async pauseWorkout(){const u=this.getActiveWorkout();u&&u.status==="active"&&(u.status="paused",u.pauseIntervals.push({start:new Date().toISOString()}),u.updatedAt=new Date().toISOString(),await z.workouts.put(u),await this.reloadCache(),this.sync().catch(()=>{}))}async resumeWorkout(){const u=this.getActiveWorkout();if(u&&u.status==="paused"){u.status="active";const c=u.pauseIntervals[u.pauseIntervals.length-1];c&&!c.end&&(c.end=new Date().toISOString()),u.updatedAt=new Date().toISOString(),await z.workouts.put(u),await this.reloadCache(),this.sync().catch(()=>{})}}async finishWorkout(){const u=this.getActiveWorkout();if(u){u.status="finished",u.endTime=new Date().toISOString();const c=u.pauseIntervals[u.pauseIntervals.length-1];c&&!c.end&&(c.end=u.endTime),u.updatedAt=new Date().toISOString(),await z.workouts.put(u),await this.reloadCache(),this.sync().catch(()=>{})}}getWorkoutDuration(u){const c=new Date(u.startTime).getTime(),g=u.endTime?new Date(u.endTime).getTime():Date.now();let x=g-c;return u.pauseIntervals.forEach(S=>{const D=new Date(S.start).getTime(),$=S.end?new Date(S.end).getTime():u.status==="paused"?Date.now():g;$>D&&(x-=$-D)}),Math.floor(Math.max(0,x)/6e4)}async ensureActiveWorkout(){const u=this.getActiveWorkout();if(u)return u.id;const c=new Date().toISOString().split("T")[0],T=this.getWorkouts().filter($=>$.startTime.startsWith(c)).sort(($,R)=>new Date(R.startTime).getTime()-new Date($.startTime).getTime())[0];if(T&&!T.isManual&&T.status==="finished")return T.endTime=new Date().toISOString(),T.updatedAt=new Date().toISOString(),await z.workouts.put(T),await this.reloadCache(),this.sync().catch(()=>{}),T.id;const S=`implicit_${c}_${Date.now()}`,D={id:S,startTime:new Date().toISOString(),endTime:new Date().toISOString(),status:"finished",isManual:!1,pauseIntervals:[],updatedAt:new Date().toISOString()};return await z.workouts.put(D),await this.reloadCache(),this.sync().catch(()=>{}),S}async updateImplicitWorkoutBounds(u){const c=await z.workouts.get(u);if(!c||c.isManual)return;const x=(await z.logs.where("workoutId").equals(u).toArray()).filter(S=>!S.isDeleted);if(x.length===0)return;const T=x.sort((S,D)=>new Date(S.date).getTime()-new Date(D.date).getTime());c.startTime=T[0].date,c.endTime=T[T.length-1].date,c.status="finished",c.updatedAt=new Date().toISOString(),await z.workouts.put(c)}async addLog(u){const c=await this.ensureActiveWorkout(),g={...u,id:Date.now().toString(),date:new Date().toISOString(),workoutId:c,updatedAt:new Date().toISOString()};return await z.logs.put(g),await this.updateImplicitWorkoutBounds(c),await this.reloadCache(),this.sync().catch(()=>{}),g}async deleteLog(u){const c=await z.logs.get(u);if(c){const g=c.workoutId;c.isDeleted=!0,c.updatedAt=new Date().toISOString(),await z.logs.put(c),g&&await this.updateImplicitWorkoutBounds(g),await this.reloadCache(),this.sync().catch(()=>{})}}async updateLog(u){const c={...u,updatedAt:new Date().toISOString()};await z.logs.put(c),await this.reloadCache(),this.sync().catch(()=>{})}getProfileIdentifier(){var g,x;const u=this.cache.profile;if(u!=null&&u.telegramUsername)return u.telegramUsername;if(u!=null&&u.telegramUserId)return`id_${u.telegramUserId}`;const c=(x=(g=me==null?void 0:me.initDataUnsafe)==null?void 0:g.user)==null?void 0:x.id;return c?`id_${c}`:""}async updateProfileSettings(u){var S;const c=(S=me==null?void 0:me.initDataUnsafe)==null?void 0:S.user,g=c==null?void 0:c.id;let x=this.cache.profile;x?c!=null&&c.photo_url&&(x.photoUrl=c.photo_url):x={id:"me",isPublic:!1,showFullHistory:!1,telegramUserId:g||0,telegramUsername:c==null?void 0:c.username,photoUrl:c==null?void 0:c.photo_url,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};const T={...x,...u,updatedAt:new Date().toISOString()};await z.profile.put(T),await this.reloadCache(),this.sync().catch(()=>{})}async getPublicProfile(u){try{const g=await fetch(`https://functions.yandexcloud.net/d4ehnqvq3a8fo55t7tj4?profile=${encodeURIComponent(u)}`);return g.ok?await g.json():null}catch{return null}}}const W=new ri;W.reloadCache().then(()=>{});function ai(v=0,u=0){return u===1?v:Math.round(v*(1+u/30))}function ii(v,u){const c=new Map;return v.filter(x=>x.workoutTypeId===u).forEach(x=>{const T=x.date.split("T")[0],S=ai(x.weight||0,x.reps||0),D=c.get(T)||0;S>D&&c.set(T,S)}),c}function oi(v,u){const c=new Set;return v.forEach(g=>c.add(g.startTime.split("T")[0])),u.forEach(g=>c.add(g.date.split("T")[0])),c}function si(v){const u=v.filter(T=>T.endTime&&T.status==="finished");if(u.length===0)return{averageMinutes:0,totalMinutes:0,count:0};let c=0;u.forEach(T=>{const S=new Date(T.startTime).getTime(),D=new Date(T.endTime).getTime();let $=D-S;T.pauseIntervals&&T.pauseIntervals.forEach(R=>{const U=new Date(R.start).getTime(),N=R.end?new Date(R.end).getTime():D;$-=N-U}),c+=$});const g=Math.round(c/1e3/60);return{averageMinutes:Math.round(g/u.length),totalMinutes:g,count:u.length}}function ui(v,u=6){const c=new Date,g=new Date(c);g.setMonth(c.getMonth()-u),g.setDate(g.getDate()-g.getDay());let x='<div class="heatmap-container"><div class="heatmap-grid">';const T=new Date(g),S=new Date(c);for(;T<=S;){const D=T.toISOString().split("T")[0],$=v.has(D),U=`heatmap-cell level-${$?4:0}`,N=`${D}: ${$?"Workout":"No workout"}`;x+=`<div class="${U}" title="${N}"></div>`,T.setDate(T.getDate()+1)}return x+="</div>",x+=`
        <div class="heatmap-legend">
            Less <div class="heatmap-cell level-0"></div>
            <div class="heatmap-cell level-4"></div> More
        </div>
    `,x+="</div>",x}function Jr(v){const u=new Map;v.forEach(x=>{const T=x.date.split("T")[0],S=(x.weight||0)*(x.reps||0);u.set(T,(u.get(T)||0)+S)});const c=Array.from(u.keys()).sort().slice(-10);if(c.length<2)return'<p class="hint">ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð´Ð°Ð½Ð½ÑÑ Ð´Ð»Ñ Ð³ÑÐ°ÑÐ¸ÐºÐ° Ð¾Ð±ÑÐµÐ¼Ð°</p>';const g=c.map(x=>({label:new Date(x).toLocaleDateString(void 0,{day:"numeric",month:"short"}),value:u.get(x)}));return di(g,"ÐºÐ³")}function ci(v){const u=Array.from(v.keys()).sort();if(u.length<2)return'<p class="hint">ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð´Ð°Ð½Ð½ÑÑ Ð´Ð»Ñ Ð³ÑÐ°ÑÐ¸ÐºÐ° 1RM</p>';const c=u.map(g=>({label:new Date(g).toLocaleDateString(void 0,{day:"numeric",month:"short"}),value:v.get(g)}));return sa(c,"ÐºÐ³")}function li(v){const u=v.filter(g=>g.status==="finished"&&g.endTime).sort((g,x)=>new Date(g.startTime).getTime()-new Date(x.startTime).getTime()).slice(-10);if(u.length<2)return'<p class="hint">ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð´Ð°Ð½Ð½ÑÑ Ð´Ð»Ñ Ð³ÑÐ°ÑÐ¸ÐºÐ° Ð¿ÑÐ¾Ð´Ð¾Ð»Ð¶Ð¸ÑÐµÐ»ÑÐ½Ð¾ÑÑÐ¸</p>';const c=u.map(g=>{const x=new Date(g.startTime).getTime(),T=new Date(g.endTime).getTime();let S=(T-x)/1e3/60;return g.pauseIntervals&&g.pauseIntervals.forEach(D=>{const $=new Date(D.start).getTime(),R=D.end?new Date(D.end).getTime():T;S-=(R-$)/1e3/60}),{label:new Date(g.startTime).toLocaleDateString(void 0,{day:"numeric",month:"short"}),value:Math.round(S)}});return sa(c,"Ð¼Ð¸Ð½")}function di(v,u){const x=Math.max(...v.map(S=>S.value))*1.1;return`
        <svg width="100%" height="150" preserveAspectRatio="none">
            ${v.map((S,D)=>{const $=S.value/x*100,R=D/v.length*100,U=1/v.length*80;return`
            <rect x="${R+5}%" y="${100-$}%" width="${U}%" height="${$}%" fill="var(--color-button)" rx="2" opacity="0.8">
               <title>${S.label}: ${S.value}${u}</title>
            </rect>
            <text x="${R+5+U/2}%" y="95%" font-size="10" text-anchor="middle" fill="var(--color-text)" style="pointer-events: none;">
                ${S.label}
            </text>
        `}).join("")}
        </svg>
    `}function sa(v,u){const T=v.map(Q=>Q.value),S=Math.min(...T),D=Math.max(...T),$=D-S||1,R=Q=>20+Q/(v.length-1)*(400-2*20),U=Q=>130-(Q-S)/$*(150-2*20),N=v.map((Q,it)=>`${R(it)},${U(Q.value)}`).join(" "),nt=v.map((Q,it)=>`
        <circle cx="${R(it)}" cy="${U(Q.value)}" r="4" fill="var(--color-bg)" stroke="var(--color-button)" stroke-width="2">
            <title>${Q.label}: ${Q.value}${u}</title>
        </circle>
    `).join("");return`
        <svg viewBox="0 0 400 150" class="chart">
             <polyline
                fill="none"
                stroke="var(--color-button)"
                stroke-width="3"
                stroke-linejoin="round"
                stroke-linecap="round"
                points="${N}"
            />
            ${nt}
        </svg>
        <div style="display: flex; justify-content: space-between; margin-top: 4px; font-size: 12px; color: var(--color-hint);">
            <span>${Math.round(S)}${u}</span>
            <span>${Math.round(D)}${u}</span>
        </div>
    `}function fi(v,u){v.innerHTML=`
        <div class="page-content" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 80vh; text-align: center;">
            <div style="font-size: 48px; margin-bottom: 24px;">ðï¸</div>
            <h1 class="title" style="margin-bottom: 12px;">ÐÐ¸Ð¼-Ð¶Ð¸Ð¼ 21</h1>
            <p class="subtitle" style="margin-bottom: 32px; opacity: 0.7;">ÐÐ¾Ð¹Ð´Ð¸ÑÐµ ÑÐµÑÐµÐ· Telegram, ÑÑÐ¾Ð±Ñ ÑÐ¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð¸ÑÐ¾Ð²Ð°ÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸</p>
            <div id="telegram-login-container"></div>
        </div>
    `,window.onTelegramAuth=x=>{console.log("Telegram auth callback received:",x),ar(x),localStorage.removeItem("skip_tma_auth"),u()};const c=document.createElement("script");c.src="https://telegram.org/js/telegram-widget.js?22",c.async=!0,c.setAttribute("data-telegram-login","gymgym21bot"),c.setAttribute("data-size","large"),c.setAttribute("data-radius","12"),c.setAttribute("data-onauth","onTelegramAuth(user)"),c.setAttribute("data-request-access","write");const g=document.getElementById("telegram-login-container");g&&g.appendChild(c)}function pi(v={}){const{immediate:u=!1,onNeedRefresh:c,onOfflineReady:g,onRegistered:x,onRegisteredSW:T,onRegisterError:S}=v;let D,$;const R=async(N=!0)=>{await $};async function U(){if("serviceWorker"in navigator){if(D=await ra(async()=>{const{Workbox:N}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:N}},[],import.meta.url).then(({Workbox:N})=>new N("./sw.js",{scope:"./",type:"classic"})).catch(N=>{S==null||S(N)}),!D)return;D.addEventListener("activated",N=>{(N.isUpdate||N.isExternal)&&window.location.reload()}),D.addEventListener("installed",N=>{N.isUpdate||g==null||g()}),D.register({immediate:u}).then(N=>{T?T("./sw.js",N):x==null||x(N)}).catch(N=>{S==null||S(N)})}}return $=U(),R}pi({immediate:!0});var na;const dt=(na=window.Telegram)==null?void 0:na.WebApp;dt&&(dt.ready(),dt.expand());let It="main",ye="all",yt=null,ua=null,dn=null,er=!1,Ce=null,Dt=null,un="overview",ir=!1,cn=!1;function hi(v){It=v,at()}let Zn=null;function Zr(v){let u=document.querySelector(".toast");u||(u=document.createElement("div"),u.className="toast",document.body.appendChild(u)),u.textContent=v,u.classList.add("visible"),Zn&&clearTimeout(Zn),Zn=setTimeout(()=>{u==null||u.classList.remove("visible")},2e3)}function at(){const v=document.getElementById("app");if(!v)return;const u=localStorage.getItem("skip_tma_auth")==="true",c=!!(dt!=null&&dt.initData)&&!u,x=!!fn();!c&&!x||(v.innerHTML=`
    <main class="content">
      ${mi()}
    </main>
    <nav class="navigation">
      <button class="navigation__item ${It==="main"?"navigation__item_active":""}" data-page="main">
        <span class="navigation__icon">ðï¸</span>
        <span class="navigation__label">Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ°</span>
      </button>
      <button class="navigation__item ${It==="stats"?"navigation__item_active":""}" data-page="stats">
        <span class="navigation__icon">ð</span>
        <span class="navigation__label">Ð¡ÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ°</span>
      </button>
      <button class="navigation__item ${It==="profile-settings"?"navigation__item_active":""}" data-page="profile-settings">
        <span class="navigation__icon">ð¤</span>
        <span class="navigation__label">ÐÑÐ¾ÑÐ¸Ð»Ñ</span>
      </button>
      <button class="navigation__item ${It==="settings"?"navigation__item_active":""}" data-page="settings">
        <span class="navigation__icon">âï¸</span>
        <span class="navigation__label">ÐÐ°ÑÑÑÐ¾Ð¹ÐºÐ¸</span>
      </button>
    </nav>
    <div id="sync-status" class="sync-status"></div>
  `,v.querySelectorAll(".navigation__item").forEach(T=>{T.addEventListener("click",()=>{const S=T.getAttribute("data-page");hi(S)})}),Si())}let ca="idle";W.onSyncStatusChange(v=>{ca=v,or()});function or(){const v=document.getElementById("sync-status");if(!v)return;v.className="sync-status";let u="",c="";switch(ca){case"saving":u="Ð¡Ð¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ñ...",c="ð",v.classList.add("sync-status_saving");break;case"success":u="Ð¡Ð¾ÑÑÐ°Ð½ÐµÐ½Ð¾",c="â",v.classList.add("sync-status_success");break;case"error":u="ÐÑÐ¸Ð±ÐºÐ° ÑÐ¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ð¸",c="â ï¸",v.classList.add("sync-status_error");break;case"idle":if(!navigator.onLine)u="ÐÑÑÐ»Ð°Ð¹Ð½",c="ð¡",v.classList.add("sync-status_offline");else return;break}v.innerHTML=`${c} ${u}`}window.addEventListener("online",()=>{W.sync(),or()});window.addEventListener("offline",()=>or());function mi(){switch(It){case"main":return vi();case"stats":return ki();case"settings":return bi();case"profile-settings":return wi();case"public-profile":return _i();default:return""}}function yi(){const v=W.getActiveWorkout();if(v){const u=v.status==="paused";return`
      <div class="workout-controls card">
        <div class="workout-controls__header">
          <span class="workout-status ${u?"workout-status_paused":""}">
            ${u?"â¸ï¸ ÐÐ°ÑÐ·Ð°":"ð¥ Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ° Ð°ÐºÑÐ¸Ð²Ð½Ð°"}
          </span>
          ${v.name?`<span class="workout-name">${v.name}</span>`:""}
        </div>
        <div class="workout-controls__actions">
          ${u?'<button class="button" id="resume-workout-btn">ÐÑÐ¾Ð´Ð¾Ð»Ð¶Ð¸ÑÑ</button>':'<button class="button button_secondary" id="pause-workout-btn">ÐÐ°ÑÐ·Ð°</button>'}
          <button class="button button_destructive" id="finish-workout-btn">ÐÐ°Ð²ÐµÑÑÐ¸ÑÑ</button>
        </div>
      </div>
    `}return cn?`
      <div class="workout-controls card">
        <h3 class="subtitle" style="margin-top: 0">ÐÐ°ÑÐ°Ð»Ð¾ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸</h3>
        <form id="start-workout-form" style="display: flex; flex-direction: column; gap: 12px;">
          <input class="input" type="text" name="workoutName" placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ (Ð¾Ð¿ÑÐ¸Ð¾Ð½Ð°Ð»ÑÐ½Ð¾)">
          <div style="display: flex; gap: 8px;">
            <button class="button" type="submit">ÐÐ°ÑÐ°ÑÑ</button>
            <button class="button button_secondary" type="button" id="cancel-start-workout-btn">ÐÑÐ¼ÐµÐ½Ð°</button>
          </div>
        </form>
      </div>
    `:`
    <button class="button" id="start-workout-btn" style="margin-bottom: 24px;">â¶ï¸ ÐÐ°ÑÐ°ÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÑ</button>
  `}let xt=0,nr="";function sr(v){const u=new Date;u.setHours(0,0,0,0);const c=new Date(u);c.setDate(u.getDate()-v*7),c.setHours(23,59,59,999);const g=new Date(c);return g.setDate(c.getDate()-6),g.setHours(0,0,0,0),{start:g,end:c,label:`${g.toLocaleDateString("ru-RU",{day:"numeric",month:"short"})} - ${c.toLocaleDateString("ru-RU",{day:"numeric",month:"short"})}`}}function vi(){var S;const v=W.getWorkoutTypes(),u=W.getLogs(),c=u[u.length-1],g=c==null?void 0:c.workoutTypeId,x=yt?u.find(D=>D.id===yt):null,{label:T}=sr(xt);return`
    <div class="page-content" id="main-content">
      ${yi()}
      <h1 class="title">${yt?"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´ÑÐ¾Ð´Ð°":"ÐÐ¾Ð²ÑÐ¹ Ð¿Ð¾Ð´ÑÐ¾Ð´"}</h1>
      <form class="workout-form" id="log-form">
        <div class="form-group">
          <label class="label">Ð¢Ð¸Ð¿ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸</label>
          <select class="select" name="typeId" id="workout-type-select" required>
            ${v.map(D=>`<option value="${D.id}" ${(yt?x&&D.id===x.workoutTypeId:D.id===g)?"selected":""}>${D.name}</option>`).join("")}
          </select>
        </div>
        
        <div id="strength-inputs" style="display: none;">
            <div class="form-row">
              <div class="form-group">
                <label class="label">ÐÐµÑ (ÐºÐ³)</label>
                <input class="input" type="number" name="weight" step="0.5" placeholder="0" value="${yt&&x?x.weight:""}">
              </div>
              <div class="form-group">
                <label class="label">ÐÐ¾Ð²ÑÐ¾ÑÐµÐ½Ð¸Ð¹</label>
                <input class="input" type="number" name="reps" placeholder="0" value="${yt&&x?x.reps:""}">
              </div>
            </div>
        </div>

        <div id="time-inputs" style="display: none;">
            <div class="form-group">
                <label class="label">ÐÑÐµÐ¼Ñ (Ð¼Ð¸Ð½)</label>
                <input class="input" type="number" name="duration" placeholder="0" value="${yt&&x&&x.duration||""}">
            </div>
        </div>

        <button class="button" type="submit">${yt?"Ð¡Ð¾ÑÑÐ°Ð½Ð¸ÑÑ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ":"ÐÐ°ÑÐ¸ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ"}</button>
        ${yt?'<button class="button button_secondary" type="button" id="cancel-edit-btn" style="margin-top: 12px;">ÐÑÐ¼ÐµÐ½Ð°</button>':""}
        ${!yt&&c?`<button class="button button_secondary" type="button" id="duplicate-last-btn" style="margin-top: 12px;">ÐÐ¾Ð²ÑÐ¾ÑÐ¸ÑÑ: ${(S=v.find(D=>D.id===c.workoutTypeId))==null?void 0:S.name} ${c.weight?`${c.weight}ÐºÐ³ Ã ${c.reps}`:`${c.duration} Ð¼Ð¸Ð½`}</button>`:""}
      </form>
      <div class="recent-logs">
        <div class="recent-logs__header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
           <button class="icon-btn" id="prev-week-btn">âï¸</button>
           <div id="week-label-container" style="display: flex; align-items: center; gap: 8px; position: relative;">
             <span style="font-size: 18px; position: relative; display: inline-block;">
               ð
               <input type="date" id="calendar-input" value="${nr}" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;">
             </span>
             <h2 class="subtitle" style="margin: 0;">${xt===0?"ÐÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 7 Ð´Ð½ÐµÐ¹":T}</h2>
             <label class="filter-toggle" title="Ð¤Ð¸Ð»ÑÑÑ Ð¿Ð¾ ÑÐ¸Ð¿Ñ ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ñ">
               <input type="checkbox" id="filter-toggle-input" ${ir?"checked":""}>
               <span class="filter-toggle__icon">ð</span>
             </label>
           </div>
           <button class="icon-btn" id="next-week-btn" ${xt===0?"disabled":""} style="${xt===0?"opacity: 0.3; cursor: default;":""}">â¶ï¸</button>
        </div>
        <div id="logs-list">
          ${la()}
        </div>
      </div>
    </div>
  `}function la(){var T;const v=W.getLogs(),u=W.getWorkoutTypes(),{start:c,end:g}=sr(xt);let x=v.filter(S=>{const D=new Date(S.date);return D>=c&&D<=g});if(ir){const S=(T=document.querySelector('select[name="typeId"]'))==null?void 0:T.value;S&&(x=x.filter(D=>D.workoutTypeId===S))}return da(x,u,!0)}function sn(){const v=document.getElementById("logs-list"),u=document.querySelector("#week-label-container .subtitle");if(v&&(v.innerHTML=la(),gi()),u){const{label:g}=sr(xt);u.textContent=xt===0?"ÐÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 7 Ð´Ð½ÐµÐ¹":g}const c=document.getElementById("next-week-btn");c&&(c.disabled=xt===0,c.style.opacity=xt===0?"0.3":"",c.style.cursor=xt===0?"default":"")}function gi(){document.querySelectorAll(".log-set__delete").forEach(v=>{v.addEventListener("click",async()=>{const u=v.getAttribute("data-id");u&&(yt===u&&(yt=null),await W.deleteLog(u),at())})}),document.querySelectorAll(".log-set__edit").forEach(v=>{v.addEventListener("click",()=>{yt=v.getAttribute("data-id"),at(),window.scrollTo({top:0,behavior:"smooth"})})}),document.querySelectorAll(".share-btn").forEach(v=>{v.addEventListener("click",()=>{const u=v.getAttribute("data-date");u&&fa(u)})})}function da(v,u,c){if(v.length===0)return'<p class="hint">ÐÐµÑ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð·Ð° ÑÑÐ¾Ñ Ð¿ÐµÑÐ¸Ð¾Ð´</p>';const g=new Map;[...v].sort((S,D)=>new Date(D.date).getTime()-new Date(S.date).getTime()).forEach(S=>{const $=new Date(S.date).toLocaleDateString(void 0,{weekday:"long",day:"numeric",month:"long"});g.has($)||g.set($,[]),g.get($).push(S)});const x=W.getWorkouts();let T="";return g.forEach((S,D)=>{var H;const $=((H=S[0])==null?void 0:H.date.split("T")[0])||"",R=new Set;S.forEach(Y=>{Y.workoutId&&R.add(Y.workoutId)});const U=Array.from(R).sort((Y,st)=>{var bt,ct;const wt=x.find(ft=>ft.id===Y),_t=x.find(ft=>ft.id===st),ut=(wt==null?void 0:wt.startTime)||((bt=S.find(ft=>ft.workoutId===Y))==null?void 0:bt.date)||"",tt=(_t==null?void 0:_t.startTime)||((ct=S.find(ft=>ft.workoutId===st))==null?void 0:ct.date)||"";return new Date(tt).getTime()-new Date(ut).getTime()}),N=U.length===1?U[0]:null,nt=N?x.find(Y=>Y.id===N):null,Q=nt&&nt.name,it=nt?Math.round(W.getWorkoutDuration(nt)):0;T+='<div class="log-day">',T+=`<div class="log-day__header">
      <span>${D}${Q?` â¢ ${nt.name}`:""}${nt?` â¢ ${it} Ð¼Ð¸Ð½`:""}</span>
      ${c?`<button class="share-btn" data-date="${$}" title="ÐÐ¾Ð´ÐµÐ»Ð¸ÑÑÑÑ">ð¤</button>`:""}
    </div>`,U.forEach(Y=>{const st=x.find(tt=>tt.id===Y),wt=S.filter(tt=>tt.workoutId===Y);if(!(U.length===1&&(Q||!(st!=null&&st.name)))){const tt=st?Math.round(W.getWorkoutDuration(st)):0;T+=`<h3 class="workout-subheader">
                ${(st==null?void 0:st.name)||"Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ°"} 
                <span class="workout-subheader__time">${tt} Ð¼Ð¸Ð½</span>
            </h3>`}const ut=new Map;wt.forEach(tt=>{ut.has(tt.workoutTypeId)||ut.set(tt.workoutTypeId,[]),ut.get(tt.workoutTypeId).push(tt)}),ut.forEach((tt,bt)=>{const ct=u.find(ft=>ft.id===bt);T+=`
            <div class="log-exercise">
              <div class="log-exercise__name">${(ct==null?void 0:ct.name)||"Ð£Ð´Ð°Ð»ÐµÐ½Ð¾"}</div>
              <div class="log-exercise__sets">
                ${tt.map(ft=>`
                  <div class="log-set ${ft.id===yt?"log-set_active-edit":""} ${ft.id===Ce?"log-set_new":""}">
                    <div class="log-set__info">
                      ${ft.weight!==void 0&&ft.reps!==void 0?`
                        <span class="log-set__weight">${ft.weight} ÐºÐ³</span>
                        <span class="log-set__times">Ã</span>
                        <span class="log-set__reps">${ft.reps}</span>
                      `:`
                        <span class="log-set__reps">â± ${ft.duration} Ð¼Ð¸Ð½</span>
                      `}
                    </div>
                    ${c?`
                    <div class="log-set__actions">
                      <button class="log-set__edit" data-id="${ft.id}">âï¸</button>
                      <button class="log-set__delete" data-id="${ft.id}">Ã</button>
                    </div>
                    `:""}
                  </div>
                `).join("")}
              </div>
            </div>
          `})}),T+="</div>"}),T}function bi(){const v=W.getWorkoutTypes(),u=Dt?v.find(c=>c.id===Dt):null;return`
    <div class="page-content">
      <h1 class="title">ÐÐ°ÑÑÑÐ¾Ð¹ÐºÐ¸</h1>
      <div class="settings-section">
        <h2 class="subtitle">${Dt?"Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ¸Ð¿Ð°":"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ ÑÐ¸Ð¿ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸"}</h2>
        <form class="add-type-form" id="add-type-form" style="margin-bottom: 24px;">
          <div style="display: flex; gap: 8px; flex-direction: column;">
            <input class="input" type="text" id="new-type-name" placeholder="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ (Ð½Ð°Ð¿Ñ. ÐÐ¸Ð¼ Ð³Ð°Ð½ÑÐµÐ»ÐµÐ¹)" required value="${u?u.name:""}">
            
            <div class="category-switch" style="display: flex; gap: 12px; margin-bottom: 8px;">
                <label style="display: flex; align-items: center; gap: 4px;">
                    <input type="radio" name="new-type-category" value="strength" ${!u||u.category!=="time"?"checked":""}>
                    Ð¡Ð¸Ð»Ð¾Ð²Ð¾Ðµ
                </label>
                <label style="display: flex; align-items: center; gap: 4px;">
                    <input type="radio" name="new-type-category" value="time" ${u&&u.category==="time"?"checked":""}>
                    ÐÐ° Ð²ÑÐµÐ¼Ñ
                </label>
            </div>

            <button class="button" type="submit">${Dt?"Ð¡Ð¾ÑÑÐ°Ð½Ð¸ÑÑ":"ÐÐ¾Ð±Ð°Ð²Ð¸ÑÑ"}</button>
          </div>
          ${Dt?'<button class="button button_secondary" type="button" id="cancel-edit-type-btn" style="margin-top: 8px; width: 100%;">ÐÑÐ¼ÐµÐ½Ð°</button>':""}
        </form>

        <h2 class="subtitle">Ð¢Ð¸Ð¿Ñ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</h2>
        <div class="type-list">
          ${v.map(c=>`
            <div class="type-item">
              <span>${c.name}</span>
              <div style="display: flex; gap: 8px;">
                <button class="type-item__edit icon-btn" data-id="${c.id}" title="Ð ÐµÐ´Ð°ÐºÑÐ¸ÑÐ¾Ð²Ð°ÑÑ">âï¸</button>
                <button class="type-item__delete icon-btn" data-id="${c.id}" title="Ð£Ð´Ð°Ð»Ð¸ÑÑ">Ã</button>
              </div>
            </div>
          `).join("")}
        </div>
      </div>
    </div>
  `}function wi(){var $,R;const v=W.getProfile(),u=(v==null?void 0:v.isPublic)??!1,c=(v==null?void 0:v.displayName)||((R=($=dt==null?void 0:dt.initDataUnsafe)==null?void 0:$.user)==null?void 0:R.first_name)||"",g=W.getProfileIdentifier(),x=g?`https://t.me/gymgym21bot/app?startapp=profile_${g}`:"",T=W.getLogs(),S=T.reduce((U,N)=>U+(N.weight||0)*(N.reps||0),0),D=new Set(T.map(U=>U.date.split("T")[0])).size;return`
    <div class="page-content profile-page">
      <h1 class="title">ÐÑÐ¾ÑÐ¸Ð»Ñ</h1>
      
      <div class="profile-header">
        <div class="profile-avatar">
          ${v!=null&&v.photoUrl?`<img src="${v.photoUrl}" alt="${c}" class="profile-avatar-img">`:c.charAt(0).toUpperCase()}
        </div>
        <div class="profile-name">${c}</div>
        <div class="profile-subtitle">${u?"ÐÑÐ±Ð»Ð¸ÑÐ½ÑÐ¹ Ð¿ÑÐ¾ÑÐ¸Ð»Ñ":"ÐÑÐ¸Ð²Ð°ÑÐ½ÑÐ¹ Ð¿ÑÐ¾ÑÐ¸Ð»Ñ"}</div>
      </div>

      <div class="profile-settings">
        <div class="settings-section">
          <div class="settings-section-title">ÐÐ¸Ð´Ð¸Ð¼Ð¾ÑÑÑ</div>
          <div class="toggle-row">
            <div class="toggle-label">
              <span class="toggle-label-text">ÐÑÐ±Ð»Ð¸ÑÐ½ÑÐ¹ Ð¿ÑÐ¾ÑÐ¸Ð»Ñ</span>
              <span class="toggle-label-hint">ÐÑÑÐ³Ð¸Ðµ ÑÐ¼Ð¾Ð³ÑÑ Ð²Ð¸Ð´ÐµÑÑ Ð²Ð°ÑÑ ÑÑÐ°ÑÐ¸ÑÑÐ¸ÐºÑ</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="profile-public-toggle" ${u?"checked":""}>
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="toggle-row" style="margin-top: 12px;">
            <div class="toggle-label">
              <span class="toggle-label-text">ÐÐ¾ÐºÐ°Ð·ÑÐ²Ð°ÑÑ Ð²ÑÐµ ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ñ</span>
              <span class="toggle-label-hint">ÐÐ¾Ð´ÑÐ¾Ð±Ð½ÑÐ¹ ÑÐ¿Ð¸ÑÐ¾Ðº ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ð¹ Ð² Ð¿ÑÐ±Ð»Ð¸ÑÐ½Ð¾Ð¼ Ð¿ÑÐ¾ÑÐ¸Ð»Ðµ</span>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="profile-history-toggle" ${v!=null&&v.showFullHistory?"checked":""}>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <div class="settings-section">
          <div class="settings-section-title">ÐÐ¼Ñ</div>
          <input class="input" type="text" id="profile-display-name" value="${c}" placeholder="ÐÐ°ÑÐµ Ð¸Ð¼Ñ">
        </div>

        ${u&&g?`
          <div class="settings-section">
            <div class="settings-section-title">Ð¡ÑÑÐ»ÐºÐ° Ð½Ð° Ð¿ÑÐ¾ÑÐ¸Ð»Ñ</div>
            <div class="profile-link-section">
              <a href="${x}" target="_blank" class="profile-link-url">${x}</a>
              <div class="profile-link-actions">
                <button class="button button_secondary" id="copy-profile-link">ÐÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°ÑÑ</button>
                <button class="button" id="share-profile-link">ÐÐ¾Ð´ÐµÐ»Ð¸ÑÑÑÑ</button>
              </div>
            </div>
          </div>
        `:""}

        <div class="settings-section">
          <div class="settings-section-title">ÐÑÐµÐ²ÑÑ ÑÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ¸</div>
          <div class="profile-stats">
            <div class="stat-card">
              <div class="stat-value">${D}</div>
              <div class="stat-label">Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</div>
            </div>
            <div class="stat-card">
              <div class="stat-value">${Math.round(S/1e3)}Ñ</div>
              <div class="stat-label">ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÑÐ¼</div>
            </div>
          </div>
        </div>

        <button class="button" id="save-profile-btn">Ð¡Ð¾ÑÑÐ°Ð½Ð¸ÑÑ</button>
      </div>
    </div>
  `}function _i(){if(!ua)return`
      <div class="page-content">
        <div class="profile-not-found">
          <div class="profile-not-found-icon">ð</div>
          <div class="profile-not-found-text">ÐÑÐ¾ÑÐ¸Ð»Ñ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½</div>
        </div>
      </div>
    `;if(!dn)return er?`
        <div class="page-content">
          <div class="profile-not-found">
            <div class="profile-not-found-icon">ð</div>
            <div class="profile-not-found-text">ÐÑÐ¾ÑÐ¸Ð»Ñ ÑÐºÑÑÑ Ð¸Ð»Ð¸ Ð½Ðµ ÑÑÑÐµÑÑÐ²ÑÐµÑ</div>
          </div>
        </div>
      `:`
      <div class="page-content">
        <div class="profile-loading">ÐÐ°Ð³ÑÑÐ·ÐºÐ° Ð¿ÑÐ¾ÑÐ¸Ð»Ñ...</div>
      </div>
    `;const v=dn;return`
    <div class="page-content profile-page">
      <div class="profile-header">
        <div class="profile-avatar">
          ${v.photoUrl?`<img src="${v.photoUrl}" alt="${v.displayName}" class="profile-avatar-img">`:v.displayName.charAt(0).toUpperCase()}
        </div>
        <div class="profile-name">${v.displayName}</div>
        <div class="profile-subtitle">@${v.identifier}</div>
      </div>

      <div class="profile-stats">
        <div class="stat-card">
          <div class="stat-value">${v.stats.totalWorkouts}</div>
          <div class="stat-label">Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${Math.round(v.stats.totalVolume/1e3)}Ñ</div>
          <div class="stat-label">ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÑÐ¼</div>
        </div>
        ${v.stats.favoriteExercise?`
          <div class="stat-card">
            <div class="stat-value" style="font-size: 1rem;">${v.stats.favoriteExercise}</div>
            <div class="stat-label">ÐÑÐ±Ð¸Ð¼Ð¾Ðµ ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ðµ</div>
          </div>
        `:""}
        ${v.stats.lastWorkoutDate?`
          <div class="stat-card">
            <div class="stat-value" style="font-size: 1rem;">${new Date(v.stats.lastWorkoutDate).toLocaleDateString()}</div>
            <div class="stat-label">ÐÐ¾ÑÐ»ÐµÐ´Ð½ÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ°</div>
          </div>
        `:""}
      </div>

      ${v.recentActivity.length>0?`
        <div class="activity-list">
          <h2 class="subtitle">ÐÐµÐ´Ð°Ð²Ð½ÑÑ Ð°ÐºÑÐ¸Ð²Ð½Ð¾ÑÑÑ</h2>
          ${v.recentActivity.map(u=>`
            <div class="activity-item">
              <span class="activity-date">${new Date(u.date).toLocaleDateString()}</span>
              <span class="activity-count">${u.exerciseCount} ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ð¹</span>
            </div>
          `).join("")}
        </div>
      `:""}

      ${v.logs&&v.logs.length>0&&v.workoutTypes?`
        <div class="recent-logs">
          <h2 class="subtitle">ÐÑÑÐ¾ÑÐ¸Ñ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</h2>
          <div id="logs-list">
            ${da(v.logs,v.workoutTypes,!1)}
          </div>
        </div>
      `:""}
    </div>
  `}function ki(){const v=W.getLogs(),u=W.getWorkouts(),c=W.getWorkoutTypes();if(v.length===0)return`
      <div class="page-content">
        <h1 class="title">Ð¡ÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ°</h1>
        <p class="hint">ÐÐµÐ´Ð¾ÑÑÐ°ÑÐ¾ÑÐ½Ð¾ Ð´Ð°Ð½Ð½ÑÑ Ð´Ð»Ñ ÑÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ¸</p>
      </div>
    `;const g=v.reduce((D,$)=>D+($.weight||0)*($.reps||0),0),x=v.reduce((D,$)=>D+($.reps||0),0),T=si(u);let S=`
    <div class="page-content">
      <h1 class="title">Ð¡ÑÐ°ÑÐ¸ÑÑÐ¸ÐºÐ°</h1>
      <div class="stats-tabs">
        <button class="stats-tab ${un==="overview"?"active":""}" data-tab="overview">ÐÐ±Ð·Ð¾Ñ</button>
        <button class="stats-tab ${un==="progress"?"active":""}" data-tab="progress">ÐÑÐ¾Ð³ÑÐµÑÑ</button>
      </div>
  `;if(un==="overview"){const D=oi(u,v);S+=`
        <div class="stats-section">
            <h2 class="subtitle">ÐÐºÑÐ¸Ð²Ð½Ð¾ÑÑÑ</h2>
            ${ui(D)}
        </div>

        <div class="stats-summary">
            <div class="stat-metric">
                <div class="stat-metric__label">ÐÑÐµÐ³Ð¾ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</div>
                <div class="stat-metric__value">${D.size}</div>
            </div>
            <div class="stat-metric">
                <div class="stat-metric__label">Ð¡ÑÐµÐ´. Ð´Ð»Ð¸ÑÐµÐ»ÑÐ½Ð¾ÑÑÑ</div>
                <div class="stat-metric__value">${T.averageMinutes}<span class="stat-metric__unit">Ð¼Ð¸Ð½</span></div>
            </div>
             <div class="stat-metric">
                <div class="stat-metric__label">ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÐµÐ¼</div>
                <div class="stat-metric__value">${Math.round(g/1e3)}<span class="stat-metric__unit">Ñ</span></div>
            </div>
            <div class="stat-metric">
                <div class="stat-metric__label">ÐÑÐµÐ³Ð¾ Ð¿Ð¾Ð²ÑÐ¾ÑÐµÐ½Ð¸Ð¹</div>
                <div class="stat-metric__value">${x}</div>
            </div>
        </div>

        <div class="charts-section">
            <h2 class="subtitle">ÐÐ»Ð¸ÑÐµÐ»ÑÐ½Ð¾ÑÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº</h2>
            <div class="chart-container">
                ${li(u)}
            </div>
        </div>
     `}else if(S+=`
        <div class="form-group">
            <label class="label">Ð£Ð¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ðµ</label>
            <select class="select" id="stat-type-select">
                <option value="all">ÐÑÐµ ÑÐ¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ñ (ÐÐ±ÑÐµÐ¼)</option>
                ${c.map(D=>`<option value="${D.id}" ${ye===D.id?"selected":""}>${D.name}</option>`).join("")}
            </select>
        </div>
    `,ye==="all")S+=`
            <div class="charts-section">
                <h2 class="subtitle">ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÐµÐ¼ Ð¿Ð¾ Ð´Ð½ÑÐ¼</h2>
                <div class="chart-container">
                    ${Jr(v)}
                </div>
            </div>
        `;else{const D=v.filter(R=>R.workoutTypeId===ye),$=ii(D,ye);S+=`
             <div class="charts-section">
                <h2 class="subtitle">ÐÑÐ¾Ð³ÑÐµÑÑ ÑÐ¸Ð»Ð¾Ð²ÑÑ (1RM)</h2>
                <div class="chart-container">
                    ${ci($)}
                </div>
            </div>
            
            <div class="charts-section" style="margin-top: 24px;">
                <h2 class="subtitle">ÐÐ±ÑÐµÐ¼ Ð½Ð°Ð³ÑÑÐ·ÐºÐ¸</h2>
                 <div class="chart-container">
                    ${Jr(D)}
                </div>
            </div>
        `}return S+="</div>",S}function xi(v){const u=W.getLogs(),c=W.getWorkoutTypes(),g=u.filter(R=>R.date.startsWith(v));if(g.length===0)return"";const T=new Date(g[0].date).toLocaleDateString("ru-RU",{day:"numeric",month:"long"}),S=new Map;g.forEach(R=>{S.has(R.workoutTypeId)||S.set(R.workoutTypeId,[]),S.get(R.workoutTypeId).push(R)});let D=`ðï¸ Ð¢ÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ° ${T}

`;S.forEach((R,U)=>{const N=c.find(nt=>nt.id===U);D+=`${(N==null?void 0:N.name)||"Ð£Ð¿ÑÐ°Ð¶Ð½ÐµÐ½Ð¸Ðµ"}:
`,R.forEach(nt=>{nt.duration?D+=`  â± ${nt.duration} Ð¼Ð¸Ð½
`:D+=`  ${nt.weight} ÐºÐ³ Ã ${nt.reps}
`}),D+=`
`});const $=g.reduce((R,U)=>R+(U.weight&&U.reps?U.weight*U.reps:0),0);return D+=`ðª ÐÐ±ÑÐ¸Ð¹ Ð¾Ð±ÑÑÐ¼: ${Math.round($)} ÐºÐ³`,D}function fa(v){const u=xi(v);if(u)if(dt!=null&&dt.openTelegramLink){const c=`https://t.me/share/url?url=${encodeURIComponent("https://t.me/gymgym21bot")}&text=${encodeURIComponent(u)}`;dt.openTelegramLink(c)}else navigator.clipboard.writeText(u).then(()=>{alert("Ð¢ÐµÐºÑÑ ÑÐºÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°Ð½ Ð² Ð±ÑÑÐµÑ Ð¾Ð±Ð¼ÐµÐ½Ð°")})}function Si(){if(It==="main"){const v=document.getElementById("start-workout-btn");v==null||v.addEventListener("click",()=>{cn=!0,at()});const u=document.getElementById("cancel-start-workout-btn");u==null||u.addEventListener("click",()=>{cn=!1,at()});const c=document.getElementById("start-workout-form");c==null||c.addEventListener("submit",async H=>{H.preventDefault();const st=new FormData(c).get("workoutName");await W.startWorkout(st),cn=!1,at()});const g=document.getElementById("pause-workout-btn");g==null||g.addEventListener("click",async()=>{await W.pauseWorkout(),at()});const x=document.getElementById("resume-workout-btn");x==null||x.addEventListener("click",async()=>{await W.resumeWorkout(),at()});const T=document.getElementById("finish-workout-btn");T==null||T.addEventListener("click",async()=>{confirm("ÐÐ°Ð²ÐµÑÑÐ¸ÑÑ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÑ?")&&(await W.finishWorkout(),at())});const S=document.getElementById("log-form"),D=()=>{const H=document.getElementById("workout-type-select"),Y=W.getWorkoutTypes(),st=H==null?void 0:H.value,wt=Y.find(tt=>tt.id===st),_t=document.getElementById("strength-inputs"),ut=document.getElementById("time-inputs");wt&&wt.category==="time"?(_t&&(_t.style.display="none"),ut&&(ut.style.display="block"),S.querySelectorAll('input[name="weight"], input[name="reps"]').forEach(tt=>tt.removeAttribute("required")),S.querySelectorAll('input[name="duration"]').forEach(tt=>tt.setAttribute("required","true"))):(_t&&(_t.style.display="block"),ut&&(ut.style.display="none"),S.querySelectorAll('input[name="weight"], input[name="reps"]').forEach(tt=>tt.setAttribute("required","true")),S.querySelectorAll('input[name="duration"]').forEach(tt=>tt.removeAttribute("required")))};D();const $=document.getElementById("workout-type-select");$==null||$.addEventListener("change",D),S==null||S.addEventListener("submit",async H=>{H.preventDefault();const Y=new FormData(S),st=Y.get("typeId"),_t=W.getWorkoutTypes().find(tt=>tt.id===st),ut={workoutTypeId:st};if((_t==null?void 0:_t.category)==="time"?ut.duration=parseInt(Y.get("duration"),10):(ut.weight=parseFloat(Y.get("weight")),ut.reps=parseInt(Y.get("reps"),10)),yt){const bt=W.getLogs().find(ct=>ct.id===yt);bt&&(await W.updateLog({...bt,...ut}),yt=null)}else Ce=(await W.addLog(ut)).id;at(),Ce=null});const R=document.getElementById("duplicate-last-btn");R==null||R.addEventListener("click",async()=>{const H=W.getLogs(),Y=H[H.length-1];Y&&(Ce=(await W.addLog({workoutTypeId:Y.workoutTypeId,weight:Y.weight,reps:Y.reps,duration:Y.duration})).id,at(),Ce=null)});const U=document.getElementById("cancel-edit-btn");U==null||U.addEventListener("click",()=>{yt=null,at()}),document.querySelectorAll(".log-set__delete").forEach(H=>{H.addEventListener("click",async()=>{const Y=H.getAttribute("data-id");Y&&(yt===Y&&(yt=null),await W.deleteLog(Y),at())})}),document.querySelectorAll(".log-set__edit").forEach(H=>{H.addEventListener("click",()=>{yt=H.getAttribute("data-id"),at(),window.scrollTo({top:0,behavior:"smooth"})})}),document.querySelectorAll(".share-btn").forEach(H=>{H.addEventListener("click",()=>{const Y=H.getAttribute("data-date");Y&&fa(Y)})});const N=document.getElementById("prev-week-btn");N==null||N.addEventListener("click",()=>{xt++,sn()});const nt=document.getElementById("next-week-btn");nt==null||nt.addEventListener("click",()=>{xt>0&&(xt--,sn())});const Q=document.getElementById("calendar-input");Q==null||Q.addEventListener("change",()=>{if(!Q.value||Q.value===nr)return;nr=Q.value;const H=new Date(Q.value),Y=new Date;Y.setHours(0,0,0,0);const st=Y.getTime()-H.getTime(),wt=Math.floor(st/(1e3*60*60*24));xt=Math.max(0,Math.floor(wt/7)),sn()});const it=document.getElementById("filter-toggle-input");it==null||it.addEventListener("change",()=>{ir=it.checked,sn()})}if(It==="settings"){const v=document.getElementById("add-type-form");v==null||v.addEventListener("submit",async c=>{var T;c.preventDefault();const g=document.getElementById("new-type-name"),x=(T=document.querySelector('input[name="new-type-category"]:checked'))==null?void 0:T.value;g.value&&(Dt?(await W.updateWorkoutType(Dt,g.value,x),Dt=null):await W.addWorkoutType(g.value,x),at())});const u=document.getElementById("cancel-edit-type-btn");u==null||u.addEventListener("click",()=>{Dt=null,at()}),document.querySelectorAll(".type-item__edit").forEach(c=>{c.addEventListener("click",()=>{Dt=c.getAttribute("data-id"),at();const g=document.getElementById("new-type-name");g==null||g.focus()})}),document.querySelectorAll(".type-item__delete").forEach(c=>{c.addEventListener("click",async()=>{const g=c.getAttribute("data-id");g&&confirm("Ð£Ð´Ð°Ð»Ð¸ÑÑ ÑÑÐ¾Ñ ÑÐ¸Ð¿ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²ÐºÐ¸?")&&(Dt===g&&(Dt=null),await W.deleteWorkoutType(g),at())})})}if(It==="stats"){const v=document.getElementById("stat-type-select");v==null||v.addEventListener("change",()=>{ye=v.value,at()})}if(It==="profile-settings"){const v=document.getElementById("save-profile-btn");v==null||v.addEventListener("click",async()=>{const g=document.getElementById("profile-public-toggle"),x=document.getElementById("profile-history-toggle"),T=document.getElementById("profile-display-name");await W.updateProfileSettings({isPublic:(g==null?void 0:g.checked)??!1,showFullHistory:(x==null?void 0:x.checked)??!1,displayName:(T==null?void 0:T.value)||void 0}),at()});const u=document.getElementById("copy-profile-link");u==null||u.addEventListener("click",()=>{const x=`https://t.me/gymgym21bot/app?startapp=profile_${W.getProfileIdentifier()}`;navigator.clipboard.writeText(x).then(()=>{Zr("Ð¡ÑÑÐ»ÐºÐ° ÑÐºÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°Ð½Ð°")})});const c=document.getElementById("share-profile-link");c==null||c.addEventListener("click",()=>{const x=`https://t.me/gymgym21bot/app?startapp=profile_${W.getProfileIdentifier()}`;if(dt!=null&&dt.openTelegramLink){const T=`https://t.me/share/url?url=${encodeURIComponent(x)}&text=${encodeURIComponent("ÐÐ¾Ð¹ Ð¿ÑÐ¾ÑÐ¸Ð»Ñ ÑÑÐµÐ½Ð¸ÑÐ¾Ð²Ð¾Ðº ðª")}`;dt.openTelegramLink(T)}else navigator.clipboard.writeText(x).then(()=>{Zr("Ð¡ÑÑÐ»ÐºÐ° ÑÐºÐ¾Ð¿Ð¸ÑÐ¾Ð²Ð°Ð½Ð°")})})}if(It==="stats"){document.querySelectorAll(".stats-tab").forEach(c=>{c.addEventListener("click",()=>{const g=c.getAttribute("data-tab");(g==="overview"||g==="progress")&&(un=g,at())})});const u=document.getElementById("stat-type-select");u==null||u.addEventListener("change",c=>{ye=c.target.value,at()})}}const ne=document.createElement("div");ne.className="sync-status";document.body.appendChild(ne);function Ei(v){switch(ne.className="sync-status visible "+v,v){case"saving":ne.textContent="Ð¡Ð¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ñ...";break;case"success":ne.textContent="Ð¡Ð¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð¸ÑÐ¾Ð²Ð°Ð½Ð¾";break;case"error":ne.textContent="ÐÑÐ¸Ð±ÐºÐ° ÑÐ¸Ð½ÑÑÐ¾Ð½Ð¸Ð·Ð°ÑÐ¸Ð¸";break;default:ne.className="sync-status"}}W.onUpdate(()=>at());W.onSyncStatusChange(Ei);async function Ti(){var D;const v=new URLSearchParams(window.location.search);if(v.has("hash")&&v.has("id")){const $={id:parseInt(v.get("id")||"0",10),first_name:v.get("first_name")||"",last_name:v.get("last_name")||void 0,username:v.get("username")||void 0,photo_url:v.get("photo_url")||void 0,auth_date:parseInt(v.get("auth_date")||"0",10),hash:v.get("hash")||""};ar($),v.delete("hash"),v.delete("id"),v.delete("first_name"),v.delete("last_name"),v.delete("username"),v.delete("photo_url"),v.delete("auth_date"),v.delete("auth");const R=v.toString(),U=window.location.pathname+(R?"?"+R:"");window.history.replaceState({},document.title,U),location.reload();return}const u=localStorage.getItem("skip_tma_auth")==="true",c=!!(dt!=null&&dt.initData)&&!u,x=!!fn();if(!c&&!x){fi(document.getElementById("app"),()=>{location.reload()});return}const S=new URLSearchParams(window.location.search).get("startapp")||((D=dt==null?void 0:dt.initDataUnsafe)==null?void 0:D.start_param);if(S&&S.startsWith("profile_")){const $=S.replace("profile_","");ua=$,It="public-profile",er=!1,at(),dn=await W.getPublicProfile($),dn||(er=!0),at()}else at();await W.init()}Ti();
